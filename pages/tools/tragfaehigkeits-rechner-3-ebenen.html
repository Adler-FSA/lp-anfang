<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tragfähigkeits-Rechner – 3 Ebenen</title>
  <meta name="description" content="Tragfähigkeits-Rechner (3 Ebenen): alles frei einstellbar (Startwerte 0), Ebenen-Ertrag getrennt, Wow-UI, LocalStorage, Print, DE/EN." />
  <meta name="robots" content="noindex,nofollow" />

  <style>
    :root{
      --bg:#ffffff;
      --txt:#0b0b0b;
      --muted:#4a4a4a;
      --line:#d7d7d7;
      --soft:#f6f6f6;
      --soft2:#fbfbfb;

      --radius:16px;
      --shadow:0 14px 30px rgba(0,0,0,.10);
      --shadow2:0 10px 22px rgba(0,0,0,.08);

      --sans: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
      --mono: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
    }

    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      background:var(--bg);
      color:var(--txt);

      overflow-wrap:anywhere;
      word-break:break-word;
      hyphens:auto;
    }

    .wrap{
      max-width:1180px;
      margin:0 auto;
      padding:20px 16px 70px;
    }

    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      padding-bottom:12px;
      border-bottom:1px solid var(--line);
      margin-bottom:12px;
    }

    h1{
      margin:0 0 6px 0;
      font-size:22px;
      line-height:1.15;
      letter-spacing:.2px;
    }
    .sub{
      margin:0;
      color:var(--muted);
      font-size:14px;
      line-height:1.55;
      max-width:980px;
    }

    .topRight{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .pillRow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }
    .pill{
      appearance:none;
      border:1px solid var(--line);
      background:#fff;
      color:var(--txt);
      padding:8px 10px;
      border-radius:999px;
      font-weight:950;
      font-size:13px;
      cursor:pointer;
      user-select:none;
      box-shadow:0 2px 0 rgba(0,0,0,.03);
    }
    .pill[aria-pressed="true"]{
      border-color:#0b0b0b;
      box-shadow:0 0 0 2px rgba(0,0,0,.07) inset, 0 2px 0 rgba(0,0,0,.03);
    }

    .btn{
      appearance:none;
      border:1px solid #0b0b0b;
      background:#0b0b0b;
      color:#fff;
      padding:10px 12px;
      border-radius:14px;
      font-weight:950;
      font-size:13px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      user-select:none;
      box-shadow:0 10px 20px rgba(0,0,0,.10);
    }
    .btn.secondary{
      background:#fff;
      color:#0b0b0b;
      border:1px solid var(--line);
      box-shadow:0 6px 14px rgba(0,0,0,.06);
    }
    .btn:active{ transform: translateY(1px); }
    .btn svg{ width:16px; height:16px; }

    .hero{
      border:1px solid var(--line);
      background:var(--soft2);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px;
      position:relative;
      overflow:hidden;
    }
    .hero::before{
      content:"";
      position:absolute; inset:-30px;
      background:
        radial-gradient(560px 220px at 18% 8%, rgba(0,0,0,.06), transparent 60%),
        radial-gradient(520px 240px at 80% 25%, rgba(0,0,0,.04), transparent 60%);
      pointer-events:none;
    }
    .heroInner{ position:relative; z-index:1; }
    .heroTitle{
      margin:0 0 6px 0;
      font-size:15px;
      font-weight:950;
      letter-spacing:.2px;
    }
    .heroText{
      margin:0;
      color:var(--muted);
      font-size:13.5px;
      line-height:1.6;
      max-width:1050px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
      margin-top:14px;
    }

    .card{
      border:1px solid var(--line);
      background:var(--soft2);
      border-radius:var(--radius);
      box-shadow:var(--shadow2);
      padding:14px;
      position:relative;
    }
    .card h2{
      margin:0 0 10px 0;
      font-size:16px;
      letter-spacing:.2px;
    }
    .hint{
      margin:0 0 10px 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.55;
      max-width:1050px;
    }

    .sectionTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:8px;
    }
    .sectionTools{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }
    .miniBtn{
      appearance:none;
      border:1px solid var(--line);
      background:#fff;
      color:#0b0b0b;
      padding:8px 10px;
      border-radius:12px;
      font-weight:950;
      font-size:12px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow:0 6px 14px rgba(0,0,0,.05);
      user-select:none;
    }
    .miniBtn svg{ width:14px; height:14px; }

    .rows{
      display:grid;
      gap:10px;
    }
    .row{
      display:grid;
      grid-template-columns: 1.25fr 1fr auto;
      gap:10px;
      align-items:center;
      padding:10px;
      border-radius:14px;
      background:#fff;
      border:1px solid var(--line);
    }
    @media (max-width:720px){
      .row{ grid-template-columns: 1fr; }
      .row .resetCell{ justify-content:flex-start; }
    }
    .lab{
      font-weight:950;
      font-size:13px;
    }
    .subLab{
      margin-top:3px;
      color:var(--muted);
      font-size:12px;
      line-height:1.4;
    }

    .ctrl{
      display:grid;
      gap:6px;
    }
    input[type="number"], select, input[type="range"]{
      width:100%;
      box-sizing:border-box;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#fff;
      color:#0b0b0b;
      font-size:14px;
      outline:none;
      font-family:var(--sans);
    }
    input[type="number"]:focus, select:focus{
      border-color:#0b0b0b;
      box-shadow:0 0 0 3px rgba(0,0,0,.08);
    }
    .rangeWrap{
      display:grid;
      gap:8px;
    }
    .rangeLine{
      display:flex;
      justify-content:space-between;
      gap:10px;
      color:var(--muted);
      font-size:12px;
      font-family:var(--mono);
    }

    .resetCell{
      display:flex;
      justify-content:flex-end;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
    }
    .resetOne{
      appearance:none;
      border:1px solid var(--line);
      background:var(--soft);
      color:#0b0b0b;
      padding:8px 10px;
      border-radius:12px;
      font-weight:950;
      font-size:12px;
      cursor:pointer;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .resetOne:hover{ background:#fff; }

    .chips{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
      margin-top:6px;
    }
    .chip{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      border:1px solid var(--line);
      border-radius:999px;
      background:#fff;
      font-weight:950;
      font-size:12px;
      user-select:none;
      white-space:nowrap;
    }
    .chip .mono{ font-family:var(--mono); }

    .kpiGrid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
      margin-top:10px;
    }
    @media (max-width:980px){ .kpiGrid{ grid-template-columns: repeat(2, 1fr);} }
    @media (max-width:520px){ .kpiGrid{ grid-template-columns: 1fr;} }

    .kpi{
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
      position:relative;
      overflow:hidden;
    }
    .kpi::before{
      content:"";
      position:absolute; inset:-20px;
      background: radial-gradient(420px 180px at 20% 20%, rgba(0,0,0,.05), transparent 60%);
      pointer-events:none;
      opacity:.85;
    }
    .kpi > *{ position:relative; z-index:1; }
    .kpi .t{
      margin:0 0 6px 0;
      font-size:12px;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.06em;
      font-weight:950;
    }
    .kpi .v{
      margin:0;
      font-size:20px;
      font-weight:1000;
      letter-spacing:.2px;
      font-family:var(--mono);
    }
    .kpi .d{
      margin:6px 0 0 0;
      font-size:12px;
      color:var(--muted);
      line-height:1.45;
    }

    .compareBar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
      padding:10px;
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
    }
    .toggle{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      user-select:none;
    }
    .switch{
      position:relative;
      width:48px;
      height:28px;
      border-radius:999px;
      border:1px solid var(--line);
      background:var(--soft);
      cursor:pointer;
      flex:0 0 auto;
    }
    .knob{
      position:absolute;
      top:3px; left:3px;
      width:22px; height:22px;
      border-radius:999px;
      background:#0b0b0b;
      transition:transform .18s ease;
    }
    .switch.on{ background:#fff; border-color:#0b0b0b; }
    .switch.on .knob{ transform: translateX(20px); }

    .tableWrap{
      margin-top:10px;
      border:1px solid var(--line);
      border-radius:14px;
      overflow:auto;
      background:#fff;
    }
    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      min-width:860px;
      table-layout:fixed;
      font-family:var(--mono);
      font-size:12px;
    }
    th, td{
      padding:10px 10px;
      border-bottom:1px solid var(--line);
      text-align:left;
      white-space:nowrap;
    }
    th{
      background:var(--soft);
      position:sticky;
      top:0;
      z-index:1;
      font-size:12px;
      letter-spacing:.06em;
      text-transform:uppercase;
      font-family:var(--sans);
      font-weight:950;
      color:#0b0b0b;
    }
    tr:last-child td{ border-bottom:0; }
    .right{ text-align:right; }
    .muted{ color:var(--muted); }

    .checks{
      display:grid;
      gap:10px;
      margin-top:8px;
    }
    .checkLine{
      display:flex;
      gap:10px;
      align-items:flex-start;
      padding:10px;
      border-radius:14px;
      background:#fff;
      border:1px solid var(--line);
    }
    .checkLine input{ margin-top:3px; }
    .checkText{ flex:1; }
    .checkTitle{
      font-weight:950;
      font-size:13px;
      margin:0;
    }
    .checkSub{
      margin:4px 0 0 0;
      color:var(--muted);
      font-size:12px;
      line-height:1.45;
    }
    .priceTag{
      font-family:var(--mono);
      font-weight:950;
      font-size:12px;
      white-space:nowrap;
    }

    .slots{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      margin-top:10px;
    }
    @media (max-width:860px){ .slots{ grid-template-columns: 1fr; } }
    .slot{
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
    }
    .slotTitle{
      margin:0 0 8px 0;
      font-weight:1000;
      font-size:13px;
      letter-spacing:.2px;
    }
    .slotBtns{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }

    details.acc{
      margin-top:10px;
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
      overflow:hidden;
    }
    details.acc summary{
      list-style:none;
      cursor:pointer;
      padding:12px 12px;
      font-weight:1000;
      font-size:13px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      user-select:none;
    }
    details.acc summary::-webkit-details-marker{ display:none; }
    .chev{
      width:18px; height:18px;
      transition: transform .18s ease;
      flex:0 0 auto;
    }
    details.acc[open] .chev{ transform: rotate(180deg); }
    .accBody{
      border-top:1px solid var(--line);
      padding:0 12px 12px 12px;
      font-size:13.5px;
      line-height:1.6;
      color:#0b0b0b;
    }
    .accBody p{ margin:10px 0 0 0; }
    .accBody ul{ margin:10px 0 0 18px; }
    .accBody li{ margin:6px 0; }
    .accBody .muted{ font-size:12.5px; }

    .notes{
      margin-top:10px;
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
    }
    textarea{
      width:100%;
      box-sizing:border-box;
      min-height:150px;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      font-size:14px;
      font-family:var(--sans);
      outline:none;
      resize:vertical;

      overflow-wrap:anywhere;
      word-break:break-word;
      hyphens:auto;
    }
    textarea:focus{
      border-color:#0b0b0b;
      box-shadow:0 0 0 3px rgba(0,0,0,.08);
    }
    .noteRow{
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:10px;
    }
    #saveHint{
      color:var(--muted);
      font-size:13px;
    }

    .footerNote{
      margin-top:14px;
      padding-top:12px;
      border-top:1px solid var(--line);
      color:var(--muted);
      font-size:12.5px;
      line-height:1.6;
    }

    /* Print */
    @page{ margin: 12mm; }
    @media print{
      *{ -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .noPrint{ display:none !important; }
      body{ background:#fff !important; color:#000 !important; }
      .card,.hero,.kpi,.slot,.checkLine,.row,.compareBar,.notes,details.acc,.tableWrap{
        box-shadow:none !important;
        border-color:#000 !important;
      }
      th{ position:static !important; background:#f0f0f0 !important; }
      table{ min-width:0 !important; width:100% !important; }
    }
  </style>
</head>

<body>
  <div class="wrap">

    <header>
      <div>
        <h1 data-i18n="h1">Tragfähigkeits-Rechner (3 Ebenen)</h1>
        <p class="sub" data-i18n="sub">
          Dieser Rechner macht sichtbar, wie kontinuierliches Dranbleiben eine Struktur aufbaut, die mit der Zeit stärker trägt.
          Du stellst deine Annahmen selbst ein – alles startet bewusst bei 0.
        </p>
      </div>

      <div class="topRight noPrint">
        <div class="pillRow" aria-label="Sprache">
          <button class="pill" id="langDE" type="button" aria-pressed="true">DE</button>
          <button class="pill" id="langEN" type="button" aria-pressed="false">EN</button>
        </div>

        <button class="btn secondary" id="btnCopy" type="button" aria-label="Ergebnis kopieren">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M9 9h10v12H9V9Z" stroke="currentColor" stroke-width="2"/>
            <path d="M5 3h10v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M5 7h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M5 7v14h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span data-i18n="copy">Kopieren</span>
        </button>

        <button class="btn secondary" id="btnPrint" type="button">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M7 8V3h10v5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M7 17h10v4H7v-4Z" stroke="currentColor" stroke-width="2"/>
            <path d="M6 18H5a3 3 0 0 1-3-3v-4a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v4a3 3 0 0 1-3 3h-1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M18 12h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
          </svg>
          <span data-i18n="print">Drucken</span>
        </button>

        <button class="btn" id="btnResetAll" type="button">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M3 12a9 9 0 0 1 15.36-6.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M18 4v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M21 12a9 9 0 0 1-15.36 6.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span data-i18n="resetAll">Alles auf 0</span>
        </button>
      </div>
    </header>

    <section class="hero">
      <div class="heroInner">
        <div class="heroTitle" data-i18n="heroTitle">Wichtiger Hinweis</div>
        <p class="heroText" data-i18n="heroText">
          Auch wenn Zahlen stark wachsen, heißt das nicht, dass alles genau so eintrifft. Jeder entwickelt sich in seinem Tempo.
          Die Szenarien zeigen, was grundsätzlich möglich ist, wenn man dran bleibt – oft ist es weniger die Frage ob, sondern wann es greifbar wird.
        </p>

        <div class="chips" aria-label="Sätze">
          <div class="chip"><span class="mono">20%</span> <span data-i18n="l1">Ebene 1</span></div>
          <div class="chip"><span class="mono">15%</span> <span data-i18n="l2">Ebene 2</span></div>
          <div class="chip"><span class="mono">10%</span> <span data-i18n="l3">Ebene 3</span></div>
          <div class="chip" data-i18n="allZero">Startwerte: alles 0</div>
        </div>
      </div>
    </section>

    <div class="grid">

      <!-- Eingaben -->
      <section class="card">
        <div class="sectionTop">
          <div>
            <h2 data-i18n="inputsTitle">Einstellungen</h2>
            <p class="hint" data-i18n="inputsHint">
              Alles ist frei einstellbar. Jeder beginnt bei 0 und setzt eigene Annahmen.
            </p>
          </div>
          <div class="sectionTools noPrint">
            <button class="miniBtn" id="resetTime" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M21 12a9 9 0 1 1-2.64-6.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M18 3v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span data-i18n="resetTime">Zeitraum auf 0</span>
            </button>

            <button class="miniBtn" id="resetBuild" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M4 7h16M4 12h16M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span data-i18n="resetBuild">Aufbau auf 0</span>
            </button>

            <button class="miniBtn" id="resetBasket" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M6 6h15l-2 9H8L6 6Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                <path d="M8 21a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" stroke="currentColor" stroke-width="2"/>
                <path d="M18 21a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" stroke="currentColor" stroke-width="2"/>
                <path d="M6 6 5 3H2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span data-i18n="resetBasket">Bausteine aus</span>
            </button>
          </div>
        </div>

        <div class="rows">

          <!-- Zeitraum -->
          <div class="row">
            <div>
              <div class="lab" data-i18n="months">Zeitraum (Monate)</div>
              <div class="subLab" data-i18n="monthsSub">0–12 (du bestimmst die Zeit)</div>
            </div>
            <div class="ctrl rangeWrap">
              <input id="months" type="range" min="0" max="12" step="1" value="0" data-store />
              <div class="rangeLine"><span class="muted">0</span><span class="mono" id="monthsOut">0</span><span class="muted">12</span></div>
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="months" type="button">↺ <span data-i18n="toZero">auf 0</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="workdays">Arbeitstage pro Monat</div>
              <div class="subLab" data-i18n="workdaysSub">0–30</div>
            </div>
            <div class="ctrl">
              <input id="workdays" type="number" min="0" max="30" step="1" value="0" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="workdays" type="button">↺ <span data-i18n="toZero">auf 0</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="delay">Aktivität startet</div>
              <div class="subLab" data-i18n="delaySub">realistische Verzögerung</div>
            </div>
            <div class="ctrl">
              <select id="delay" data-store>
                <option value="0" selected data-i18n="delay0">sofort</option>
                <option value="1" data-i18n="delay1">ab Folgemonat</option>
                <option value="2" data-i18n="delay2">ab Monat 3</option>
              </select>
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="delay" type="button">↺ <span data-i18n="toZeroSel">0/sofort</span></button>
            </div>
          </div>

          <!-- Ebene 1 -->
          <div class="row">
            <div>
              <div class="lab" data-i18n="e1PerDay">Neue Mitglieder pro Arbeitstag (Ebene 1)</div>
              <div class="subLab" data-i18n="e1PerDaySub">deine Erstlinie</div>
            </div>
            <div class="ctrl">
              <input id="e1PerDay" type="number" min="0" max="50" step="1" value="0" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e1PerDay" type="button">↺ <span data-i18n="toZero">auf 0</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="e1Active">Aktiv-Quote Ebene 1 (%)</div>
              <div class="subLab" data-i18n="e1ActiveSub">Realismus-Regler</div>
            </div>
            <div class="ctrl">
              <input id="e1Active" type="number" min="0" max="100" step="1" value="0" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e1Active" type="button">↺ <span data-i18n="toZero">auf 0</span></button>
            </div>
          </div>

          <!-- Hebel -->
          <div class="row">
            <div>
              <div class="lab" data-i18n="leverCount">Hebel-Personen / Teams (Anzahl)</div>
              <div class="subLab" data-i18n="leverCountSub">optional, kann 0 bleiben</div>
            </div>
            <div class="ctrl">
              <input id="leverCount" type="number" min="0" max="50" step="1" value="0" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="leverCount" type="button">↺ <span data-i18n="toZero">auf 0</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="leverPerDay">Leistung je Hebel (Neue/Arbeitstag)</div>
              <div class="subLab" data-i18n="leverPerDaySub">lädt Ebene 2 auf</div>
            </div>
            <div class="ctrl">
              <input id="leverPerDay" type="number" min="0" max="50" step="1" value="0" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="leverPerDay" type="button">↺ <span data-i18n="toZero">auf 0</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="leverActive">Aktiv-Quote Hebel (%)</div>
              <div class="subLab" data-i18n="leverActiveSub">wenn du es realistisch dämpfen willst</div>
            </div>
            <div class="ctrl">
              <input id="leverActive" type="number" min="0" max="100" step="1" value="0" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="leverActive" type="button">↺ <span data-i18n="toZero">auf 0</span></button>
            </div>
          </div>

          <!-- Ebene 2 -> 3 -->
          <div class="row">
            <div>
              <div class="lab" data-i18n="e2Active">Aktiv-Quote Ebene 2 (%)</div>
              <div class="subLab" data-i18n="e2ActiveSub">startet nach Verzögerung</div>
            </div>
            <div class="ctrl">
              <input id="e2Active" type="number" min="0" max="100" step="1" value="0" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e2Active" type="button">↺ <span data-i18n="toZero">auf 0</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="e2OutPerDay">Output aktiver Ebene 2 (Neue/Arbeitstag)</div>
              <div class="subLab" data-i18n="e2OutPerDaySub">erzeugt Ebene 3</div>
            </div>
            <div class="ctrl">
              <input id="e2OutPerDay" type="number" min="0" max="50" step="0.1" value="0" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e2OutPerDay" type="button">↺ <span data-i18n="toZero">auf 0</span></button>
            </div>
          </div>

        </div>

        <div class="compareBar">
          <div class="toggle">
            <div class="lab" data-i18n="compare">Vergleich: ohne Hebel / mit Hebel</div>
            <div class="switch noPrint" id="compareSwitch" role="switch" aria-checked="false" tabindex="0" aria-label="Vergleich umschalten">
              <div class="knob" aria-hidden="true"></div>
            </div>
            <div class="muted" data-i18n="compareSub">zeigt den Hebel-Effekt als Delta</div>
          </div>
          <div class="muted" id="wowHint" style="font-family:var(--mono);">—</div>
        </div>

      </section>

      <!-- Bausteine -->
      <section class="card">
        <div class="sectionTop">
          <div>
            <h2 data-i18n="basketTitle">Bausteine (Auswahl)</h2>
            <p class="hint" data-i18n="basketHint">
              Alles ist optional. Start ist 0. Du entscheidest, was pro neuem Mitglied als Annahme einfließt.
            </p>
          </div>
          <div class="sectionTools noPrint">
            <button class="miniBtn" id="resetBasket2" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M6 6h15l-2 9H8L6 6Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                <path d="M8 21a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" stroke="currentColor" stroke-width="2"/>
                <path d="M18 21a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" stroke="currentColor" stroke-width="2"/>
                <path d="M6 6 5 3H2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span data-i18n="basketOff">Alles aus</span>
            </button>
          </div>
        </div>

        <div class="checks">
          <div class="checkLine">
            <input id="chkMember" type="checkbox" data-store />
            <div class="checkText">
              <p class="checkTitle" data-i18n="member">Mitgliedschaft</p>
              <p class="checkSub" data-i18n="memberSub">Sockel-Baustein (wenn du ihn einbeziehen willst)</p>
            </div>
            <div class="priceTag">60 €</div>
          </div>

          <div class="checkLine">
            <input id="chkLead" type="checkbox" data-store />
            <div class="checkText">
              <p class="checkTitle" data-i18n="lead">Leadmaschine (klein)</p>
              <p class="checkSub" data-i18n="leadSub">optional</p>
            </div>
            <div class="priceTag">60 €</div>
          </div>

          <div class="checkLine">
            <input id="chkWeekend" type="checkbox" data-store />
            <div class="checkText">
              <p class="checkTitle" data-i18n="weekend">Weekend-Setup</p>
              <p class="checkSub" data-i18n="weekendSub">Absicherung + Verständnis (optional)</p>
            </div>
            <div class="priceTag">399 €</div>
          </div>
        </div>

        <div class="chips" style="margin-top:10px;">
          <div class="chip"><span data-i18n="basketPerMember">Warenkorb je neues Mitglied</span>: <span class="mono" id="basketOut">0,00 €</span></div>
        </div>

        <div class="slots noPrint" aria-label="Szenarien">
          <div class="slot">
            <div class="slotTitle" data-i18n="slotA">Szenario A</div>
            <div class="slotBtns">
              <button class="miniBtn" data-slot="A" data-action="save" type="button"><span data-i18n="save">Speichern</span></button>
              <button class="miniBtn" data-slot="A" data-action="load" type="button"><span data-i18n="load">Laden</span></button>
              <button class="miniBtn" data-slot="A" data-action="clear" type="button"><span data-i18n="clear">Löschen</span></button>
            </div>
          </div>
          <div class="slot">
            <div class="slotTitle" data-i18n="slotB">Szenario B</div>
            <div class="slotBtns">
              <button class="miniBtn" data-slot="B" data-action="save" type="button"><span data-i18n="save">Speichern</span></button>
              <button class="miniBtn" data-slot="B" data-action="load" type="button"><span data-i18n="load">Laden</span></button>
              <button class="miniBtn" data-slot="B" data-action="clear" type="button"><span data-i18n="clear">Löschen</span></button>
            </div>
          </div>
          <div class="slot">
            <div class="slotTitle" data-i18n="slotC">Szenario C</div>
            <div class="slotBtns">
              <button class="miniBtn" data-slot="C" data-action="save" type="button"><span data-i18n="save">Speichern</span></button>
              <button class="miniBtn" data-slot="C" data-action="load" type="button"><span data-i18n="load">Laden</span></button>
              <button class="miniBtn" data-slot="C" data-action="clear" type="button"><span data-i18n="clear">Löschen</span></button>
            </div>
          </div>
        </div>

      </section>

      <!-- Ergebnis -->
      <section class="card" id="results">
        <div class="sectionTop">
          <div>
            <h2 data-i18n="resultsTitle">Ergebnis</h2>
            <p class="hint" data-i18n="resultsHint">
              Ebenen getrennt + Ertrag getrennt. Live, mit sichtbarem Count-Up.
            </p>
          </div>
          <div class="sectionTools noPrint">
            <button class="miniBtn" id="btnZeroEarnings" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M4 12h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M12 4v16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span data-i18n="recalc">Neu berechnen</span>
            </button>
          </div>
        </div>

        <div class="kpiGrid">
          <div class="kpi">
            <p class="t" data-i18n="kNew1">Neue Mitglieder – Ebene 1</p>
            <p class="v" id="k_new1">0</p>
            <p class="d" data-i18n="kNew1d">deine Erstlinie im Zeitraum</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kNew2">Neue Mitglieder – Ebene 2</p>
            <p class="v" id="k_new2">0</p>
            <p class="d" data-i18n="kNew2d">entsteht durch Aktivität</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kNew3">Neue Mitglieder – Ebene 3</p>
            <p class="v" id="k_new3">0</p>
            <p class="d" data-i18n="kNew3d">zweite Wachstumswelle</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kNewT">Gesamt neue Mitglieder</p>
            <p class="v" id="k_newT">0</p>
            <p class="d" data-i18n="kNewTd">Summe Ebene 1–3</p>
          </div>

          <div class="kpi">
            <p class="t" data-i18n="kEarn1">Ertrag – Ebene 1 (Orientierung)</p>
            <p class="v" id="k_e1">0,00 €</p>
            <p class="d" data-i18n="kEarn1d">20% vom angen. Umsatz</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kEarn2">Ertrag – Ebene 2 (Orientierung)</p>
            <p class="v" id="k_e2">0,00 €</p>
            <p class="d" data-i18n="kEarn2d">15% vom angen. Umsatz</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kEarn3">Ertrag – Ebene 3 (Orientierung)</p>
            <p class="v" id="k_e3">0,00 €</p>
            <p class="d" data-i18n="kEarn3d">10% vom angen. Umsatz</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kEarnT">Gesamt-Ertrag (Orientierung)</p>
            <p class="v" id="k_eT">0,00 €</p>
            <p class="d" data-i18n="kEarnTd">Summe Ebene 1–3</p>
          </div>
        </div>

        <div class="tableWrap" aria-label="Monats-Tabelle">
          <table>
            <thead>
              <tr>
                <th data-i18n="thM">Monat</th>
                <th data-i18n="th1">Neu E1</th>
                <th data-i18n="th2">Neu E2</th>
                <th data-i18n="th3">Neu E3</th>
                <th class="right" data-i18n="thB">Warenkorb</th>
                <th class="right" data-i18n="thE1">Ertrag E1</th>
                <th class="right" data-i18n="thE2">Ertrag E2</th>
                <th class="right" data-i18n="thE3">Ertrag E3</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>

        <div class="footerNote" data-i18n="footerNote">
          Hinweis: Simulation zur Orientierung. Keine Abrechnung, keine Steuer-/Rechtsberatung. Ergebnisse hängen von Tempo, Aktivität und Zeit ab.
        </div>
      </section>

      <!-- Leser-Akkordeons -->
      <section class="card">
        <h2 data-i18n="readerTitle">Lesertext (kurz & klar)</h2>

        <details class="acc" open>
          <summary>
            <span data-i18n="accA">Was du hier siehst</span>
            <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="accBody">
            <p data-i18n="accA1">
              Dieser Rechner zeigt, wie Tragfähigkeit entstehen kann, wenn ein Prozess konsequent wiederholt wird.
              Du stellst Annahmen ein und siehst die Ebenen getrennt – inklusive Ertrag je Ebene (als Orientierung).
            </p>
          </div>
        </details>

        <details class="acc">
          <summary>
            <span data-i18n="accB">Der Hebel-Effekt</span>
            <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="accBody">
            <p data-i18n="accB1">
              Multiplikatoren (z. B. Vertrieb, Network, Agentur, Teams) erhöhen den Gesprächsfluss.
              Dadurch kann Ebene 2 schneller entstehen – und daraus Ebene 3. Der Vergleichsschalter zeigt das Delta.
            </p>
          </div>
        </details>

        <details class="acc">
          <summary>
            <span data-i18n="accC">Warum Zahlen wachsen können</span>
            <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="accBody">
            <p data-i18n="accC1">
              Wachstum ist eine Frage von Wiederholung und Zeit. Auch wenn Zahlen stark wachsen, heißt das nicht, dass alles so eintritt.
              Jeder entwickelt sich im eigenen Tempo – die Simulation zeigt Möglichkeiten, wenn man dran bleibt.
            </p>
          </div>
        </details>

      </section>

      <!-- Notizen -->
      <section class="card">
        <div class="sectionTop">
          <div>
            <h2 data-i18n="notesTitle">Notizen</h2>
            <p class="hint" data-i18n="notesHint">Bleibt nur auf deinem Gerät (LocalStorage).</p>
          </div>
          <div class="sectionTools noPrint">
            <button class="miniBtn" id="clearNotes" type="button"><span data-i18n="clearNotes">Notizen löschen</span></button>
            <button class="miniBtn" id="clearAll" type="button"><span data-i18n="clearAll">Alles löschen</span></button>
          </div>
        </div>

        <div class="notes">
          <textarea id="notes" placeholder="Deine Notizen …" aria-label="Notizen" data-store></textarea>
          <div class="noteRow">
            <div id="saveHint">Bereit.</div>
            <div class="muted" style="font-family:var(--mono);" id="lastWow">—</div>
          </div>
        </div>
      </section>

    </div>
  </div>

  <script>
    (function(){
      const PREFIX = "fsa_tc_trag3_";
      const KEY = PREFIX + "state";
      const KEY_SLOT = (s)=> PREFIX + "slot_" + s;
      const KEY_LANG = PREFIX + "lang";

      // -------- i18n --------
      const I18N = {
        de: {
          h1:"Tragfähigkeits-Rechner (3 Ebenen)",
          sub:"Dieser Rechner macht sichtbar, wie kontinuierliches Dranbleiben eine Struktur aufbaut, die mit der Zeit stärker trägt. Du stellst deine Annahmen selbst ein – alles startet bewusst bei 0.",
          copy:"Kopieren", print:"Drucken", resetAll:"Alles auf 0",
          heroTitle:"Wichtiger Hinweis",
          heroText:"Auch wenn Zahlen stark wachsen, heißt das nicht, dass alles genau so eintrifft. Jeder entwickelt sich in seinem Tempo. Die Szenarien zeigen, was grundsätzlich möglich ist, wenn man dran bleibt – oft ist es weniger die Frage ob, sondern wann es greifbar wird.",
          l1:"Ebene 1", l2:"Ebene 2", l3:"Ebene 3", allZero:"Startwerte: alles 0",

          inputsTitle:"Einstellungen",
          inputsHint:"Alles ist frei einstellbar. Jeder beginnt bei 0 und setzt eigene Annahmen.",
          resetTime:"Zeitraum auf 0", resetBuild:"Aufbau auf 0", resetBasket:"Bausteine aus",

          months:"Zeitraum (Monate)", monthsSub:"0–12 (du bestimmst die Zeit)",
          workdays:"Arbeitstage pro Monat", workdaysSub:"0–30",
          delay:"Aktivität startet", delaySub:"realistische Verzögerung",
          delay0:"sofort", delay1:"ab Folgemonat", delay2:"ab Monat 3",

          e1PerDay:"Neue Mitglieder pro Arbeitstag (Ebene 1)", e1PerDaySub:"deine Erstlinie",
          e1Active:"Aktiv-Quote Ebene 1 (%)", e1ActiveSub:"Realismus-Regler",
          leverCount:"Hebel-Personen / Teams (Anzahl)", leverCountSub:"optional, kann 0 bleiben",
          leverPerDay:"Leistung je Hebel (Neue/Arbeitstag)", leverPerDaySub:"lädt Ebene 2 auf",
          leverActive:"Aktiv-Quote Hebel (%)", leverActiveSub:"wenn du es realistisch dämpfen willst",
          e2Active:"Aktiv-Quote Ebene 2 (%)", e2ActiveSub:"startet nach Verzögerung",
          e2OutPerDay:"Output aktiver Ebene 2 (Neue/Arbeitstag)", e2OutPerDaySub:"erzeugt Ebene 3",

          compare:"Vergleich: ohne Hebel / mit Hebel", compareSub:"zeigt den Hebel-Effekt als Delta",
          toZero:"auf 0", toZeroSel:"0/sofort",

          basketTitle:"Bausteine (Auswahl)",
          basketHint:"Alles ist optional. Start ist 0. Du entscheidest, was pro neuem Mitglied als Annahme einfließt.",
          basketOff:"Alles aus",
          member:"Mitgliedschaft", memberSub:"Sockel-Baustein (wenn du ihn einbeziehen willst)",
          lead:"Leadmaschine (klein)", leadSub:"optional",
          weekend:"Weekend-Setup", weekendSub:"Absicherung + Verständnis (optional)",
          basketPerMember:"Warenkorb je neues Mitglied",
          slotA:"Szenario A", slotB:"Szenario B", slotC:"Szenario C",
          save:"Speichern", load:"Laden", clear:"Löschen",

          resultsTitle:"Ergebnis",
          resultsHint:"Ebenen getrennt + Ertrag getrennt. Live, mit sichtbarem Count-Up.",
          recalc:"Neu berechnen",

          kNew1:"Neue Mitglieder – Ebene 1", kNew1d:"deine Erstlinie im Zeitraum",
          kNew2:"Neue Mitglieder – Ebene 2", kNew2d:"entsteht durch Aktivität",
          kNew3:"Neue Mitglieder – Ebene 3", kNew3d:"zweite Wachstumswelle",
          kNewT:"Gesamt neue Mitglieder", kNewTd:"Summe Ebene 1–3",
          kEarn1:"Ertrag – Ebene 1 (Orientierung)", kEarn1d:"20% vom angen. Umsatz",
          kEarn2:"Ertrag – Ebene 2 (Orientierung)", kEarn2d:"15% vom angen. Umsatz",
          kEarn3:"Ertrag – Ebene 3 (Orientierung)", kEarn3d:"10% vom angen. Umsatz",
          kEarnT:"Gesamt-Ertrag (Orientierung)", kEarnTd:"Summe Ebene 1–3",

          thM:"Monat", th1:"Neu E1", th2:"Neu E2", th3:"Neu E3", thB:"Warenkorb",
          thE1:"Ertrag E1", thE2:"Ertrag E2", thE3:"Ertrag E3",

          footerNote:"Hinweis: Simulation zur Orientierung. Keine Abrechnung, keine Steuer-/Rechtsberatung. Ergebnisse hängen von Tempo, Aktivität und Zeit ab.",

          readerTitle:"Lesertext (kurz & klar)",
          accA:"Was du hier siehst",
          accA1:"Dieser Rechner zeigt, wie Tragfähigkeit entstehen kann, wenn ein Prozess konsequent wiederholt wird. Du stellst Annahmen ein und siehst die Ebenen getrennt – inklusive Ertrag je Ebene (als Orientierung).",
          accB:"Der Hebel-Effekt",
          accB1:"Multiplikatoren (z. B. Vertrieb, Network, Agentur, Teams) erhöhen den Gesprächsfluss. Dadurch kann Ebene 2 schneller entstehen – und daraus Ebene 3. Der Vergleichsschalter zeigt das Delta.",
          accC:"Warum Zahlen wachsen können",
          accC1:"Wachstum ist eine Frage von Wiederholung und Zeit. Auch wenn Zahlen stark wachsen, heißt das nicht, dass alles so eintritt. Jeder entwickelt sich im eigenen Tempo – die Simulation zeigt Möglichkeiten, wenn man dran bleibt.",

          notesTitle:"Notizen",
          notesHint:"Bleibt nur auf deinem Gerät (LocalStorage).",
          clearNotes:"Notizen löschen",
          clearAll:"Alles löschen"
        },
        en: {
          h1:"Sustainability Calculator (3 Levels)",
          sub:"This calculator makes visible how consistent repetition can build a structure that carries more over time. You set your own assumptions — everything intentionally starts at 0.",
          copy:"Copy", print:"Print", resetAll:"Reset to 0",
          heroTitle:"Important note",
          heroText:"Even if numbers grow fast, it doesn’t mean everything will happen exactly like that. Everyone moves at their own pace. These scenarios show what can be possible if you stay consistent — often it’s less about if, and more about when it becomes tangible.",
          l1:"Level 1", l2:"Level 2", l3:"Level 3", allZero:"Defaults: all 0",

          inputsTitle:"Settings",
          inputsHint:"Everything is adjustable. Everyone starts at 0 and sets their own assumptions.",
          resetTime:"Timeframe to 0", resetBuild:"Build to 0", resetBasket:"Modules off",

          months:"Timeframe (months)", monthsSub:"0–12 (you set the time)",
          workdays:"Workdays per month", workdaysSub:"0–30",
          delay:"Activity starts", delaySub:"realistic delay",
          delay0:"immediately", delay1:"next month", delay2:"month 3",

          e1PerDay:"New members per workday (Level 1)", e1PerDaySub:"your direct line",
          e1Active:"Active rate Level 1 (%)", e1ActiveSub:"realism control",
          leverCount:"Multipliers / Teams (count)", leverCountSub:"optional, can be 0",
          leverPerDay:"Performance per multiplier (new/workday)", leverPerDaySub:"loads Level 2",
          leverActive:"Active rate multipliers (%)", leverActiveSub:"optional damping",
          e2Active:"Active rate Level 2 (%)", e2ActiveSub:"after delay",
          e2OutPerDay:"Output of active Level 2 (new/workday)", e2OutPerDaySub:"creates Level 3",

          compare:"Compare: without / with multipliers", compareSub:"shows the multiplier delta",
          toZero:"to 0", toZeroSel:"0/immediate",

          basketTitle:"Modules (selection)",
          basketHint:"Everything is optional. Start is 0. You decide what counts per new member as an assumption.",
          basketOff:"All off",
          member:"Membership", memberSub:"base module (only if you include it)",
          lead:"Lead machine (small)", leadSub:"optional",
          weekend:"Weekend setup", weekendSub:"security + understanding (optional)",
          basketPerMember:"Basket per new member",
          slotA:"Scenario A", slotB:"Scenario B", slotC:"Scenario C",
          save:"Save", load:"Load", clear:"Clear",

          resultsTitle:"Results",
          resultsHint:"Levels separated + earnings separated. Live with visible count-up.",
          recalc:"Recalculate",

          kNew1:"New members – Level 1", kNew1d:"your direct line in timeframe",
          kNew2:"New members – Level 2", kNew2d:"created by activity",
          kNew3:"New members – Level 3", kNew3d:"second wave",
          kNewT:"Total new members", kNewTd:"sum Level 1–3",
          kEarn1:"Earnings – Level 1 (orientation)", kEarn1d:"20% of assumed revenue",
          kEarn2:"Earnings – Level 2 (orientation)", kEarn2d:"15% of assumed revenue",
          kEarn3:"Earnings – Level 3 (orientation)", kEarn3d:"10% of assumed revenue",
          kEarnT:"Total earnings (orientation)", kEarnTd:"sum Level 1–3",

          thM:"Month", th1:"New L1", th2:"New L2", th3:"New L3", thB:"Basket",
          thE1:"Earn L1", thE2:"Earn L2", thE3:"Earn L3",

          footerNote:"Note: Simulation for orientation. No billing, no tax/legal advice. Results depend on pace, activity and time.",

          readerTitle:"Reader text (short & clear)",
          accA:"What you see here",
          accA1:"This calculator shows how sustainability can emerge when a process is repeated consistently. You set assumptions and see levels separated — including earnings per level (orientation).",
          accB:"The multiplier effect",
          accB1:"Multipliers (sales, network, agencies, teams) increase conversation flow. This can accelerate Level 2 — and therefore Level 3. The compare toggle shows the delta.",
          accC:"Why numbers can grow",
          accC1:"Growth is a question of repetition and time. Even if numbers grow, it doesn’t mean it will happen exactly like that. Everyone moves at their own pace — this shows what can be possible if you stay consistent.",

          notesTitle:"Notes",
          notesHint:"Stored only on your device (LocalStorage).",
          clearNotes:"Clear notes",
          clearAll:"Clear everything"
        }
      };

      function setLang(lang){
        const dict = I18N[lang] || I18N.de;
        document.documentElement.lang = (lang === "en") ? "en" : "de";
        document.querySelectorAll("[data-i18n]").forEach(el=>{
          const k = el.getAttribute("data-i18n");
          if(dict[k] != null) el.textContent = dict[k];
        });
        document.getElementById("langDE").setAttribute("aria-pressed", String(lang !== "en"));
        document.getElementById("langEN").setAttribute("aria-pressed", String(lang === "en"));
        try{ localStorage.setItem(KEY_LANG, lang); }catch(e){}
      }

      // -------- helpers --------
      const $ = (id)=> document.getElementById(id);
      const clamp = (n,min,max)=> Math.min(max, Math.max(min, n));
      const toNum = (v)=>{
        const n = Number(String(v).replace(",", "."));
        return Number.isFinite(n) ? n : 0;
      };
      const pct = (v)=> clamp(toNum(v), 0, 100) / 100;
      const fmtEUR = (x)=>{
        const v = Number.isFinite(x) ? x : 0;
        return v.toLocaleString(document.documentElement.lang === "en" ? "en-US" : "de-DE", {
          style:"currency", currency:"EUR", minimumFractionDigits:2, maximumFractionDigits:2
        });
      };
      const fmtInt = (x)=> {
        const v = Math.round(Number.isFinite(x) ? x : 0);
        return v.toLocaleString(document.documentElement.lang === "en" ? "en-US" : "de-DE");
      };

      // -------- state IO --------
      function readStateFromDom(){
        const ids = [
          "months","workdays","delay","e1PerDay","e1Active",
          "leverCount","leverPerDay","leverActive",
          "e2Active","e2OutPerDay",
          "chkMember","chkLead","chkWeekend",
          "notes"
        ];
        const out = {};
        ids.forEach(id=>{
          const el = $(id);
          if(!el) return;
          if(el.type === "checkbox") out[id] = !!el.checked;
          else out[id] = el.value;
        });
        out._compare = compareOn;
        return out;
      }

      function writeStateToDom(s){
        if(!s || typeof s !== "object") return;
        Object.keys(s).forEach(id=>{
          const el = $(id);
          if(!el) return;
          if(el.type === "checkbox") el.checked = !!s[id];
          else el.value = String(s[id]);
        });
        if(typeof s._compare === "boolean"){
          compareOn = s._compare;
          renderCompareSwitch();
        }
        updateMonthsOut();
      }

      function save(){
        try{
          localStorage.setItem(KEY, JSON.stringify(readStateFromDom()));
          setSaveHint("Gespeichert.");
        }catch(e){
          setSaveHint("Speichern fehlgeschlagen.");
        }
      }

      function load(){
        try{
          const raw = localStorage.getItem(KEY);
          if(!raw) return;
          const obj = JSON.parse(raw);
          writeStateToDom(obj);
        }catch(e){}
      }

      // -------- save hint --------
      const saveHintEl = $("saveHint");
      function setSaveHint(msg){
        if(!saveHintEl) return;
        saveHintEl.textContent = msg;
      }
      let saveT = null;
      function scheduleSave(){
        setSaveHint("Speichert…");
        if(saveT) clearTimeout(saveT);
        saveT = setTimeout(()=>{ save(); saveT=null; }, 220);
      }

      // -------- compare --------
      let compareOn = false;
      const compareSwitch = $("compareSwitch");
      function renderCompareSwitch(){
        if(!compareSwitch) return;
        compareSwitch.classList.toggle("on", compareOn);
        compareSwitch.setAttribute("aria-checked", String(compareOn));
      }
      function toggleCompare(){
        compareOn = !compareOn;
        renderCompareSwitch();
        scheduleSave();
        recalc(true);
      }

      if(compareSwitch){
        compareSwitch.addEventListener("click", toggleCompare);
        compareSwitch.addEventListener("keydown", (e)=>{
          if(e.key === "Enter" || e.key === " "){
            e.preventDefault();
            toggleCompare();
          }
        });
      }

      // -------- reset helpers --------
      function setToZero(id){
        const el = $(id);
        if(!el) return;
        if(el.tagName === "SELECT"){
          el.value = "0";
        }else if(el.type === "checkbox"){
          el.checked = false;
        }else{
          el.value = "0";
        }
      }

      function resetTimeBlock(){
        setToZero("months");
        setToZero("workdays");
        setToZero("delay");
        updateMonthsOut();
      }

      function resetBuildBlock(){
        ["e1PerDay","e1Active","leverCount","leverPerDay","leverActive","e2Active","e2OutPerDay"].forEach(setToZero);
      }

      function resetBasketBlock(){
        ["chkMember","chkLead","chkWeekend"].forEach(setToZero);
      }

      function resetAll(){
        resetTimeBlock();
        resetBuildBlock();
        resetBasketBlock();
        setToZero("notes");
        compareOn = false;
        renderCompareSwitch();
        scheduleSave();
        recalc(true);
        setSaveHint("Alles auf 0.");
      }

      $("btnResetAll")?.addEventListener("click", resetAll);
      $("resetTime")?.addEventListener("click", ()=>{ resetTimeBlock(); scheduleSave(); recalc(true); });
      $("resetBuild")?.addEventListener("click", ()=>{ resetBuildBlock(); scheduleSave(); recalc(true); });
      $("resetBasket")?.addEventListener("click", ()=>{ resetBasketBlock(); scheduleSave(); recalc(true); });
      $("resetBasket2")?.addEventListener("click", ()=>{ resetBasketBlock(); scheduleSave(); recalc(true); });

      document.querySelectorAll("[data-reset]").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          const id = btn.getAttribute("data-reset");
          if(id === "delay") $("delay").value = "0";
          else setToZero(id);
          updateMonthsOut();
          scheduleSave();
          recalc(true);
        });
      });

      // -------- scenario slots --------
      function slotKey(s){ return KEY_SLOT(s); }
      function slotSave(s){
        try{
          localStorage.setItem(slotKey(s), JSON.stringify(readStateFromDom()));
          setSaveHint("Szenario " + s + " gespeichert.");
        }catch(e){
          setSaveHint("Speichern fehlgeschlagen.");
        }
      }
      function slotLoad(s){
        try{
          const raw = localStorage.getItem(slotKey(s));
          if(!raw){ setSaveHint("Szenario " + s + " leer."); return; }
          const obj = JSON.parse(raw);
          writeStateToDom(obj);
          setSaveHint("Szenario " + s + " geladen.");
          scheduleSave();
          recalc(true);
        }catch(e){
          setSaveHint("Laden fehlgeschlagen.");
        }
      }
      function slotClear(s){
        try{
          localStorage.removeItem(slotKey(s));
          setSaveHint("Szenario " + s + " gelöscht.");
        }catch(e){}
      }
      document.querySelectorAll("[data-slot][data-action]").forEach(b=>{
        b.addEventListener("click", ()=>{
          const s = b.getAttribute("data-slot");
          const a = b.getAttribute("data-action");
          if(a === "save") slotSave(s);
          if(a === "load") slotLoad(s);
          if(a === "clear") slotClear(s);
        });
      });

      // -------- notes clear --------
      $("clearNotes")?.addEventListener("click", ()=>{
        $("notes").value = "";
        scheduleSave();
      });
      $("clearAll")?.addEventListener("click", ()=>{
        try{
          const keys = [];
          for(let i=0;i<localStorage.length;i++){
            const k = localStorage.key(i);
            if(k && k.startsWith(PREFIX)) keys.push(k);
          }
          keys.forEach(k=>localStorage.removeItem(k));
        }catch(e){}
        resetAll();
        setSaveHint("Alles gelöscht.");
      });

      // -------- months out --------
      function updateMonthsOut(){
        $("monthsOut").textContent = String($("months").value || "0");
      }
      $("months")?.addEventListener("input", ()=>{ updateMonthsOut(); scheduleSave(); recalc(true); });

      // -------- basket --------
      function getBasket(){
        const b =
          ($("chkMember").checked ? 60 : 0) +
          ($("chkLead").checked ? 60 : 0) +
          ($("chkWeekend").checked ? 399 : 0);
        return b;
      }

      function updateBasketOut(){
        $("basketOut").textContent = fmtEUR(getBasket());
      }

      // -------- wow / count up --------
      const wowHint = $("wowHint");
      const lastWow = $("lastWow");
      function setWow(msg){
        if(wowHint) wowHint.textContent = msg;
        if(lastWow) lastWow.textContent = msg;
      }

      function animateNumber(el, from, to, fmt){
        const start = performance.now();
        const dur = 520;
        function step(t){
          const p = Math.min(1, (t - start) / dur);
          const eased = 1 - Math.pow(1 - p, 3);
          const v = from + (to - from) * eased;
          el.textContent = fmt(v);
          if(p < 1) requestAnimationFrame(step);
        }
        requestAnimationFrame(step);
      }

      function setKPI(id, val, isMoney){
        const el = $(id);
        if(!el) return;
        const oldText = el.textContent || "0";
        const oldVal = isMoney ? parseMoney(oldText) : parseIntText(oldText);
        const fmt = isMoney ? (x)=>fmtEUR(x) : (x)=>fmtInt(x);
        animateNumber(el, oldVal, val, fmt);
      }

      function parseIntText(s){
        const t = String(s).replace(/[^\d\-]/g,"");
        const n = Number(t);
        return Number.isFinite(n) ? n : 0;
      }
      function parseMoney(s){
        // very forgiving parse
        const t = String(s).replace(/\./g,"").replace(",",".").replace(/[^\d\.\-]/g,"");
        const n = Number(t);
        return Number.isFinite(n) ? n : 0;
      }

      // -------- core calc --------
      function calcScenario(opts){
        // opts: { ignoreLever:boolean }
        const months = clamp(toNum($("months").value), 0, 12);
        const workdays = clamp(toNum($("workdays").value), 0, 30);
        const delay = clamp(toNum($("delay").value), 0, 2);

        const e1PerDay = clamp(toNum($("e1PerDay").value), 0, 50);
        const e1Active = pct($("e1Active").value);

        const leverCountRaw = clamp(toNum($("leverCount").value), 0, 50);
        const leverCount = (opts && opts.ignoreLever) ? 0 : leverCountRaw;
        const leverPerDay = clamp(toNum($("leverPerDay").value), 0, 50);
        const leverActive = pct($("leverActive").value);

        const e2Active = pct($("e2Active").value);
        const e2OutPerDay = clamp(toNum($("e2OutPerDay").value), 0, 50);

        const basket = getBasket();

        const r1 = 0.20, r2 = 0.15, r3 = 0.10;

        let cumE2 = 0;

        let sum1=0, sum2=0, sum3=0;
        let earn1=0, earn2=0, earn3=0;

        const rows = [];

        // We'll use: E1 builds directly.
        // E2 is produced by multipliers (subset inside Level 1) as their own repeatable activity.
        // E3 is produced by active Level 2 after delay.
        for(let m=1; m<=months; m++){
          const new1 = workdays * e1PerDay;
          // optional realism: only active portion of E1 matters elsewhere, but we don't model E1 -> E2 generally
          // multipliers:
          const activeLevers = leverCount * leverActive; // can be fractional for realism
          const new2 = activeLevers * workdays * leverPerDay;

          // E3 uses cumE2 up to month (m - delay)
          // We'll approximate by using cumE2_beforeDelay = cumE2_prev when m <= delay -> 0
          // and for m > delay -> cumE2 history (we store cumE2 per month).
          // We'll keep history array.
          rows.push({ m, new1, new2, new3:0, basket, e1:0, e2:0, e3:0 });
        }

        // second pass for E3 with delay + cumE2 history
        let cumE2History = [0]; // index by month
        let cumE2Run = 0;
        for(let i=1;i<=months;i++){
          cumE2Run += rows[i-1].new2;
          cumE2History[i] = cumE2Run;
        }

        for(let i=1;i<=months;i++){
          const row = rows[i-1];
          const refMonth = i - delay;
          const cumE2ForAct = (refMonth >= 1) ? cumE2History[refMonth] : 0;
          const activeE2 = cumE2ForAct * e2Active;
          const new3 = activeE2 * workdays * e2OutPerDay;

          row.new3 = new3;

          // earnings by level using new members per level (assumed basket)
          row.e1 = row.new1 * basket * r1;
          row.e2 = row.new2 * basket * r2;
          row.e3 = row.new3 * basket * r3;

          sum1 += row.new1;
          sum2 += row.new2;
          sum3 += row.new3;
          earn1 += row.e1;
          earn2 += row.e2;
          earn3 += row.e3;
        }

        return {
          months, workdays, delay,
          basket,
          sum1, sum2, sum3,
          earn1, earn2, earn3,
          rows
        };
      }

      function buildTable(rows){
        const tbody = $("tbody");
        tbody.innerHTML = "";
        rows.forEach(r=>{
          const tr = document.createElement("tr");

          const tdM = document.createElement("td");
          tdM.textContent = String(r.m);
          tr.appendChild(tdM);

          const td1 = document.createElement("td");
          td1.textContent = fmtInt(r.new1);
          tr.appendChild(td1);

          const td2 = document.createElement("td");
          td2.textContent = fmtInt(r.new2);
          tr.appendChild(td2);

          const td3 = document.createElement("td");
          td3.textContent = fmtInt(r.new3);
          tr.appendChild(td3);

          const tdB = document.createElement("td");
          tdB.className = "right";
          tdB.textContent = fmtEUR(r.basket);
          tr.appendChild(tdB);

          const tdE1 = document.createElement("td");
          tdE1.className = "right";
          tdE1.textContent = fmtEUR(r.e1);
          tr.appendChild(tdE1);

          const tdE2 = document.createElement("td");
          tdE2.className = "right";
          tdE2.textContent = fmtEUR(r.e2);
          tr.appendChild(tdE2);

          const tdE3 = document.createElement("td");
          tdE3.className = "right";
          tdE3.textContent = fmtEUR(r.e3);
          tr.appendChild(tdE3);

          tbody.appendChild(tr);
        });
      }

      function recalc(showWow){
        updateMonthsOut();
        updateBasketOut();

        const withLever = calcScenario({ ignoreLever:false });
        const withoutLever = calcScenario({ ignoreLever:true });

        // display main scenario = with lever (normal)
        const main = withLever;

        const totalNew = main.sum1 + main.sum2 + main.sum3;
        const totalEarn = main.earn1 + main.earn2 + main.earn3;

        setKPI("k_new1", main.sum1, false);
        setKPI("k_new2", main.sum2, false);
        setKPI("k_new3", main.sum3, false);
        setKPI("k_newT", totalNew, false);

        setKPI("k_e1", main.earn1, true);
        setKPI("k_e2", main.earn2, true);
        setKPI("k_e3", main.earn3, true);
        setKPI("k_eT", totalEarn, true);

        buildTable(main.rows);

        // wow messaging
        if(showWow){
          if(main.months === 0 || main.workdays === 0){
            setWow("Setze Monate & Arbeitstage → dann wird es sichtbar.");
          }else{
            const deltaNew = withLever.sum2 + withLever.sum3 - (withoutLever.sum2 + withoutLever.sum3);
            const deltaEarn = (withLever.earn2 + withLever.earn3) - (withoutLever.earn2 + withoutLever.earn3);

            if(compareOn){
              setWow("Delta (mit vs. ohne Hebel): +" + fmtInt(deltaNew) + " | +" + fmtEUR(deltaEarn));
            }else{
              // tiny “wow” hints
              if(main.sum3 > 0){
                setWow("Ebene 3 ist aktiv → jetzt wird es greifbar.");
              }else if(main.sum2 > 0){
                setWow("Ebene 2 baut sich auf → Zeit wirkt als Verstärker.");
              }else if(main.sum1 > 0){
                setWow("Ebene 1 steht → der Rest ist Wiederholung + Zeit.");
              }else{
                setWow("Setze Annahmen → der Effekt wird sichtbar.");
              }
            }
          }
        }

        // compare mode: if on, temporarily display “with lever” but show delta line already handled.
        // also: if compareOn, we dim lever fields? we keep simple.

        // compare switch effect: If compareOn, we keep normal view but show delta message above.
      }

      $("btnZeroEarnings")?.addEventListener("click", ()=>recalc(true));

      // -------- copy --------
      $("btnCopy")?.addEventListener("click", async ()=>{
        const s = readStateFromDom();
        const main = calcScenario({ ignoreLever:false });
        const totalNew = main.sum1 + main.sum2 + main.sum3;
        const totalEarn = main.earn1 + main.earn2 + main.earn3;

        const lines = [];
        lines.push("Tragfähigkeits-Rechner (3 Ebenen)");
        lines.push("Zeitraum (Monate): " + s.months);
        lines.push("Arbeitstage/Monat: " + s.workdays);
        lines.push("Aktivität startet: " + (s.delay === "2" ? "ab Monat 3" : (s.delay === "1" ? "ab Folgemonat" : "sofort")));
        lines.push("");
        lines.push("Ebene 1: neue/Tag=" + s.e1PerDay + " | Aktiv-Quote=" + s.e1Active + "%");
        lines.push("Hebel: Anzahl=" + s.leverCount + " | Leistung/Tag=" + s.leverPerDay + " | Aktiv-Quote=" + s.leverActive + "%");
        lines.push("Ebene 2: Aktiv-Quote=" + s.e2Active + "% | Output/Tag=" + s.e2OutPerDay);
        lines.push("");
        lines.push("Bausteine:");
        lines.push("  Mitgliedschaft: " + (s.chkMember ? "ja" : "nein"));
        lines.push("  Leadmaschine: " + (s.chkLead ? "ja" : "nein"));
        lines.push("  Weekend-Setup: " + (s.chkWeekend ? "ja" : "nein"));
        lines.push("  Warenkorb je neues Mitglied: " + fmtEUR(getBasket()));
        lines.push("");
        lines.push("Ergebnis (Orientierung):");
        lines.push("  Neue Mitglieder E1: " + fmtInt(main.sum1));
        lines.push("  Neue Mitglieder E2: " + fmtInt(main.sum2));
        lines.push("  Neue Mitglieder E3: " + fmtInt(main.sum3));
        lines.push("  Gesamt neue Mitglieder: " + fmtInt(totalNew));
        lines.push("  Ertrag E1 (20%): " + fmtEUR(main.earn1));
        lines.push("  Ertrag E2 (15%): " + fmtEUR(main.earn2));
        lines.push("  Ertrag E3 (10%): " + fmtEUR(main.earn3));
        lines.push("  Gesamt-Ertrag: " + fmtEUR(totalEarn));
        lines.push("");
        lines.push("Hinweis: Simulation zur Orientierung. Keine Abrechnung.");

        const text = lines.join("\n");
        try{
          await navigator.clipboard.writeText(text);
          setSaveHint("Kopiert.");
        }catch(e){
          // fallback
          const ta = document.createElement("textarea");
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try{ document.execCommand("copy"); setSaveHint("Kopiert."); }catch(err){ setSaveHint("Kopieren fehlgeschlagen."); }
          document.body.removeChild(ta);
        }
      });

      // print
      $("btnPrint")?.addEventListener("click", ()=>window.print());

      // input listeners (live)
      const liveIds = [
        "workdays","delay","e1PerDay","e1Active","leverCount","leverPerDay","leverActive","e2Active","e2OutPerDay",
        "chkMember","chkLead","chkWeekend","notes"
      ];
      liveIds.forEach(id=>{
        const el = $(id);
        if(!el) return;
        const evt = (el.tagName === "SELECT" || el.type === "checkbox") ? "change" : "input";
        el.addEventListener(evt, ()=>{
          scheduleSave();
          recalc(true);
        });
      });

      // language
      $("langDE")?.addEventListener("click", ()=>{ setLang("de"); recalc(true); });
      $("langEN")?.addEventListener("click", ()=>{ setLang("en"); recalc(true); });

      // compare behavior: when compareOn, show delta, but keep full inputs
      // (optional: if compareOn, we keep it; delta is shown in wow line)
      // We do NOT override inputs; only calculation uses both scenarios.

      // init
      const savedLang = (()=>{ try{ return localStorage.getItem(KEY_LANG) || "de"; }catch(e){ return "de"; } })();
      setLang(savedLang === "en" ? "en" : "de");

      load();
      updateMonthsOut();
      renderCompareSwitch();
      updateBasketOut();
      recalc(true);
      setSaveHint("Bereit.");

    })();
  </script>
</body>
</html>
