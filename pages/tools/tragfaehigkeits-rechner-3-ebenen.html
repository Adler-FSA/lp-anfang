<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tragfähigkeits-Rechner – 3 Ebenen</title>
  <meta name="description" content="Tragfähigkeits-Rechner (3 Ebenen): Arbeitstage 1–30, Promotoren als Mitglieder (Output fließt in Ebene 2), Aktiv-Quoten frei, Bausteine per Haken, LocalStorage, druckbar, DE/EN." />
  <meta name="robots" content="noindex,nofollow" />

  <style>
    :root{
      --bg:#ffffff;
      --txt:#0a0a0a;
      --muted:#3f3f3f;
      --line:#d6d6d6;
      --soft:#f5f5f5;
      --soft2:#fbfbfb;

      --radius:14px;
      --shadow:0 10px 24px rgba(0,0,0,.08);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      background:var(--bg);
      color:var(--txt);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;

      /* Text-Sicherheit */
      overflow-wrap:anywhere;
      word-break:break-word;
      hyphens:auto;
    }

    .wrap{
      max-width:1120px;
      margin:0 auto;
      padding:22px 16px 60px;
    }

    header{
      display:flex;
      gap:14px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
      border-bottom:1px solid var(--line);
      padding-bottom:14px;
      margin-bottom:14px;
    }

    h1{
      font-size:22px;
      line-height:1.2;
      margin:0 0 6px 0;
      letter-spacing:.2px;
    }

    .sub{
      margin:0;
      color:var(--muted);
      font-size:14px;
      line-height:1.55;
      max-width:900px;
    }

    .topActions{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }

    .btn{
      appearance:none;
      border:1px solid #111;
      background:#111;
      color:#fff;
      padding:10px 12px;
      border-radius:12px;
      font-weight:900;
      font-size:13px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      user-select:none;
    }
    .btn.secondary{
      background:#fff;
      color:#111;
      border:1px solid var(--line);
      font-weight:900;
    }
    .btn:active{transform:translateY(1px)}
    .btn svg{width:16px;height:16px}

    .pillRow{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border:1px solid var(--line);
      border-radius:999px;
      background:#fff;
      font-size:13px;
      font-weight:900;
      cursor:pointer;
      user-select:none;
    }
    .pill[aria-pressed="true"]{
      border-color:#111;
      box-shadow:0 0 0 2px rgba(0,0,0,.08) inset;
    }

    .hero{
      border:1px solid var(--line);
      background:var(--soft2);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px;
      margin:14px 0;
    }
    .heroTop{
      display:flex;
      justify-content:space-between;
      gap:12px;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    .heroTitle{
      margin:0 0 6px 0;
      font-size:16px;
      font-weight:950;
    }
    .heroText{
      margin:0;
      color:var(--muted);
      font-size:13.5px;
      line-height:1.6;
      max-width:980px;
    }
    .miniPills{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:10px;
    }
    .miniPills .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      font-size:12px;
      font-weight:900;
      white-space:nowrap;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
    }
    @media (max-width: 920px){
      .grid{grid-template-columns:1fr}
    }

    .card{
      border:1px solid var(--line);
      background:var(--soft2);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px;
    }
    .card h2{
      margin:0 0 10px 0;
      font-size:16px;
      letter-spacing:.2px;
    }
    .hint{
      margin:0 0 10px 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.55;
    }

    .row{
      display:grid;
      grid-template-columns: 1.1fr 1fr;
      gap:10px;
      align-items:center;
      padding:10px;
      border-radius:12px;
      background:#fff;
      border:1px solid var(--line);
      margin-bottom:10px;
    }
    @media (max-width:560px){
      .row{grid-template-columns:1fr}
    }
    label{
      font-weight:950;
      font-size:13px;
    }
    .small{
      color:var(--muted);
      font-size:12px;
      line-height:1.45;
      margin-top:4px;
    }

    input[type="number"], select{
      width:100%;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      font-size:14px;
      background:#fff;
      color:#111;
      box-sizing:border-box;
    }

    .split{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width:560px){
      .split{grid-template-columns:1fr}
    }

    .checkLine{
      display:flex;
      align-items:flex-start;
      gap:10px;
      padding:10px;
      border:1px solid var(--line);
      border-radius:12px;
      background:#fff;
      margin-bottom:10px;
    }
    .checkLine input{margin-top:3px}
    .checkMain{display:flex; flex-direction:column; gap:2px; flex:1;}
    .priceTag{font-family:var(--mono); font-size:12px; color:#111; white-space:nowrap;}

    .kpiGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width:920px){
      .kpiGrid{grid-template-columns:1fr}
    }
    .kpi{
      border:1px solid var(--line);
      border-radius:12px;
      background:#fff;
      padding:12px;
    }
    .kpi .t{font-size:12px; color:var(--muted); margin:0 0 6px 0; font-weight:950; text-transform:uppercase; letter-spacing:.04em;}
    .kpi .v{font-size:18px; margin:0; font-weight:950; letter-spacing:.2px;}
    .kpi .s{margin:6px 0 0 0; font-size:12px; color:var(--muted); line-height:1.45;}

    table{
      width:100%;
      border-collapse:collapse;
      background:#fff;
      border:1px solid var(--line);
      border-radius:12px;
      overflow:hidden;
    }
    th, td{
      padding:10px 10px;
      border-bottom:1px solid var(--line);
      font-size:13px;
      text-align:left;
      vertical-align:top;
      white-space:nowrap;
    }
    th{
      background:var(--soft);
      font-weight:950;
      font-size:12px;
      letter-spacing:.2px;
      text-transform:uppercase;
    }
    tr:last-child td{border-bottom:none}
    .mono{font-family:var(--mono)}
    .right{text-align:right}
    .muted{color:var(--muted)}

    .accordions{
      border:1px solid var(--line);
      background:var(--soft2);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:12px;
      margin:14px 0;
    }
    details.acc{
      border:1px solid var(--line);
      border-radius:12px;
      background:#fff;
      margin:10px 0;
      overflow:hidden;
    }
    details.acc summary{
      list-style:none;
      cursor:pointer;
      font-weight:950;
      font-size:13px;
      padding:12px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      user-select:none;
    }
    details.acc summary::-webkit-details-marker{display:none}
    .chev{
      width:18px;height:18px; flex:0 0 auto;
      transition: transform .18s ease;
    }
    details.acc[open] .chev{transform:rotate(180deg)}
    .accBody{
      padding:0 12px 12px 12px;
      border-top:1px solid var(--line);
      font-size:13.5px;
      line-height:1.6;
      color:var(--txt);
    }
    .accBody p{margin:10px 0 0 0}
    .accBody ul{margin:10px 0 0 18px}
    .accBody li{margin:6px 0}
    .accBody .muted{color:var(--muted); font-size:12.5px}

    .notes{
      margin-top:12px;
      padding:12px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#fff;
    }
    textarea{
      width:100%;
      min-height:160px;
      resize:vertical;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      font-size:14px;
      box-sizing:border-box;
      font-family:var(--sans);
      color:#111;
      background:#fff;

      overflow-wrap:anywhere;
      word-break:break-word;
      hyphens:auto;
    }
    .noteRow{
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:10px;
    }
    #saveHint{
      color:var(--muted);
      font-size:13px;
    }

    .foot{
      margin-top:14px;
      padding-top:14px;
      border-top:1px solid var(--line);
      color:var(--muted);
      font-size:12px;
      line-height:1.6;
    }

    /* Print */
    @page { margin: 12mm; }
    @media print{
      *{ -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .noPrint{display:none !important}
      header{border-bottom:1px solid #000}
      .wrap{max-width:none; padding:0}
      .card, .hero, .accordions{box-shadow:none}
      .card, .row, table, .kpi, .accordions, details.acc, .notes{break-inside:avoid; page-break-inside:avoid}
      table{width:100%}
      th, td{border-bottom:1px solid #000}
      th{background:#f0f0f0}
      .card,.hero,.accordions,details.acc,.row,.kpi,.notes,textarea,input,select{
        border-color:#000 !important;
      }
    }
  </style>
</head>

<body>
  <div class="wrap">

    <header>
      <div>
        <h1 data-i18n="h1">Tragfähigkeits-Rechner (3 Ebenen)</h1>
        <p class="sub" data-i18n="sub">
          Simulation zur Orientierung: Mitgliedschaft (60 €) ist der Sockel. Nach dem Abschluss ist die Aufgabe erledigt. Promotoren sind Mitglieder (Ebene 1) – deren Output erzeugt Ebene 2.
        </p>
      </div>

      <div class="topActions noPrint">
        <div class="pillRow" aria-label="Sprache">
          <button class="pill" id="langDE" type="button" aria-pressed="true">DE</button>
          <button class="pill" id="langEN" type="button" aria-pressed="false">EN</button>
        </div>

        <button class="btn secondary" id="btnReset" type="button">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M3 12a9 9 0 0 1 15.36-6.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M18 4v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M21 12a9 9 0 0 1-15.36 6.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span data-i18n="reset">Reset</span>
        </button>

        <button class="btn secondary" id="btnCopy" type="button">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M9 9h10v12H9V9Z" stroke="currentColor" stroke-width="2"/>
            <path d="M5 3h10v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M5 7h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M5 7v14h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span data-i18n="copy">Kopieren</span>
        </button>

        <button class="btn" id="btnPrint" type="button">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M7 8V3h10v5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M7 17h10v4H7v-4Z" stroke="currentColor" stroke-width="2"/>
            <path d="M6 18H5a3 3 0 0 1-3-3v-4a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v4a3 3 0 0 1-3 3h-1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M18 12h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
          </svg>
          <span data-i18n="print">Drucken</span>
        </button>
      </div>
    </header>

    <section class="hero">
      <div class="heroTop">
        <div>
          <div class="heroTitle" data-i18n="heroTitle">Kurzlogik (damit jeder es sofort richtig versteht)</div>
          <p class="heroText" data-i18n="heroText">
            Ebene 1 sind deine direkten Mitglieder (inkl. Profi-Promotoren, weil sie zuerst Mitglied werden). Wenn ein Profi-Promotor arbeitet, baut er seine eigene Erstlinie auf – das ist für dich Ebene 2. Ebene 3 entsteht aus der Erstlinie deiner Ebene-2-Mitglieder.
          </p>

          <div class="miniPills" aria-label="Regeln">
            <div class="tag"><span class="mono">20%</span> <span data-i18n="pillL1">Ebene 1</span></div>
            <div class="tag"><span class="mono">15%</span> <span data-i18n="pillL2">Ebene 2</span></div>
            <div class="tag"><span class="mono">10%</span> <span data-i18n="pillL3">Ebene 3</span></div>
            <div class="tag" data-i18n="pillPromoter">Promotor = Mitglied</div>
            <div class="tag" data-i18n="pillNoBill">Keine Abrechnung</div>
            <div class="tag" data-i18n="pillLocal">LocalStorage + Print</div>
          </div>
        </div>
      </div>
    </section>

    <section class="accordions">
      <details class="acc" open>
        <summary>
          <span data-i18n="acc1Title">Wie der Rechner die Ebenen versteht (wichtig)</span>
          <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </summary>
        <div class="accBody">
          <p class="muted" data-i18n="acc1P1">
            Promotoren sind keine externen „Zuflüsse“. Jeder Promotor wird zuerst Mitglied in deiner Ebene 1. Wenn er danach neue Mitglieder gewinnt, entstehen diese in deiner Ebene 2.
          </p>
          <ul>
            <li class="muted" data-i18n="acc1L1">Ebene 1: deine direkten Mitglieder (inkl. Profi-Promotoren als Mitglieder).</li>
            <li class="muted" data-i18n="acc1L2">Ebene 2: Erstlinie deiner Ebene-1-Mitglieder (z. B. Output eines Profi-Promotors).</li>
            <li class="muted" data-i18n="acc1L3">Ebene 3: Erstlinie deiner Ebene-2-Mitglieder.</li>
          </ul>
          <p class="muted" data-i18n="acc1P2">
            Deshalb erzeugt das Feld „Leistung je Profi-Promotor“ Mitglieder in Ebene 2 – nicht in Ebene 1.
          </p>
        </div>
      </details>

      <details class="acc">
        <summary>
          <span data-i18n="acc2Title">Wo trägst du was ein?</span>
          <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </summary>
        <div class="accBody">
          <ul>
            <li class="muted" data-i18n="acc2L1">„Eigene Abschlüsse/Tag“ → deine direkten Mitglieder (Ebene 1).</li>
            <li class="muted" data-i18n="acc2L2">„Profi-Promotoren (als Mitglieder in Ebene 1)“ → Anzahl Promotoren in deiner Ebene 1.</li>
            <li class="muted" data-i18n="acc2L3">„Leistung je Profi-Promotor“ → deren Abschlüsse erzeugen deine Ebene 2.</li>
            <li class="muted" data-i18n="acc2L4">Aktiv-Quoten/Output → wie stark sich Ebene 2 und Ebene 3 zusätzlich durch Aktivierung aufbauen.</li>
          </ul>
        </div>
      </details>

      <details class="acc">
        <summary>
          <span data-i18n="acc3Title">Warum nur die Mitgliedschaft aktiv angeboten wird</span>
          <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </summary>
        <div class="accBody">
          <p class="muted" data-i18n="acc3P1">
            Es gibt bis zu 50 Produkte/Bausteine. Beworben wird trotzdem nur die Mitgliedschaft – danach entscheidet jedes Mitglied freiwillig, was es nutzt und bestellt.
          </p>
          <p class="muted" data-i18n="acc3P2">
            Das System (Handbuch, Kurse, Lernpfade) übernimmt die Erklärung. So wird Lebenszeit gewonnen: Promotoren sind nicht dauerhafte Supporter.
          </p>
        </div>
      </details>

      <details class="acc">
        <summary>
          <span data-i18n="acc4Title">Hinweis: 20% bis 40% Eigenumsatz (nicht im Rechner abgebildet)</span>
          <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </summary>
        <div class="accBody">
          <p class="muted" data-i18n="acc4P1">
            Die gezeigten Anteile (20% / 15% / 10%) sind eine Beispiel-Logik zur Orientierung. Eigenumsatz kann in der Praxis von 20% bis 40% anwachsen – diese Dynamik ist bewusst nicht Teil des Rechners.
          </p>
          <p class="muted" data-i18n="acc4P2">
            Ziel ist Tragfähigkeit zu simulieren, nicht eine Abrechnung zu erzeugen.
          </p>
        </div>
      </details>
    </section>

    <div class="grid">
      <!-- INPUTS -->
      <section class="card">
        <h2 data-i18n="inputs">Eingaben</h2>
        <p class="hint" data-i18n="inputsHint">
          Ebene 1 = deine direkten Mitglieder. Profi-Promotoren sind Mitglieder in Ebene 1 – deren Leistung erzeugt deine Ebene 2.
        </p>

        <div class="row">
          <div>
            <label for="workdays" data-i18n="workdaysLabel">Arbeitstage pro Monat</label>
            <div class="small" data-i18n="workdaysHelp">Bereich: 1 bis 30.</div>
          </div>
          <div class="split">
            <input id="workdays" type="number" min="1" max="30" step="1" value="20" data-store />
            <input id="selfPerDay" type="number" min="0" max="10" step="1" value="1" data-store />
          </div>
          <div class="small muted" style="grid-column:1 / -1" data-i18n="selfPerDayHelp">Rechts: eigene Abschlüsse pro Arbeitstag (Ebene 1).</div>
        </div>

        <div class="row">
          <div>
            <label for="period" data-i18n="periodLabel">Zeitraum</label>
            <div class="small" data-i18n="periodHelp">Monat / Quartal / Jahr – Werte werden korrekt kumuliert.</div>
          </div>
          <div>
            <select id="period" data-store>
              <option value="1" data-i18n="p1">1 Monat</option>
              <option value="3" data-i18n="p3">1 Quartal (3 Monate)</option>
              <option value="12" data-i18n="p12">12 Monate</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div>
            <label for="promoters" data-i18n="promotersLabel">Profi-Promotoren (als Mitglieder in Ebene 1)</label>
            <div class="small" data-i18n="promotersHelp">
              Anzahl Profi-Promotoren in deiner Ebene 1. Deren Abschlüsse zählen als Ebene 2 (deine Zweitlinie).
            </div>
          </div>
          <div>
            <div class="split">
              <input id="promoters" type="number" min="0" max="50" step="1" value="0" data-store />
              <input id="promotersPerDay" type="number" min="0" max="10" step="1" value="1" data-store />
            </div>
            <div class="small muted" data-i18n="promotersPerDayHelp">Rechts: Abschlüsse pro Arbeitstag je Profi-Promotor (erzeugt Ebene 2).</div>
          </div>
        </div>

        <div class="row">
          <div>
            <label data-i18n="quotesTitle">Aktiv-Quoten & Output (deine Annahmen)</label>
            <div class="small" data-i18n="quotesHelp">
              Damit kann jeder skeptisch klein oder motiviert groß rechnen – und trotzdem Tragfähigkeit erkennen.
            </div>
          </div>
          <div>
            <div class="split">
              <div>
                <label class="small" for="act1" style="font-weight:950" data-i18n="act1Short">E1→E2 aktiv (%)</label>
                <input id="act1" type="number" min="0" max="100" step="1" value="30" data-store />
              </div>
              <div>
                <label class="small" for="prod1" style="font-weight:950" data-i18n="prod1Short">E1→E2 neue/Monat</label>
                <input id="prod1" type="number" min="0" max="50" step="1" value="5" data-store />
              </div>
            </div>

            <div class="split" style="margin-top:10px;">
              <div>
                <label class="small" for="act2" style="font-weight:950" data-i18n="act2Short">E2→E3 aktiv (%)</label>
                <input id="act2" type="number" min="0" max="100" step="1" value="20" data-store />
              </div>
              <div>
                <label class="small" for="prod2" style="font-weight:950" data-i18n="prod2Short">E2→E3 neue/Monat</label>
                <input id="prod2" type="number" min="0" max="50" step="1" value="3" data-store />
              </div>
            </div>

            <div class="small muted" style="margin-top:10px" data-i18n="sharesHelp">
              Beispiel-Anteile Ursprung: Ebene 1: 20% • Ebene 2: 15% • Ebene 3: 10%
            </div>
          </div>
        </div>

        <div class="row">
          <div>
            <label data-i18n="buildingBlocks">Bausteine (Umsatz pro neuem Mitglied)</label>
            <div class="small" data-i18n="blocksHelp">
              Mitgliedschaft ist fix. Alles andere ist optional und wird nur gerechnet, wenn du es auswählst.
            </div>
          </div>
          <div>
            <div class="checkLine">
              <input id="bMembership" type="checkbox" checked disabled />
              <div class="checkMain">
                <div style="display:flex;justify-content:space-between;gap:10px;">
                  <div><strong data-i18n="membership">Mitgliedschaft</strong></div>
                  <div class="priceTag">60 €</div>
                </div>
                <div class="small" data-i18n="membershipHelp">Stabiler Sockel (nicht abwählbar).</div>
              </div>
            </div>

            <div class="checkLine">
              <input id="bLead" type="checkbox" data-store />
              <div class="checkMain">
                <div style="display:flex;justify-content:space-between;gap:10px;">
                  <div><strong data-i18n="leadSmall">Leadmaschine (klein)</strong></div>
                  <div class="priceTag">60 €</div>
                </div>
                <div class="small" data-i18n="leadHelp">Optionaler Baustein zur Werbung.</div>
              </div>
            </div>

            <div class="checkLine">
              <input id="bWeekend" type="checkbox" data-store />
              <div class="checkMain">
                <div style="display:flex;justify-content:space-between;gap:10px;">
                  <div><strong data-i18n="weekend">Weekend-Setup</strong></div>
                  <div class="priceTag">399 €</div>
                </div>
                <div class="small" data-i18n="weekendHelp">Optionaler Baustein zur Orientierung & Umsetzung.</div>
              </div>
            </div>

            <div class="small muted" data-i18n="productsNote" style="margin-top:8px">
              Hinweis: Im System gibt es bis zu 50 Produkte. Hier wählst du nur Bausteine aus, die du für dein Szenario mitrechnen willst.
            </div>
          </div>
        </div>

        <div class="notes">
          <label for="notes" data-i18n="notesTitle">Meine Annahmen / Notizen zum Szenario</label>
          <div class="small" data-i18n="notesHelp">Bleibt nur auf deinem Gerät (LocalStorage). Hilft, Quoten und Entscheidungen zu dokumentieren.</div>
          <textarea id="notes" data-store placeholder="Deine Notizen …"></textarea>

          <div class="noteRow noPrint">
            <div id="saveHint" data-i18n="ready">Bereit.</div>
            <div style="display:flex;gap:10px;flex-wrap:wrap;">
              <button class="btn secondary" id="btnClearTool" type="button"><span data-i18n="clearTool">Tool-Daten löschen</span></button>
              <button class="btn secondary" id="btnClearAll" type="button"><span data-i18n="clearAll">Alle Tool-Daten löschen</span></button>
            </div>
          </div>
        </div>

        <div class="foot">
          <div data-i18n="savedNote">Deine Einstellungen werden automatisch lokal gespeichert.</div>
        </div>
      </section>

      <!-- OUTPUTS -->
      <section class="card">
        <h2 data-i18n="outputs">Ergebnis</h2>
        <p class="hint" data-i18n="outputsHint">
          Tabelle: Ebene 1 (du), Ebene 2 (Erstlinien deiner Ebene-1-Mitglieder inkl. Promotor-Output), Ebene 3 (Erstlinien deiner Ebene-2-Mitglieder).
        </p>

        <div class="kpiGrid">
          <div class="kpi">
            <p class="t" data-i18n="kpiPack">Umsatz pro neuem Mitglied (gewählt)</p>
            <p class="v mono" id="kpiPack">–</p>
            <p class="s" data-i18n="kpiPackHelp">Mitgliedschaft (fix) + optionale Bausteine.</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kpiPeriod">Zeitraum</p>
            <p class="v" id="kpiPeriod">–</p>
            <p class="s" data-i18n="kpiPeriodHelp">Monatswerte werden für Quartal/Jahr korrekt kumuliert.</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kpiNew">Neue Mitglieder gesamt (Zeitraum)</p>
            <p class="v mono" id="kpiNew">–</p>
            <p class="s" data-i18n="kpiNewHelp">Ebene 1 + Ebene 2 + Ebene 3 im Zeitraum.</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kpiEarn">Ursprung-Anteil gesamt (Zeitraum)</p>
            <p class="v mono" id="kpiEarn">–</p>
            <p class="s" data-i18n="kpiEarnHelp">Beispiel-Logik: 20% / 15% / 10% (keine Abrechnung).</p>
          </div>
        </div>

        <div style="margin-top:12px; overflow:auto;">
          <table aria-label="Ergebnis Tabelle">
            <thead>
              <tr>
                <th data-i18n="thLevel">Ebene</th>
                <th class="right" data-i18n="thNewM">Neue/Monat</th>
                <th class="right" data-i18n="thNewT">Neue/Zeitraum</th>
                <th class="right" data-i18n="thRevM">Umsatz/Monat</th>
                <th class="right" data-i18n="thRevT">Umsatz/Zeitraum</th>
                <th class="right" data-i18n="thEarnT">Ursprung/Zeitraum</th>
              </tr>
            </thead>
            <tbody id="tbl"></tbody>
          </table>
        </div>

        <div class="foot">
          <div><strong data-i18n="explainTitle">Kurz erklärt (für Neue)</strong></div>
          <div class="small" style="margin-top:6px" data-i18n="explainText">
            Promotoren sind Mitglieder in Ebene 1. Deren Leistung erzeugt Ebene 2. Ebene 3 entsteht aus Ebene 2. Mitgliedschaft ist Sockel; weitere Bausteine optional.
          </div>
        </div>
      </section>
    </div>
  </div>

  <script>
    (function(){
      const LS_PREFIX = "fsa_tools_";
      const LS_KEY = LS_PREFIX + "tragfaehigkeit_v1";

      const PRICE_MEMBERSHIP = 60;
      const PRICE_LEAD = 60;
      const PRICE_WEEKEND = 399;

      const SHARE_L1 = 0.20;
      const SHARE_L2 = 0.15;
      const SHARE_L3 = 0.10;

      const el = {
        workdays: document.getElementById("workdays"),
        selfPerDay: document.getElementById("selfPerDay"),
        period: document.getElementById("period"),
        promoters: document.getElementById("promoters"),
        promotersPerDay: document.getElementById("promotersPerDay"),
        act1: document.getElementById("act1"),
        prod1: document.getElementById("prod1"),
        act2: document.getElementById("act2"),
        prod2: document.getElementById("prod2"),
        bLead: document.getElementById("bLead"),
        bWeekend: document.getElementById("bWeekend"),
        notes: document.getElementById("notes"),

        kpiPack: document.getElementById("kpiPack"),
        kpiPeriod: document.getElementById("kpiPeriod"),
        kpiNew: document.getElementById("kpiNew"),
        kpiEarn: document.getElementById("kpiEarn"),
        tbl: document.getElementById("tbl"),

        btnPrint: document.getElementById("btnPrint"),
        btnCopy: document.getElementById("btnCopy"),
        btnReset: document.getElementById("btnReset"),
        btnClearTool: document.getElementById("btnClearTool"),
        btnClearAll: document.getElementById("btnClearAll"),
        saveHint: document.getElementById("saveHint"),

        langDE: document.getElementById("langDE"),
        langEN: document.getElementById("langEN"),
      };

      const I18N = {
        de: {
          h1:"Tragfähigkeits-Rechner (3 Ebenen)",
          sub:"Simulation zur Orientierung: Mitgliedschaft (60 €) ist der Sockel. Nach dem Abschluss ist die Aufgabe erledigt. Promotoren sind Mitglieder (Ebene 1) – deren Output erzeugt Ebene 2.",
          reset:"Reset", copy:"Kopieren", print:"Drucken",
          heroTitle:"Kurzlogik (damit jeder es sofort richtig versteht)",
          heroText:"Ebene 1 sind deine direkten Mitglieder (inkl. Profi-Promotoren, weil sie zuerst Mitglied werden). Wenn ein Profi-Promotor arbeitet, baut er seine eigene Erstlinie auf – das ist für dich Ebene 2. Ebene 3 entsteht aus der Erstlinie deiner Ebene-2-Mitglieder.",
          pillL1:"Ebene 1", pillL2:"Ebene 2", pillL3:"Ebene 3",
          pillPromoter:"Promotor = Mitglied",
          pillNoBill:"Keine Abrechnung",
          pillLocal:"LocalStorage + Print",

          acc1Title:"Wie der Rechner die Ebenen versteht (wichtig)",
          acc1P1:"Promotoren sind keine externen „Zuflüsse“. Jeder Promotor wird zuerst Mitglied in deiner Ebene 1. Wenn er danach neue Mitglieder gewinnt, entstehen diese in deiner Ebene 2.",
          acc1L1:"Ebene 1: deine direkten Mitglieder (inkl. Profi-Promotoren als Mitglieder).",
          acc1L2:"Ebene 2: Erstlinie deiner Ebene-1-Mitglieder (z. B. Output eines Profi-Promotors).",
          acc1L3:"Ebene 3: Erstlinie deiner Ebene-2-Mitglieder.",
          acc1P2:"Deshalb erzeugt das Feld „Leistung je Profi-Promotor“ Mitglieder in Ebene 2 – nicht in Ebene 1.",

          acc2Title:"Wo trägst du was ein?",
          acc2L1:"„Eigene Abschlüsse/Tag“ → deine direkten Mitglieder (Ebene 1).",
          acc2L2:"„Profi-Promotoren (als Mitglieder in Ebene 1)“ → Anzahl Promotoren in deiner Ebene 1.",
          acc2L3:"„Leistung je Profi-Promotor“ → deren Abschlüsse erzeugen deine Ebene 2.",
          acc2L4:"Aktiv-Quoten/Output → wie stark sich Ebene 2 und Ebene 3 zusätzlich durch Aktivierung aufbauen.",

          acc3Title:"Warum nur die Mitgliedschaft aktiv angeboten wird",
          acc3P1:"Es gibt bis zu 50 Produkte/Bausteine. Beworben wird trotzdem nur die Mitgliedschaft – danach entscheidet jedes Mitglied freiwillig, was es nutzt und bestellt.",
          acc3P2:"Das System (Handbuch, Kurse, Lernpfade) übernimmt die Erklärung. So wird Lebenszeit gewonnen: Promotoren sind nicht dauerhafte Supporter.",

          acc4Title:"Hinweis: 20% bis 40% Eigenumsatz (nicht im Rechner abgebildet)",
          acc4P1:"Die gezeigten Anteile (20% / 15% / 10%) sind eine Beispiel-Logik zur Orientierung. Eigenumsatz kann in der Praxis von 20% bis 40% anwachsen – diese Dynamik ist bewusst nicht Teil des Rechners.",
          acc4P2:"Ziel ist Tragfähigkeit zu simulieren, nicht eine Abrechnung zu erzeugen.",

          inputs:"Eingaben",
          inputsHint:"Ebene 1 = deine direkten Mitglieder. Profi-Promotoren sind Mitglieder in Ebene 1 – deren Leistung erzeugt deine Ebene 2.",
          workdaysLabel:"Arbeitstage pro Monat",
          workdaysHelp:"Bereich: 1 bis 30.",
          selfPerDayHelp:"Rechts: eigene Abschlüsse pro Arbeitstag (Ebene 1).",
          periodLabel:"Zeitraum",
          periodHelp:"Monat / Quartal / Jahr – Werte werden korrekt kumuliert.",
          p1:"1 Monat", p3:"1 Quartal (3 Monate)", p12:"12 Monate",

          promotersLabel:"Profi-Promotoren (als Mitglieder in Ebene 1)",
          promotersHelp:"Anzahl Profi-Promotoren in deiner Ebene 1. Deren Abschlüsse zählen als Ebene 2 (deine Zweitlinie).",
          promotersPerDayHelp:"Rechts: Abschlüsse pro Arbeitstag je Profi-Promotor (erzeugt Ebene 2).",

          quotesTitle:"Aktiv-Quoten & Output (deine Annahmen)",
          quotesHelp:"Damit kann jeder skeptisch klein oder motiviert groß rechnen – und trotzdem Tragfähigkeit erkennen.",
          act1Short:"E1→E2 aktiv (%)",
          prod1Short:"E1→E2 neue/Monat",
          act2Short:"E2→E3 aktiv (%)",
          prod2Short:"E2→E3 neue/Monat",
          sharesHelp:"Beispiel-Anteile Ursprung: Ebene 1: 20% • Ebene 2: 15% • Ebene 3: 10%",

          buildingBlocks:"Bausteine (Umsatz pro neuem Mitglied)",
          blocksHelp:"Mitgliedschaft ist fix. Alles andere ist optional und wird nur gerechnet, wenn du es auswählst.",
          membership:"Mitgliedschaft",
          membershipHelp:"Stabiler Sockel (nicht abwählbar).",
          leadSmall:"Leadmaschine (klein)",
          leadHelp:"Optionaler Baustein zur Werbung.",
          weekend:"Weekend-Setup",
          weekendHelp:"Optionaler Baustein zur Orientierung & Umsetzung.",
          productsNote:"Hinweis: Im System gibt es bis zu 50 Produkte. Hier wählst du nur Bausteine aus, die du für dein Szenario mitrechnen willst.",

          notesTitle:"Meine Annahmen / Notizen zum Szenario",
          notesHelp:"Bleibt nur auf deinem Gerät (LocalStorage). Hilft, Quoten und Entscheidungen zu dokumentieren.",

          outputs:"Ergebnis",
          outputsHint:"Tabelle: Ebene 1 (du), Ebene 2 (Erstlinien deiner Ebene-1-Mitglieder inkl. Promotor-Output), Ebene 3 (Erstlinien deiner Ebene-2-Mitglieder).",
          kpiPack:"Umsatz pro neuem Mitglied (gewählt)",
          kpiPackHelp:"Mitgliedschaft (fix) + optionale Bausteine.",
          kpiPeriod:"Zeitraum",
          kpiPeriodHelp:"Monatswerte werden für Quartal/Jahr korrekt kumuliert.",
          kpiNew:"Neue Mitglieder gesamt (Zeitraum)",
          kpiNewHelp:"Ebene 1 + Ebene 2 + Ebene 3 im Zeitraum.",
          kpiEarn:"Ursprung-Anteil gesamt (Zeitraum)",
          kpiEarnHelp:"Beispiel-Logik: 20% / 15% / 10% (keine Abrechnung).",

          thLevel:"Ebene",
          thNewM:"Neue/Monat",
          thNewT:"Neue/Zeitraum",
          thRevM:"Umsatz/Monat",
          thRevT:"Umsatz/Zeitraum",
          thEarnT:"Ursprung/Zeitraum",

          explainTitle:"Kurz erklärt (für Neue)",
          explainText:"Promotoren sind Mitglieder in Ebene 1. Deren Leistung erzeugt Ebene 2. Ebene 3 entsteht aus Ebene 2. Mitgliedschaft ist Sockel; weitere Bausteine optional.",

          level1:"Ebene 1",
          level2:"Ebene 2",
          level3:"Ebene 3",
          total:"Gesamt",

          savedNote:"Deine Einstellungen werden automatisch lokal gespeichert.",
          ready:"Bereit.",
          saving:"Speichert…",
          saved:"Gespeichert.",
          saveFail:"Speichern fehlgeschlagen.",
          clearTool:"Tool-Daten löschen",
          clearAll:"Alle Tool-Daten löschen",

          copiedOk:"Kopiert.",
          copiedFail:"Kopieren nicht möglich."
        },
        en: {
          h1:"Sustainability Calculator (3 Levels)",
          sub:"Orientation simulation: membership (€60) is the base. After closing, the task is done. Promoters are members (Level 1) — their output creates Level 2.",
          reset:"Reset", copy:"Copy", print:"Print",
          heroTitle:"Core logic (so it’s understood correctly)",
          heroText:"Level 1 is your direct members (incl. professional promoters because they first become members). When a promoter works, they build their own first line — for you that is Level 2. Level 3 is built from the first line of your Level-2 members.",
          pillL1:"Level 1", pillL2:"Level 2", pillL3:"Level 3",
          pillPromoter:"Promoter = member",
          pillNoBill:"No billing",
          pillLocal:"LocalStorage + print",

          acc1Title:"How the calculator defines the levels (important)",
          acc1P1:"Promoters are not external inflows. Every promoter first becomes a member in your Level 1. When they bring new members, those appear in your Level 2.",
          acc1L1:"Level 1: your direct members (incl. promoters as members).",
          acc1L2:"Level 2: first line of your Level-1 members (e.g., promoter output).",
          acc1L3:"Level 3: first line of your Level-2 members.",
          acc1P2:"Therefore the field “output per promoter” creates members in Level 2 — not Level 1.",

          acc2Title:"Where do you enter what?",
          acc2L1:"“Own sign-ups/day” → your direct members (Level 1).",
          acc2L2:"“Professional promoters (as members in Level 1)” → number of promoters in your Level 1.",
          acc2L3:"“Output per promoter” → their sign-ups create your Level 2.",
          acc2L4:"Activation rates/output → how strongly Level 2 and Level 3 grow through activation.",

          acc3Title:"Why only membership is actively offered",
          acc3P1:"There are up to 50 products/blocks. Still, only membership is actively offered — after that, each member voluntarily decides what to use and buy.",
          acc3P2:"The system (handbook, courses, learning paths) carries the explanation. This saves time: promoters are not permanent supporters.",

          acc4Title:"Note: 20% to 40% personal share (not modeled here)",
          acc4P1:"The shown shares (20% / 15% / 10%) are an example logic for orientation. Personal share can grow from 20% up to 40% — intentionally not modeled here.",
          acc4P2:"Goal is to simulate sustainability, not to create billing.",

          inputs:"Inputs",
          inputsHint:"Level 1 = your direct members. Promoters are members in Level 1 — their output creates your Level 2.",
          workdaysLabel:"Working days per month",
          workdaysHelp:"Range: 1 to 30.",
          selfPerDayHelp:"Right: your own sign-ups per working day (Level 1).",
          periodLabel:"Period",
          periodHelp:"Month / quarter / year — values are accumulated correctly.",
          p1:"1 month", p3:"1 quarter (3 months)", p12:"12 months",

          promotersLabel:"Professional promoters (as members in Level 1)",
          promotersHelp:"Number of professional promoters in your Level 1. Their sign-ups are counted as Level 2 (your second line).",
          promotersPerDayHelp:"Right: sign-ups per working day per promoter (creates Level 2).",

          quotesTitle:"Activation rates & output (your assumptions)",
          quotesHelp:"So skeptics can calculate small and motivated users can calculate big — and still see sustainability.",
          act1Short:"L1→L2 active (%)",
          prod1Short:"L1→L2 new/month",
          act2Short:"L2→L3 active (%)",
          prod2Short:"L2→L3 new/month",
          sharesHelp:"Example origin shares: Level 1: 20% • Level 2: 15% • Level 3: 10%",

          buildingBlocks:"Building blocks (revenue per new member)",
          blocksHelp:"Membership is fixed. Everything else is optional and only counted when selected.",
          membership:"Membership",
          membershipHelp:"Stable base (cannot be deselected).",
          leadSmall:"Lead machine (small)",
          leadHelp:"Optional advertising block.",
          weekend:"Weekend setup",
          weekendHelp:"Optional orientation & implementation block.",
          productsNote:"Note: the system includes up to 50 products. Here you only select the blocks you want to include in your scenario.",

          notesTitle:"My assumptions / scenario notes",
          notesHelp:"Stored only on your device (LocalStorage). Helps document your rates and decisions.",

          outputs:"Results",
          outputsHint:"Table: Level 1 (you), Level 2 (first lines of your Level-1 members incl. promoter output), Level 3 (first lines of your Level-2 members).",
          kpiPack:"Revenue per new member (selected)",
          kpiPackHelp:"Membership (fixed) + optional blocks.",
          kpiPeriod:"Period",
          kpiPeriodHelp:"Monthly values are accumulated correctly for quarter/year.",
          kpiNew:"Total new members (period)",
          kpiNewHelp:"Level 1 + Level 2 + Level 3 in the period.",
          kpiEarn:"Total origin share (period)",
          kpiEarnHelp:"Example logic: 20% / 15% / 10% (no billing).",

          thLevel:"Level",
          thNewM:"New/month",
          thNewT:"New/period",
          thRevM:"Revenue/month",
          thRevT:"Revenue/period",
          thEarnT:"Origin/period",

          explainTitle:"Quick explanation (beginners)",
          explainText:"Promoters are members in Level 1. Their output creates Level 2. Level 3 is built from Level 2. Membership is the base; other blocks optional.",

          level1:"Level 1",
          level2:"Level 2",
          level3:"Level 3",
          total:"Total",

          savedNote:"Your settings are stored locally.",
          ready:"Ready.",
          saving:"Saving…",
          saved:"Saved.",
          saveFail:"Save failed.",
          clearTool:"Clear tool data",
          clearAll:"Clear all tool data",

          copiedOk:"Copied.",
          copiedFail:"Copy not available."
        }
      };

      let LANG = "de";

      function t(key){
        const dict = I18N[LANG] || I18N.de;
        return dict[key] ?? I18N.de[key] ?? key;
      }

      function applyI18N(){
        document.documentElement.lang = (LANG === "de" ? "de" : "en");
        document.querySelectorAll("[data-i18n]").forEach(node=>{
          const k = node.getAttribute("data-i18n");
          node.textContent = t(k);
        });
        // options
        Array.from(el.period.options).forEach(opt=>{
          const k = opt.getAttribute("data-i18n");
          if (k) opt.textContent = t(k);
        });
        el.langDE.setAttribute("aria-pressed", LANG==="de" ? "true" : "false");
        el.langEN.setAttribute("aria-pressed", LANG==="en" ? "true" : "false");
        calc();
      }

      function clampNum(val, min, max){
        let n = Number(String(val).replace(",", "."));
        if (!Number.isFinite(n)) n = min;
        n = Math.max(min, Math.min(max, n));
        return n;
      }

      function fmtEUR(n){
        const v = Number.isFinite(n) ? n : 0;
        // always show in DE money style (tool look)
        return v.toLocaleString("de-DE", {minimumFractionDigits:2, maximumFractionDigits:2}) + " €";
      }
      function fmtInt(n){
        const v = Math.round(Number.isFinite(n) ? n : 0);
        return v.toLocaleString("de-DE");
      }

      function packValue(){
        let sum = PRICE_MEMBERSHIP;
        if (el.bLead.checked) sum += PRICE_LEAD;
        if (el.bWeekend.checked) sum += PRICE_WEEKEND;
        return sum;
      }

      function setHint(msgKey){
        if (!el.saveHint) return;
        el.saveHint.textContent = t(msgKey);
      }

      function readStore(){
        const data = { lang: LANG };
        document.querySelectorAll("[data-store]").forEach(node=>{
          if (!node.id) return;
          if (node.type === "checkbox") data[node.id] = !!node.checked;
          else data[node.id] = node.value;
        });
        return data;
      }

      function writeStore(data){
        if (!data || typeof data !== "object") return;
        if (data.lang === "en" || data.lang === "de") LANG = data.lang;

        document.querySelectorAll("[data-store]").forEach(node=>{
          if (!node.id) return;
          if (!(node.id in data)) return;
          if (node.type === "checkbox") node.checked = !!data[node.id];
          else node.value = String(data[node.id]);
        });
      }

      function saveNow(){
        try{
          localStorage.setItem(LS_KEY, JSON.stringify(readStore()));
          setHint("saved");
        }catch(e){
          setHint("saveFail");
        }
      }

      let saveTimer = null;
      function scheduleSave(){
        setHint("saving");
        if (saveTimer) clearTimeout(saveTimer);
        saveTimer = setTimeout(()=>{ saveNow(); saveTimer=null; }, 250);
      }

      function restore(){
        try{
          const raw = localStorage.getItem(LS_KEY);
          if (!raw) return;
          const obj = JSON.parse(raw);
          writeStore(obj);
        }catch(e){}
      }

      function calc(){
        // clamp inputs + write back normalized
        const wd = clampNum(el.workdays.value, 1, 30); el.workdays.value = String(wd);
        const self = clampNum(el.selfPerDay.value, 0, 10); el.selfPerDay.value = String(self);

        const months = clampNum(el.period.value, 1, 12);

        const prom = clampNum(el.promoters.value, 0, 50); el.promoters.value = String(prom);
        const promPerDay = clampNum(el.promotersPerDay.value, 0, 10); el.promotersPerDay.value = String(promPerDay);

        const a1 = clampNum(el.act1.value, 0, 100) / 100; el.act1.value = String(Math.round(a1*100));
        const out2 = clampNum(el.prod1.value, 0, 50); el.prod1.value = String(out2);

        const a2 = clampNum(el.act2.value, 0, 100) / 100; el.act2.value = String(Math.round(a2*100));
        const out3 = clampNum(el.prod2.value, 0, 50); el.prod2.value = String(out3);

        const pack = packValue();

        // MONTHLY MEMBERS
        // Level 1: your direct closes (including promoters as members only by count, not auto-added)
        // NOTE: promoters count are members; user may set selfPerDay to include them, but we also add them explicitly as L1 members:
        // Because the user said: "I hire a promoter, make him a member" -> that's a Level 1 member.
        // We count promoter persons once per period (month), not per day. (One-time onboarding)
        // Therefore: L1 monthly new = own daily closes + new promoters you onboard this month.
        // Promoter count is assumed "active promoters in your L1" (stock), not "new this month".
        // To avoid double meaning, we do NOT add promoters into L1 new automatically.
        // L1 new comes only from your own closes (clean).
        const lvl1_new_m = wd * self;

        // Level 2:
        // A) Activation of Level 1 members
        const lvl1_active_m = Math.round(lvl1_new_m * a1);
        const lvl2_from_activation_m = lvl1_active_m * out2;

        // B) Promoter output: Promoters are members in L1; their own closes create YOUR L2
        const lvl2_from_promoters_m = prom * wd * promPerDay;

        const lvl2_new_m = lvl2_from_activation_m + lvl2_from_promoters_m;

        // Level 3 from activation of level 2
        const lvl2_active_m = Math.round(lvl2_new_m * a2);
        const lvl3_new_m = lvl2_active_m * out3;

        // REVENUE monthly
        const lvl1_rev_m = lvl1_new_m * pack;
        const lvl2_rev_m = lvl2_new_m * pack;
        const lvl3_rev_m = lvl3_new_m * pack;

        // PERIOD totals
        const lvl1_new_t = lvl1_new_m * months;
        const lvl2_new_t = lvl2_new_m * months;
        const lvl3_new_t = lvl3_new_m * months;

        const lvl1_rev_t = lvl1_rev_m * months;
        const lvl2_rev_t = lvl2_rev_m * months;
        const lvl3_rev_t = lvl3_rev_m * months;

        const earn1_t = lvl1_rev_t * SHARE_L1;
        const earn2_t = lvl2_rev_t * SHARE_L2;
        const earn3_t = lvl3_rev_t * SHARE_L3;

        const new_total_t = lvl1_new_t + lvl2_new_t + lvl3_new_t;
        const earn_total = earn1_t + earn2_t + earn3_t;

        el.kpiPack.textContent = fmtEUR(pack);
        el.kpiPeriod.textContent = (LANG==="de")
          ? (months === 1 ? "1 Monat" : (months === 3 ? "1 Quartal (3 Monate)" : (months === 12 ? "12 Monate" : (months + " Monate"))))
          : (months === 1 ? "1 month" : (months === 3 ? "1 quarter (3 months)" : (months === 12 ? "12 months" : (months + " months"))));
        el.kpiNew.textContent = fmtInt(new_total_t);
        el.kpiEarn.textContent = fmtEUR(earn_total);

        // table
        const rows = [
          { name: t("level1"), nm: lvl1_new_m, nt: lvl1_new_t, rm: lvl1_rev_m, rt: lvl1_rev_t, et: earn1_t },
          { name: t("level2"), nm: lvl2_new_m, nt: lvl2_new_t, rm: lvl2_rev_m, rt: lvl2_rev_t, et: earn2_t },
          { name: t("level3"), nm: lvl3_new_m, nt: lvl3_new_t, rm: lvl3_rev_m, rt: lvl3_rev_t, et: earn3_t },
          { name: t("total"),  nm: (lvl1_new_m+lvl2_new_m+lvl3_new_m), nt: new_total_t, rm: (lvl1_rev_m+lvl2_rev_m+lvl3_rev_m), rt: (lvl1_rev_t+lvl2_rev_t+lvl3_rev_t), et: earn_total },
        ];

        el.tbl.innerHTML = rows.map(r => `
          <tr>
            <td><strong>${r.name}</strong></td>
            <td class="right mono">${fmtInt(r.nm)}</td>
            <td class="right mono">${fmtInt(r.nt)}</td>
            <td class="right mono">${fmtEUR(r.rm)}</td>
            <td class="right mono">${fmtEUR(r.rt)}</td>
            <td class="right mono">${fmtEUR(r.et)}</td>
          </tr>
        `).join("");
      }

      function buildCopyText(){
        const pack = el.kpiPack.textContent;
        const per = el.kpiPeriod.textContent;
        const newT = el.kpiNew.textContent;
        const earnT = el.kpiEarn.textContent;

        const wd = el.workdays.value;
        const self = el.selfPerDay.value;
        const prom = el.promoters.value;
        const promRate = el.promotersPerDay.value;
        const a1 = el.act1.value;
        const o1 = el.prod1.value;
        const a2 = el.act2.value;
        const o2 = el.prod2.value;

        const blocks = [
          "Mitgliedschaft (60€)",
          (el.bLead.checked ? "Leadmaschine klein (60€)" : null),
          (el.bWeekend.checked ? "Weekend-Setup (399€)" : null),
        ].filter(Boolean).join(" + ");

        const linesDE = [
          "Tragfähigkeits-Rechner (3 Ebenen) – Zusammenfassung",
          "Zeitraum: " + per,
          "Bausteine: " + blocks,
          "Umsatz pro neuem Mitglied: " + pack,
          "Neue Mitglieder gesamt (Zeitraum): " + newT,
          "Ursprung-Anteil gesamt (Zeitraum): " + earnT,
          "",
          "Eingaben:",
          "- Arbeitstage/Monat: " + wd,
          "- Eigene Abschlüsse/Tag (E1): " + self,
          "- Profi-Promotoren (als Mitglieder in E1): " + prom,
          "- Leistung je Promotor (Abschlüsse/Tag → erzeugt E2): " + promRate,
          "- Aktiv E1→E2: " + a1 + "%, Output: " + o1 + " neue/Monat",
          "- Aktiv E2→E3: " + a2 + "%, Output: " + o2 + " neue/Monat",
        ];

        const linesEN = [
          "Sustainability Calculator (3 Levels) – Summary",
          "Period: " + per,
          "Blocks: " + blocks,
          "Revenue per new member: " + pack,
          "Total new members (period): " + newT,
          "Total origin share (period): " + earnT,
          "",
          "Inputs:",
          "- Working days/month: " + wd,
          "- Own sign-ups/day (L1): " + self,
          "- Pro promoters (as members in L1): " + prom,
          "- Output per promoter (sign-ups/day → creates L2): " + promRate,
          "- Active L1→L2: " + a1 + "%, output: " + o1 + " new/month",
          "- Active L2→L3: " + a2 + "%, output: " + o2 + " new/month",
        ];

        return (LANG === "de" ? linesDE.join("\n") : linesEN.join("\n"));
      }

      async function copyToClipboard(text){
        try{
          await navigator.clipboard.writeText(text);
          setHint("copiedOk");
        }catch(e){
          try{
            const ta = document.createElement("textarea");
            ta.value = text;
            ta.style.position = "fixed";
            ta.style.left = "-9999px";
            document.body.appendChild(ta);
            ta.select();
            document.execCommand("copy");
            document.body.removeChild(ta);
            setHint("copiedOk");
          }catch(err){
            setHint("copiedFail");
          }
        }
      }

      function resetDefaults(){
        // Defaults
        el.workdays.value = "20";
        el.selfPerDay.value = "1";
        el.period.value = "1";

        el.promoters.value = "0";
        el.promotersPerDay.value = "1";

        el.act1.value = "30";
        el.prod1.value = "5";
        el.act2.value = "20";
        el.prod2.value = "3";

        el.bLead.checked = false;
        el.bWeekend.checked = false;

        el.notes.value = "";

        calc();
        scheduleSave();
      }

      function clearToolData(){
        try{
          localStorage.removeItem(LS_KEY);
        }catch(e){}
        resetDefaults();
      }

      function clearAllToolData(){
        try{
          const keys = [];
          for(let i=0;i<localStorage.length;i++){
            const k = localStorage.key(i);
            if (k && k.startsWith(LS_PREFIX)) keys.push(k);
          }
          keys.forEach(k=>localStorage.removeItem(k));
        }catch(e){}
        resetDefaults();
      }

      // Events
      document.querySelectorAll("[data-store]").forEach(node=>{
        node.addEventListener("input", ()=>{ calc(); scheduleSave(); });
        node.addEventListener("change", ()=>{ calc(); scheduleSave(); });
      });

      el.btnPrint.addEventListener("click", ()=>window.print());
      el.btnCopy.addEventListener("click", ()=>copyToClipboard(buildCopyText()));
      el.btnReset.addEventListener("click", resetDefaults);

      if (el.btnClearTool) el.btnClearTool.addEventListener("click", clearToolData);
      if (el.btnClearAll) el.btnClearAll.addEventListener("click", clearAllToolData);

      el.langDE.addEventListener("click", ()=>{
        LANG = "de";
        applyI18N();
        scheduleSave();
      });
      el.langEN.addEventListener("click", ()=>{
        LANG = "en";
        applyI18N();
        scheduleSave();
      });

      // Init
      restore();
      applyI18N(); // also triggers calc()
      setHint("ready");
      // After initial apply, save normalized state once
      saveNow();
    })();
  </script>
</body>
</html>
