<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FSA-Club – Visitenkarten Tool</title>
  <meta name="description" content="FSA-Club Visitenkarten Tool: Eingabe → Live-Vorschau → A4 Druckbogen (8 Karten) als PDF/Druck. DE/EN, LocalStorage." />
  <meta name="robots" content="noindex,nofollow" />

  <style>
    :root{
      --bg:#050814; --bg2:#020617;
      --panel:rgba(15,23,42,.88);
      --txt:#e9eef7; --muted:#a9b4c7;
      --gold:#d4af37; --gold2:#f2d37a;
      --line:rgba(212,175,55,.35);
      --shadow:0 24px 60px rgba(0,0,0,.55);
      --glow:0 0 26px rgba(212,175,55,.22), 0 10px 28px rgba(0,0,0,.55);
      --radius:18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--txt);
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(212,175,55,.18), transparent 60%),
        radial-gradient(900px 700px at 80% 30%, rgba(94,168,255,.14), transparent 55%),
        linear-gradient(180deg, var(--bg), var(--bg2));
    }

    .wrap{max-width:1180px;margin:28px auto 60px;padding:0 18px}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px}

    .brand{
      display:flex;align-items:center;gap:12px;
      padding:12px 14px;
      background:linear-gradient(180deg, rgba(15,23,42,.92), rgba(15,23,42,.72));
      border:1px solid var(--line);
      border-radius:14px;
      box-shadow:var(--shadow);
    }
    .brand svg{width:28px;height:28px;flex:0 0 28px}
    .brand b{letter-spacing:.4px}
    .brand .sub{display:block;font-size:12px;color:var(--muted);margin-top:2px}

    .lang{
      display:flex;gap:8px;align-items:center;
      padding:10px;
      background:rgba(15,23,42,.60);
      border:1px solid var(--line);
      border-radius:14px;
      box-shadow:var(--glow);
    }

    .btn{
      appearance:none;border:1px solid var(--line);
      background:linear-gradient(180deg, rgba(212,175,55,.18), rgba(15,23,42,.65));
      color:var(--txt);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:800;
      letter-spacing:.2px;
      transition:transform .12s ease, border-color .12s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px);border-color:rgba(212,175,55,.55)}
    .btn:active{transform:translateY(0px)}
    .btn.primary{
      background:linear-gradient(180deg, rgba(212,175,55,.34), rgba(212,175,55,.12));
      border-color:rgba(212,175,55,.60);
      box-shadow:0 0 22px rgba(212,175,55,.18);
    }
    .btn.ghost{background:rgba(15,23,42,.55)}
    .btn.small{padding:8px 10px;font-weight:900}

    .grid{display:grid;grid-template-columns:1.05fr .95fr;gap:16px;margin-top:14px}

    .panel{
      background:linear-gradient(180deg, rgba(15,23,42,.92), rgba(15,23,42,.72));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .panel h2{
      margin:0;padding:16px 18px;
      font-size:15px;letter-spacing:.35px;
      border-bottom:1px solid rgba(212,175,55,.18);
      background:linear-gradient(90deg, rgba(212,175,55,.10), transparent 50%);
    }
    .panel .body{padding:16px 18px}

    .form{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .field{display:flex;flex-direction:column;gap:6px}
    label{font-size:12px;color:var(--muted);letter-spacing:.25px}
    input,select{
      width:100%;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid rgba(212,175,55,.25);
      background:rgba(2,6,23,.55);
      color:var(--txt);
      outline:none;
      box-shadow:inset 0 0 0 1px rgba(0,0,0,.15);
    }
    input::placeholder{color:rgba(169,180,199,.65)}
    .row2{grid-column:span 2}

    .actions{
      display:flex;flex-wrap:wrap;gap:10px;
      margin-top:14px;align-items:center;justify-content:space-between;
    }
    .actions .left,.actions .right{display:flex;gap:10px;flex-wrap:wrap}

    .hint{margin-top:12px;font-size:12px;color:var(--muted);line-height:1.35}

    /* ===== Card Preview Frame ===== */
    .previewWrap{display:grid;gap:14px}

    .cardFrame{
      padding:16px;
      border-radius:18px;
      border:1px solid rgba(212,175,55,.22);
      background:
        radial-gradient(650px 260px at 20% 0%, rgba(212,175,55,.14), transparent 55%),
        radial-gradient(450px 220px at 90% 40%, rgba(242,211,122,.09), transparent 55%),
        linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.08));
      box-shadow:var(--glow);
    }

    /* ===== The Card (85 x 55 mm) ===== */
    .card{
      width:85mm;height:55mm;border-radius:4.2mm;
      position:relative;overflow:hidden;
      background:
        radial-gradient(120mm 45mm at 25% 0%, rgba(212,175,55,.12), transparent 60%),
        radial-gradient(130mm 55mm at 92% 65%, rgba(94,168,255,.10), transparent 62%),
        linear-gradient(180deg, #0b0f16, #05070b);
      border:1px solid rgba(212,175,55,.62);
      box-shadow:0 10px 26px rgba(0,0,0,.55);
    }
    .card:before{
      content:"";position:absolute;inset:2.1mm;
      border-radius:3.2mm;border:1px solid rgba(212,175,55,.22);
      pointer-events:none;
    }
    .card:after{
      content:"";position:absolute;inset:0;
      background:
        radial-gradient(40mm 14mm at 72% 18%, rgba(255,255,255,.06), transparent 60%),
        radial-gradient(55mm 18mm at 14% 92%, rgba(212,175,55,.08), transparent 65%);
      mix-blend-mode:screen;opacity:.75;pointer-events:none;
    }

    .cardInner{
      position:absolute;inset:0;
      padding:6mm 7mm;
      display:grid;
      grid-template-rows:auto auto 1fr auto;
      row-gap:2.2mm;
    }

    /* top line */
    .cardTop{
      display:flex;align-items:center;justify-content:space-between;gap:4mm;
      padding-bottom:2mm;
      border-bottom:1px solid rgba(212,175,55,.16);
    }
    .club{
      font-weight:950;letter-spacing:1.1px;
      color:rgba(242,211,122,.96);
      font-size:3.7mm;
      text-transform:uppercase;
      white-space:nowrap;
    }
    .role{
      font-weight:900;letter-spacing:.35px;
      color:rgba(212,175,55,.92);
      font-size:3.1mm;
      text-align:right;
      white-space:nowrap;
      opacity:.98;
    }

    /* Hero name */
    .name{
      font-weight:1000;
      letter-spacing:.15px;
      color:rgba(242,211,122,.98);
      text-shadow:0 0 16px rgba(212,175,55,.12);
      line-height:1.02;
      /* JS can reduce these via CSS vars */
      font-size:var(--nameSize, 6.3mm);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* Address */
    .addr{
      font-size:var(--addrSize, 3.25mm);
      color:rgba(233,238,247,.92);
      line-height:1.22;
    }

    /* Contact block: clear, wow, and fits */
    .contact{
      display:grid;
      grid-template-columns:1fr;
      gap:1.35mm;
      font-size:var(--contactSize, 3.0mm);
      color:rgba(233,238,247,.92);
    }
    .contactRow{
      display:grid;
      grid-template-columns:5mm 1fr;
      column-gap:2.3mm;
      align-items:start;
      padding-top:1.2mm;
      border-top:1px solid rgba(212,175,55,.12);
    }
    .contactRow:first-child{border-top:none;padding-top:0}

    .ico{width:4.6mm;height:4.6mm;display:inline-block}
    .ico svg{width:100%;height:100%}
    .ico path{fill:rgba(212,175,55,.92)}

    .contactText{
      display:flex;
      justify-content:space-between;
      gap:3mm;
      min-width:0;
    }
    .label{
      color:rgba(169,180,199,.92);
      font-weight:800;
      letter-spacing:.15px;
      white-space:nowrap;
    }
    .value{
      font-weight:900;
      color:rgba(242,211,122,.92);
      text-align:right;
      min-width:0;
      max-width:62mm;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

    /* allow wrap for really long email/web if needed (JS toggles class) */
    .value.wrap{
      white-space:normal;
      overflow:visible;
      text-overflow:clip;
      word-break:break-word;
      overflow-wrap:anywhere;
      line-height:1.12;
    }

    .miniNote{font-size:12px;color:var(--muted);line-height:1.35;margin:0}

    /* ===== Print sheet (A4 8-up) ===== */
    #printArea{display:none}

    .sheet{
      width:210mm;min-height:297mm;
      background:#fff;color:#000;
      /* safe inner margin for printers */
      padding:12mm;
    }
    .sheetGrid{
      display:grid;
      grid-template-columns:repeat(2, 85mm);
      grid-auto-rows:55mm;
      column-gap:8mm;
      row-gap:6mm;
      align-content:start;
      justify-content:start;
    }
    .cutWrap{width:85mm;height:55mm;position:relative}

    .cutWrap[data-cuts="1"] .cut:before,
    .cutWrap[data-cuts="1"] .cut:after{
      content:"";position:absolute;background:#000;opacity:.40;
    }
    .cutWrap[data-cuts="1"] .cut.tl:before{left:-3mm; top:0; width:3mm; height:.25mm;}
    .cutWrap[data-cuts="1"] .cut.tl:after{left:0; top:-3mm; width:.25mm; height:3mm;}
    .cutWrap[data-cuts="1"] .cut.tr:before{right:-3mm; top:0; width:3mm; height:.25mm;}
    .cutWrap[data-cuts="1"] .cut.tr:after{right:0; top:-3mm; width:.25mm; height:3mm;}
    .cutWrap[data-cuts="1"] .cut.bl:before{left:-3mm; bottom:0; width:3mm; height:.25mm;}
    .cutWrap[data-cuts="1"] .cut.bl:after{left:0; bottom:-3mm; width:.25mm; height:3mm;}
    .cutWrap[data-cuts="1"] .cut.br:before{right:-3mm; bottom:0; width:3mm; height:.25mm;}
    .cutWrap[data-cuts="1"] .cut.br:after{right:0; bottom:-3mm; width:.25mm; height:3mm;}

    .card.print{box-shadow:none}

    /* ===== Print rules ===== */
    @page{size:A4;margin:0}
    @media print{
      html,body{background:#fff}
      .wrap{display:none !important}
      #printArea{display:block !important}
      .sheet{padding:12mm}
      /* ensure colors */
      *{-webkit-print-color-adjust:exact; print-color-adjust:exact;}
    }
  </style>
</head>

<body>
  <div class="wrap" id="ui">
    <div class="topbar">
      <div class="brand">
        <!-- Inline SVG only -->
        <svg viewBox="0 0 64 64" aria-hidden="true">
          <defs>
            <linearGradient id="gGold" x1="0" x2="1">
              <stop offset="0" stop-color="#d4af37"/>
              <stop offset="1" stop-color="#f2d37a"/>
            </linearGradient>
          </defs>
          <path d="M32 4c10 8 18 8 26 8 0 30-10 40-26 48C16 52 6 42 6 12c8 0 16 0 26-8z"
                fill="rgba(15,23,42,.2)" stroke="url(#gGold)" stroke-width="2"/>
          <path d="M20 28h24v6H20z" fill="url(#gGold)" opacity=".9"/>
          <path d="M24 20h16v6H24z" fill="url(#gGold)" opacity=".7"/>
          <path d="M24 36h16v6H24z" fill="url(#gGold)" opacity=".7"/>
        </svg>
        <div>
          <b data-i18n="title">FSA-Club – Visitenkarten Tool</b>
          <span class="sub" data-i18n="subtitle">Eingabe → Vorschau → A4 Druckbogen (8 Karten)</span>
        </div>
      </div>

      <div class="lang">
        <button class="btn small ghost" id="btnDE" type="button">DE</button>
        <button class="btn small ghost" id="btnEN" type="button">EN</button>
      </div>
    </div>

    <div class="grid">
      <!-- Input -->
      <section class="panel">
        <h2 data-i18n="panel_input">Eingabe</h2>
        <div class="body">
          <div class="form" id="form">
            <div class="field">
              <label for="firstName" data-i18n="firstName">Vorname</label>
              <input id="firstName" type="text" placeholder="Michael" autocomplete="given-name" />
            </div>
            <div class="field">
              <label for="lastName" data-i18n="lastName">Nachname</label>
              <input id="lastName" type="text" placeholder="Rau" autocomplete="family-name" />
            </div>

            <div class="field row2">
              <label for="street" data-i18n="street">Straße + Hausnummer</label>
              <input id="street" type="text" placeholder="Ringstraße 23a" autocomplete="street-address" />
            </div>

            <div class="field">
              <label for="zip" data-i18n="zip">PLZ</label>
              <input id="zip" type="text" placeholder="64399" inputmode="numeric" autocomplete="postal-code" />
            </div>
            <div class="field">
              <label for="city" data-i18n="city">Ort</label>
              <input id="city" type="text" placeholder="Pfungstadt" autocomplete="address-level2" />
            </div>

            <div class="field">
              <label for="phone" data-i18n="phone">Telefon / Mobil</label>
              <input id="phone" type="text" placeholder="0163/2573594" autocomplete="tel" />
            </div>
            <div class="field">
              <label for="email" data-i18n="email">E-Mail</label>
              <input id="email" type="email" placeholder="michael-rau@liquiditybooster.de" autocomplete="email" />
            </div>

            <div class="field row2">
              <label for="web" data-i18n="web">Webseite</label>
              <input id="web" type="text" placeholder="https://michael-rau.liquiditybooster.de/" autocomplete="url" />
            </div>

            <div class="field row2">
              <label for="role" data-i18n="role">Tätigkeit</label>
              <select id="role"></select>
            </div>

            <div class="field row2">
              <label for="showCuts" data-i18n="cuts">Schnittmarken (optional)</label>
              <select id="showCuts">
                <option value="0" data-i18n="cuts_off">Aus</option>
                <option value="1" data-i18n="cuts_on">An</option>
              </select>
            </div>
          </div>

          <div class="actions">
            <div class="left">
              <button class="btn primary" id="btnPrint" type="button" data-i18n="btn_print">Drucken / PDF</button>
              <button class="btn" id="btnSave" type="button" data-i18n="btn_save">Daten merken</button>
              <button class="btn ghost" id="btnReset" type="button" data-i18n="btn_reset">Zurücksetzen</button>
            </div>
            <div class="right">
              <button class="btn ghost" id="btnCopy" type="button" data-i18n="btn_copy">Daten kopieren</button>
            </div>
          </div>

          <div class="hint" data-i18n="hint">
            Hinweis: Für PDF einfach „Drucken“ → „Als PDF speichern“. Wichtig: Skalierung 100% und Kopf-/Fußzeilen aus.
          </div>
        </div>
      </section>

      <!-- Preview -->
      <section class="panel">
        <h2 data-i18n="panel_preview">Vorschau</h2>
        <div class="body previewWrap">
          <div class="cardFrame">
            <div class="card" id="cardPreview" aria-label="Visitenkarten-Vorschau">
              <div class="cardInner" id="cardInnerPreview">
                <div class="cardTop">
                  <div class="club">FSA-CLUB</div>
                  <div class="role" id="pRole">Eventmanagement</div>
                </div>

                <div class="name" id="pName">Michael Rau</div>

                <div class="addr" id="pAddr">
                  Ringstraße 23a<br>
                  64399 Pfungstadt
                </div>

                <div class="contact">
                  <div class="contactRow">
                    <span class="ico" aria-hidden="true">
                      <svg viewBox="0 0 24 24"><path d="M6.6 10.8c1.6 3 4.1 5.5 7.1 7.1l2.4-2.4c.3-.3.8-.4 1.2-.2 1.3.4 2.7.7 4.1.7.7 0 1.2.5 1.2 1.2V21c0 .7-.5 1.2-1.2 1.2C10.6 22.2 1.8 13.4 1.8 2.4 1.8 1.7 2.3 1.2 3 1.2h3.6c.7 0 1.2.5 1.2 1.2 0 1.4.2 2.8.7 4.1.1.4 0 .9-.2 1.2l-2.7 2.1z"/></svg>
                    </span>
                    <div class="contactText">
                      <span class="label" id="lblPhone">Tel</span>
                      <span class="value" id="pPhone">0163/2573594</span>
                    </div>
                  </div>

                  <div class="contactRow">
                    <span class="ico" aria-hidden="true">
                      <svg viewBox="0 0 24 24"><path d="M2 6.5C2 5.1 3.1 4 4.5 4h15C20.9 4 22 5.1 22 6.5v11C22 18.9 20.9 20 19.5 20h-15C3.1 20 2 18.9 2 17.5v-11zm2.2.2 7.2 5.1c.4.3 1 .3 1.4 0l7.2-5.1c-.2-.4-.6-.6-1.1-.6h-15c-.5 0-.9.2-1.1.6zm16.8 2.3-6.9 4.9c-.9.6-2.2.6-3.1 0L4 9v8.5c0 .6.5 1.1 1.1 1.1h13.8c.6 0 1.1-.5 1.1-1.1V9z"/></svg>
                    </span>
                    <div class="contactText">
                      <span class="label" id="lblEmail">Mail</span>
                      <span class="value" id="pEmail">michael-rau@liquiditybooster.de</span>
                    </div>
                  </div>

                  <div class="contactRow">
                    <span class="ico" aria-hidden="true">
                      <svg viewBox="0 0 24 24"><path d="M12 2.2c5.4 0 9.8 4.4 9.8 9.8S17.4 21.8 12 21.8 2.2 17.4 2.2 12 6.6 2.2 12 2.2zm7.3 7.1h-3c-.4-1.6-1.2-3.2-2.3-4.6 2.2.7 4 2.3 5.3 4.6zM12 4.1c1.3 1.4 2.2 3.2 2.7 5.2H9.3c.5-2 1.4-3.8 2.7-5.2zM4.7 9.3c1.3-2.3 3.1-3.9 5.3-4.6-1.1 1.4-1.9 3-2.3 4.6h-3zM4 12c0-.6.1-1.1.2-1.7h3.2c-.1.6-.2 1.1-.2 1.7s.1 1.2.2 1.7H4.2C4.1 13.1 4 12.6 4 12zm.7 4.7h3c.4 1.6 1.2 3.2 2.3 4.6-2.2-.7-4-2.3-5.3-4.6zM12 19.9c-1.3-1.4-2.2-3.2-2.7-5.2h5.4c-.5 2-1.4 3.8-2.7 5.2zm4-1.6c1.1-1.4 1.9-3 2.3-4.6h3c-1.3 2.3-3.1 3.9-5.3 4.6zM19.8 13.7h-3.2c.1-.6.2-1.1.2-1.7s-.1-1.2-.2-1.7h3.2c.1.6.2 1.1.2 1.7s-.1 1.1-.2 1.7z"/></svg>
                    </span>
                    <div class="contactText">
                      <span class="label" id="lblWeb">Web</span>
                      <span class="value" id="pWeb">michael-rau.liquiditybooster.de</span>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>

          <p class="miniNote" data-i18n="note">Druckformat: 85×55 mm. A4-Bogen: 8 Karten (2×4).</p>
        </div>
      </section>
    </div>
  </div>

  <!-- PRINT ONLY -->
  <div id="printArea">
    <div class="sheet">
      <div class="sheetGrid" id="sheetGrid"></div>
    </div>
  </div>

  <script>
    (function(){
      const LS_KEY = "fsa_club_visitenkarte_v2";
      let lang = "de";

      const i18n = {
        de:{
          title:"FSA-Club – Visitenkarten Tool",
          subtitle:"Eingabe → Vorschau → A4 Druckbogen (8 Karten)",
          panel_input:"Eingabe",
          panel_preview:"Vorschau",
          firstName:"Vorname",
          lastName:"Nachname",
          street:"Straße + Hausnummer",
          zip:"PLZ",
          city:"Ort",
          phone:"Telefon / Mobil",
          email:"E-Mail",
          web:"Webseite",
          role:"Tätigkeit",
          cuts:"Schnittmarken (optional)",
          cuts_off:"Aus",
          cuts_on:"An",
          btn_print:"Drucken / PDF",
          btn_save:"Daten merken",
          btn_reset:"Zurücksetzen",
          btn_copy:"Daten kopieren",
          hint:"Hinweis: Für PDF einfach „Drucken“ → „Als PDF speichern“. Wichtig: Skalierung 100% und Kopf-/Fußzeilen aus.",
          note:"Druckformat: 85×55 mm. A4-Bogen: 8 Karten (2×4).",
          labels:{tel:"Tel", mail:"Mail", web:"Web"},
          roles:["Promotor","Mentor","Sprecher","Eventmanagement"]
        },
        en:{
          title:"FSA Club – Business Card Tool",
          subtitle:"Input → Live preview → A4 print sheet (8 cards)",
          panel_input:"Input",
          panel_preview:"Preview",
          firstName:"First name",
          lastName:"Last name",
          street:"Street + number",
          zip:"ZIP",
          city:"City",
          phone:"Phone / Mobile",
          email:"Email",
          web:"Website",
          role:"Role",
          cuts:"Cut marks (optional)",
          cuts_off:"Off",
          cuts_on:"On",
          btn_print:"Print / PDF",
          btn_save:"Save data",
          btn_reset:"Reset",
          btn_copy:"Copy data",
          hint:"Tip: To create a PDF, click “Print” → “Save as PDF”. Use 100% scale and disable headers/footers.",
          note:"Print size: 85×55 mm. A4 sheet: 8 cards (2×4).",
          labels:{tel:"Tel", mail:"Mail", web:"Web"},
          roles:["Promoter","Mentor","Speaker","Event management"]
        }
      };

      const el = (id)=>document.getElementById(id);

      const firstName = el("firstName");
      const lastName  = el("lastName");
      const street    = el("street");
      const zip       = el("zip");
      const city      = el("city");
      const phone     = el("phone");
      const email     = el("email");
      const web       = el("web");
      const role      = el("role");
      const showCuts  = el("showCuts");

      const pRole  = el("pRole");
      const pName  = el("pName");
      const pAddr  = el("pAddr");
      const pPhone = el("pPhone");
      const pEmail = el("pEmail");
      const pWeb   = el("pWeb");

      const lblPhone = el("lblPhone");
      const lblEmail = el("lblEmail");
      const lblWeb   = el("lblWeb");

      const cardPreview = el("cardPreview");
      const sheetGrid = el("sheetGrid");

      function sanitize(s){ return (s||"").toString().trim(); }

      function escapeHTML(str){
        return (str||"").replace(/[&<>"']/g, (m)=>({
          "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
        }[m]));
      }

      function normalizeWeb(raw){
        let s = sanitize(raw);
        if(!s) return "";
        s = s.replace(/^https?:\/\//i, "");
        s = s.replace(/^www\./i, "");
        s = s.replace(/\/+$/,"");
        return s;
      }

      function buildRoleOptions(){
        role.innerHTML = "";
        i18n[lang].roles.forEach((r, idx)=>{
          const opt = document.createElement("option");
          opt.value = String(idx);
          opt.textContent = r;
          role.appendChild(opt);
        });
      }

      function applyI18n(){
        document.documentElement.lang = lang;

        document.querySelectorAll("[data-i18n]").forEach(node=>{
          const key = node.getAttribute("data-i18n");
          if(i18n[lang][key]) node.textContent = i18n[lang][key];
        });

        // Cut option labels
        document.querySelectorAll("#showCuts option").forEach(opt=>{
          const key = opt.getAttribute("data-i18n");
          if(key && i18n[lang][key]) opt.textContent = i18n[lang][key];
        });

        lblPhone.textContent = i18n[lang].labels.tel;
        lblEmail.textContent = i18n[lang].labels.mail;
        lblWeb.textContent   = i18n[lang].labels.web;

        const prev = role.value || "0";
        buildRoleOptions();
        role.value = prev;

        updatePreview();
      }

      function getData(){
        const fn = sanitize(firstName.value) || "Max";
        const ln = sanitize(lastName.value)  || "Mustermann";
        const st = sanitize(street.value)    || "Musterweg 16";
        const z  = sanitize(zip.value)       || "12345";
        const ct = sanitize(city.value)      || "Musterhausen";
        const ph = sanitize(phone.value)     || "01234 / 567890";
        const em = sanitize(email.value)     || "max@mustermann.com";
        const wb = normalizeWeb(web.value)   || "max.mustermann.de";

        const roleIdx = Math.max(0, parseInt(role.value||"0",10));
        const r = i18n[lang].roles[roleIdx] || i18n[lang].roles[0];

        const cuts = (showCuts.value === "1") ? 1 : 0;

        return {fn, ln, st, z, ct, ph, em, wb, r, roleIdx, cuts};
      }

      function applyAutoFit(d, root){
        // Name size
        const nameLen = (d.fn + " " + d.ln).trim().length;
        let nameSize = 6.3; // mm
        if(nameLen > 18) nameSize = 5.8;
        if(nameLen > 24) nameSize = 5.2;
        if(nameLen > 30) nameSize = 4.8;

        // Address size
        const addrLen = (d.st + " " + d.z + " " + d.ct).length;
        let addrSize = 3.25;
        if(addrLen > 42) addrSize = 3.05;
        if(addrLen > 56) addrSize = 2.85;

        // Contact size
        const maxContactLen = Math.max(d.ph.length, d.em.length, d.wb.length);
        let contactSize = 3.0;
        if(maxContactLen > 26) contactSize = 2.8;
        if(maxContactLen > 34) contactSize = 2.6;

        root.style.setProperty("--nameSize", nameSize + "mm");
        root.style.setProperty("--addrSize", addrSize + "mm");
        root.style.setProperty("--contactSize", contactSize + "mm");

        // Wrap email/web if needed
        const emailEl = root.querySelector(".vEmail");
        const webEl   = root.querySelector(".vWeb");
        if(emailEl){
          emailEl.classList.toggle("wrap", d.em.length > 28);
        }
        if(webEl){
          webEl.classList.toggle("wrap", d.wb.length > 28);
        }
      }

      function updatePreview(){
        const d = getData();
        pRole.textContent = d.r;
        pName.textContent = (d.fn + " " + d.ln).trim();

        // Address two lines
        pAddr.innerHTML = `${escapeHTML(d.st)}<br>${escapeHTML(d.z)} ${escapeHTML(d.ct)}`;

        pPhone.textContent = d.ph;
        pEmail.textContent = d.em;
        pWeb.textContent   = d.wb;

        // allow wrap in preview if long
        pEmail.classList.toggle("wrap", d.em.length > 28);
        pWeb.classList.toggle("wrap", d.wb.length > 28);

        applyAutoFit(d, cardPreview);

        renderSheet();
      }

      function createCardNode(d){
        const card = document.createElement("div");
        card.className = "card print";
        card.innerHTML = `
          <div class="cardInner">
            <div class="cardTop">
              <div class="club">FSA-CLUB</div>
              <div class="role">${escapeHTML(d.r)}</div>
            </div>

            <div class="name">${escapeHTML((d.fn + " " + d.ln).trim())}</div>

            <div class="addr">${escapeHTML(d.st)}<br>${escapeHTML(d.z)} ${escapeHTML(d.ct)}</div>

            <div class="contact">
              <div class="contactRow">
                <span class="ico" aria-hidden="true">
                  <svg viewBox="0 0 24 24"><path d="M6.6 10.8c1.6 3 4.1 5.5 7.1 7.1l2.4-2.4c.3-.3.8-.4 1.2-.2 1.3.4 2.7.7 4.1.7.7 0 1.2.5 1.2 1.2V21c0 .7-.5 1.2-1.2 1.2C10.6 22.2 1.8 13.4 1.8 2.4 1.8 1.7 2.3 1.2 3 1.2h3.6c.7 0 1.2.5 1.2 1.2 0 1.4.2 2.8.7 4.1.1.4 0 .9-.2 1.2l-2.7 2.1z"/></svg>
                </span>
                <div class="contactText">
                  <span class="label">${escapeHTML(i18n[lang].labels.tel)}</span>
                  <span class="value">${escapeHTML(d.ph)}</span>
                </div>
              </div>

              <div class="contactRow">
                <span class="ico" aria-hidden="true">
                  <svg viewBox="0 0 24 24"><path d="M2 6.5C2 5.1 3.1 4 4.5 4h15C20.9 4 22 5.1 22 6.5v11C22 18.9 20.9 20 19.5 20h-15C3.1 20 2 18.9 2 17.5v-11zm2.2.2 7.2 5.1c.4.3 1 .3 1.4 0l7.2-5.1c-.2-.4-.6-.6-1.1-.6h-15c-.5 0-.9.2-1.1.6zm16.8 2.3-6.9 4.9c-.9.6-2.2.6-3.1 0L4 9v8.5c0 .6.5 1.1 1.1 1.1h13.8c.6 0 1.1-.5 1.1-1.1V9z"/></svg>
                </span>
                <div class="contactText">
                  <span class="label">${escapeHTML(i18n[lang].labels.mail)}</span>
                  <span class="value vEmail ${d.em.length>28?'wrap':''}">${escapeHTML(d.em)}</span>
                </div>
              </div>

              <div class="contactRow">
                <span class="ico" aria-hidden="true">
                  <svg viewBox="0 0 24 24"><path d="M12 2.2c5.4 0 9.8 4.4 9.8 9.8S17.4 21.8 12 21.8 2.2 17.4 2.2 12 6.6 2.2 12 2.2zm7.3 7.1h-3c-.4-1.6-1.2-3.2-2.3-4.6 2.2.7 4 2.3 5.3 4.6zM12 4.1c1.3 1.4 2.2 3.2 2.7 5.2H9.3c.5-2 1.4-3.8 2.7-5.2zM4.7 9.3c1.3-2.3 3.1-3.9 5.3-4.6-1.1 1.4-1.9 3-2.3 4.6h-3zM4 12c0-.6.1-1.1.2-1.7h3.2c-.1.6-.2 1.1-.2 1.7s.1 1.2.2 1.7H4.2C4.1 13.1 4 12.6 4 12zm.7 4.7h3c.4 1.6 1.2 3.2 2.3 4.6-2.2-.7-4-2.3-5.3-4.6zM12 19.9c-1.3-1.4-2.2-3.2-2.7-5.2h5.4c-.5 2-1.4 3.8-2.7 5.2zm4-1.6c1.1-1.4 1.9-3 2.3-4.6h3c-1.3 2.3-3.1 3.9-5.3 4.6zM19.8 13.7h-3.2c.1-.6.2-1.1.2-1.7s-.1-1.2-.2-1.7h3.2c.1.6.2 1.1.2 1.7s-.1 1.1-.2 1.7z"/></svg>
                </span>
                <div class="contactText">
                  <span class="label">${escapeHTML(i18n[lang].labels.web)}</span>
                  <span class="value vWeb ${d.wb.length>28?'wrap':''}">${escapeHTML(d.wb)}</span>
                </div>
              </div>
            </div>
          </div>
        `;
        applyAutoFit(d, card);
        return card;
      }

      function renderSheet(){
        const d = getData();
        sheetGrid.innerHTML = "";
        for(let i=0;i<8;i++){
          const wrap = document.createElement("div");
          wrap.className = "cutWrap";
          wrap.setAttribute("data-cuts", String(d.cuts));
          const tl = document.createElement("div"); tl.className="cut tl";
          const tr = document.createElement("div"); tr.className="cut tr";
          const bl = document.createElement("div"); bl.className="cut bl";
          const br = document.createElement("div"); br.className="cut br";
          wrap.appendChild(tl); wrap.appendChild(tr); wrap.appendChild(bl); wrap.appendChild(br);
          wrap.appendChild(createCardNode(d));
          sheetGrid.appendChild(wrap);
        }
      }

      function saveData(){
        const d = getData();
        localStorage.setItem(LS_KEY, JSON.stringify({lang, ...d, rawWeb: sanitize(web.value)}));
      }

      function loadData(){
        try{
          const raw = localStorage.getItem(LS_KEY);
          if(!raw) return false;
          const d = JSON.parse(raw);
          lang = (d.lang==="en") ? "en" : "de";
          applyI18n();

          firstName.value = d.fn || "";
          lastName.value  = d.ln || "";
          street.value    = d.st || "";
          zip.value       = d.z  || "";
          city.value      = d.ct || "";
          phone.value     = d.ph || "";
          email.value     = d.em || "";
          web.value       = d.rawWeb || d.wb || "";
          role.value      = (typeof d.roleIdx === "number") ? String(d.roleIdx) : "0";
          showCuts.value  = (d.cuts===1) ? "1" : "0";

          updatePreview();
          return true;
        }catch(e){
          return false;
        }
      }

      function resetData(){
        firstName.value = "Max";
        lastName.value  = "Mustermann";
        street.value    = "Musterweg 16";
        zip.value       = "12345";
        city.value      = "Musterhausen";
        phone.value     = "01234 / 567890";
        email.value     = "max@mustermann.com";
        web.value       = "https://max.mustermann.de/";
        role.value      = "2"; // Sprecher / Speaker
        showCuts.value  = "0";
        updatePreview();
      }

      function copyData(){
        const d = getData();
        const text =
`FSA-CLUB
${d.fn} ${d.ln}
${d.st}
${d.z} ${d.ct}
${i18n[lang].labels.tel}: ${d.ph}
${i18n[lang].labels.mail}: ${d.em}
${i18n[lang].labels.web}: ${d.wb}
${d.r}`;
        navigator.clipboard.writeText(text).catch(()=>{});
      }

      // Events
      [firstName,lastName,street,zip,city,phone,email,web,role,showCuts].forEach(inp=>{
        inp.addEventListener("input", updatePreview);
        inp.addEventListener("change", updatePreview);
      });

      el("btnPrint").addEventListener("click", ()=>{ updatePreview(); window.print(); });
      el("btnSave").addEventListener("click", ()=>{ saveData(); });
      el("btnReset").addEventListener("click", ()=>{ localStorage.removeItem(LS_KEY); resetData(); });
      el("btnCopy").addEventListener("click", ()=>{ copyData(); });

      el("btnDE").addEventListener("click", ()=>{ lang="de"; applyI18n(); updatePreview(); });
      el("btnEN").addEventListener("click", ()=>{ lang="en"; applyI18n(); updatePreview(); });

      // Init
      buildRoleOptions();
      role.value = "2";
      const loaded = loadData();
      if(!loaded) resetData();
      applyI18n();
    })();
  </script>
</body>
</html>
