<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Einkaufsmeile – Prozess (Story)</title>
  <meta name="description" content="Einkaufsmeile als animierte Story: klickbare Text-Bausteine, Pfeile, DE/EN, LocalStorage, Print. Keine externen Ressourcen." />
  <meta name="robots" content="noindex,nofollow" />

  <style>
    :root{
      --bg:#ffffff;
      --txt:#0b0b0b;
      --muted:#4a4a4a;
      --line:#d8d8d8;
      --soft:#f6f6f6;
      --soft2:#fbfbfb;

      --radius:16px;
      --shadow:0 16px 34px rgba(0,0,0,.10);
      --shadow2:0 10px 24px rgba(0,0,0,.08);

      --mono: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      --sans: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
    }

    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--txt);
      font-family:var(--sans);
      overflow-x:hidden;

      overflow-wrap:anywhere;
      word-break:break-word;
      hyphens:auto;
    }

    .wrap{
      max-width:1200px;
      margin:0 auto;
      padding:18px 14px 70px;
    }

    /* Topbar */
    .topbar{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      padding-bottom:12px;
      border-bottom:1px solid var(--line);
      margin-bottom:12px;
    }
    .brand{ display:flex; flex-direction:column; gap:6px; max-width:860px; }
    h1{ margin:0; font-size:22px; line-height:1.15; letter-spacing:.2px; }
    .sub{ margin:0; color:var(--muted); font-size:13.5px; line-height:1.6; }

    .topRight{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end; }
    .pillRow{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .pill{
      appearance:none;
      border:1px solid var(--line);
      background:#fff;
      color:var(--txt);
      padding:8px 10px;
      border-radius:999px;
      font-weight:950;
      font-size:13px;
      cursor:pointer;
      user-select:none;
      box-shadow:0 2px 0 rgba(0,0,0,.03);
    }
    .pill[aria-pressed="true"]{
      border-color:#0b0b0b;
      box-shadow:0 0 0 2px rgba(0,0,0,.07) inset, 0 2px 0 rgba(0,0,0,.03);
    }

    .btn{
      appearance:none;
      border:1px solid #0b0b0b;
      background:#0b0b0b;
      color:#fff;
      padding:10px 12px;
      border-radius:14px;
      font-weight:950;
      font-size:13px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      user-select:none;
      box-shadow:0 10px 22px rgba(0,0,0,.10);
    }
    .btn.secondary{
      background:#fff;
      color:#0b0b0b;
      border:1px solid var(--line);
      box-shadow:0 8px 18px rgba(0,0,0,.06);
    }
    .btn:active{ transform: translateY(1px); }
    .btn svg{ width:16px; height:16px; }

    .layout{
      display:grid;
      grid-template-columns: 420px 1fr;
      gap:12px;
      align-items:start;
    }
    @media (max-width: 1020px){
      .layout{ grid-template-columns:1fr; }
    }

    .card{
      border:1px solid var(--line);
      background:var(--soft2);
      border-radius:var(--radius);
      box-shadow:var(--shadow2);
      padding:14px;
    }

    .card h2{ margin:0 0 8px 0; font-size:15px; letter-spacing:.2px; }
    .hint{ margin:0 0 10px 0; color:var(--muted); font-size:13px; line-height:1.55; }

    /* Controls */
    .rows{ display:grid; gap:10px; }
    .row{
      display:grid;
      grid-template-columns: 1.2fr 1fr auto;
      gap:10px;
      align-items:center;
      padding:10px;
      border-radius:14px;
      background:#fff;
      border:1px solid var(--line);
    }
    @media (max-width: 560px){
      .row{ grid-template-columns:1fr; }
      .row .resetCell{ justify-content:flex-start; }
    }
    .lab{ font-weight:1000; font-size:13px; }
    .subLab{ margin-top:3px; color:var(--muted); font-size:12px; line-height:1.35; }

    input[type="number"], select, input[type="text"]{
      width:100%;
      box-sizing:border-box;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#fff;
      color:#0b0b0b;
      font-size:14px;
      outline:none;
      font-family:var(--sans);
    }
    input[type="number"]:focus, select:focus, input[type="text"]:focus{
      border-color:#0b0b0b;
      box-shadow:0 0 0 3px rgba(0,0,0,.08);
    }

    .resetCell{
      display:flex;
      justify-content:flex-end;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
    }
    .resetOne{
      appearance:none;
      border:1px solid var(--line);
      background:var(--soft);
      color:#0b0b0b;
      padding:8px 10px;
      border-radius:12px;
      font-weight:1000;
      font-size:12px;
      cursor:pointer;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }

    /* Story Stage */
    .stage{
      border:1px solid var(--line);
      background:#fff;
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    .stageTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      padding:12px 12px 10px;
      border-bottom:1px solid var(--line);
      background:var(--soft2);
    }
    .stageTitle{
      display:flex;
      flex-direction:column;
      gap:4px;
      max-width:760px;
    }
    .stageTitle strong{ font-size:14px; letter-spacing:.2px; }
    .stageTitle span{ color:var(--muted); font-size:12.5px; line-height:1.5; }

    .stageTools{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .miniBtn{
      appearance:none;
      border:1px solid var(--line);
      background:#fff;
      color:#0b0b0b;
      padding:8px 10px;
      border-radius:12px;
      font-weight:950;
      font-size:12px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow:0 6px 14px rgba(0,0,0,.05);
      user-select:none;
    }
    .miniBtn svg{ width:14px; height:14px; }

    .storyArea{
      padding:14px;
      background:#fff;
    }

    /* Flow */
    .flow{
      display:flex;
      flex-direction:column;
      gap:12px;
      padding:6px;
    }

    .stepWrap{
      display:flex;
      flex-direction:column;
      gap:10px;
      align-items:flex-start;
    }

    .stepCard{
      width:100%;
      border:1px solid var(--line);
      border-radius:16px;
      background:var(--soft2);
      box-shadow:var(--shadow2);
      padding:14px;
      position:relative;
      overflow:hidden;

      opacity:0;
      transform: translateY(10px) scale(.99);
      pointer-events:none;
      transition: opacity .28s ease, transform .28s ease, box-shadow .28s ease;
    }

    .stepCard.visible{
      opacity:1;
      transform: translateY(0) scale(1);
      pointer-events:auto;
    }

    .stepCard.active{
      border-color:#0b0b0b;
      box-shadow:0 0 0 2px rgba(0,0,0,.08) inset, var(--shadow2);
      background:#fff;
    }

    .stepTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }

    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      font-family:var(--mono);
      font-weight:1000;
      font-size:12px;
      white-space:nowrap;
    }

    .stepTitle{
      margin:0;
      font-size:16px;
      font-weight:1100;
      letter-spacing:.2px;
      line-height:1.25;
    }

    .stepBody{
      margin:8px 0 0 0;
      color:var(--muted);
      font-size:13.5px;
      line-height:1.6;
      max-width:95ch;
    }

    .stepActions{
      margin-top:10px;
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }

    .chip{
      appearance:none;
      border:1px solid var(--line);
      background:#fff;
      color:#0b0b0b;
      padding:8px 10px;
      border-radius:12px;
      font-weight:1000;
      font-size:12px;
      cursor:pointer;
      user-select:none;
    }
    .chip.primary{
      border-color:#0b0b0b;
      background:#0b0b0b;
      color:#fff;
    }

    /* Arrow */
    .arrowWrap{
      width:100%;
      display:flex;
      justify-content:flex-start;
      align-items:center;
      gap:10px;
      padding-left:10px;
    }
    .arrow{
      display:inline-flex;
      align-items:center;
      gap:10px;
      color:#0b0b0b;
      font-weight:1000;
      font-size:13px;
      opacity:0;
      transform: translateX(-10px);
      transition: opacity .26s ease, transform .26s ease;
    }
    .arrow.visible{
      opacity:1;
      transform: translateX(0);
    }
    .arrow svg{
      width:38px;
      height:18px;
    }

    /* Info/Reader blocks */
    details.acc{
      margin-top:12px;
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
      overflow:hidden;
    }
    details.acc summary{
      list-style:none;
      cursor:pointer;
      padding:12px;
      font-weight:1100;
      font-size:13px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      user-select:none;
    }
    details.acc summary::-webkit-details-marker{ display:none; }
    .chev{ width:18px; height:18px; transition: transform .18s ease; }
    details.acc[open] .chev{ transform: rotate(180deg); }
    .accBody{
      border-top:1px solid var(--line);
      padding:0 12px 12px;
      font-size:13.5px;
      line-height:1.6;
      color:#0b0b0b;
    }
    .accBody p{ margin:10px 0 0 0; }

    textarea{
      width:100%;
      box-sizing:border-box;
      min-height:120px;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      font-size:14px;
      font-family:var(--sans);
      outline:none;
      resize:vertical;

      overflow-wrap:anywhere;
      word-break:break-word;
      hyphens:auto;
    }
    textarea:focus{
      border-color:#0b0b0b;
      box-shadow:0 0 0 3px rgba(0,0,0,.08);
    }

    .noteRow{
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:10px;
    }
    #saveHint{ color:var(--muted); font-size:13px; }
    .mono{ font-family:var(--mono); }

    .kpiRow{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      padding:12px;
      border-top:1px solid var(--line);
      background:var(--soft2);
    }
    @media (max-width: 900px){ .kpiRow{ grid-template-columns: 1fr; } }
    .kpi{
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
    }
    .kpi .t{
      margin:0 0 6px 0;
      font-size:12px;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.06em;
      font-weight:1000;
    }
    .kpi .v{
      margin:0;
      font-size:16px;
      font-weight:1100;
      letter-spacing:.2px;
      font-family:var(--mono);
    }
    .kpi .d{
      margin:6px 0 0 0;
      font-size:12px;
      color:var(--muted);
      line-height:1.45;
    }

    .noPrint{}
    @page{ margin: 12mm; }
    @media print{
      *{ -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .noPrint{ display:none !important; }
      body{ background:#fff !important; color:#000 !important; }
      .card,.stage,.stepCard,details.acc,.kpi{
        box-shadow:none !important;
        border-color:#000 !important;
      }
      .stepCard{ break-inside: avoid; page-break-inside: avoid; }
      .arrowWrap{ break-inside: avoid; page-break-inside: avoid; }
      details.acc{ break-inside: avoid; page-break-inside: avoid; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <h1 data-i18n="h1">Einkaufsmeile – Prozess (Story)</h1>
        <p class="sub" data-i18n="sub">
          Klickbare Bausteine + Pfeile wie in einer PowerPoint: Start → nächster Schritt erscheint → Prozess wird sichtbar.
        </p>
      </div>

      <div class="topRight noPrint">
        <div class="pillRow" aria-label="Sprache">
          <button class="pill" id="langDE" type="button" aria-pressed="true">DE</button>
          <button class="pill" id="langEN" type="button" aria-pressed="false">EN</button>
        </div>

        <button class="btn secondary" id="btnPrint" type="button">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M7 8V3h10v5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M7 17h10v4H7v-4Z" stroke="currentColor" stroke-width="2"/>
            <path d="M6 18H5a3 3 0 0 1-3-3v-4a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v4a3 3 0 0 1-3 3h-1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M18 12h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
          </svg>
          <span data-i18n="print">Drucken</span>
        </button>

        <button class="btn" id="btnResetAll" type="button">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M3 12a9 9 0 0 1 15.36-6.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M18 4v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M21 12a9 9 0 0 1-15.36 6.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span data-i18n="resetAll">Alles zurücksetzen</span>
        </button>
      </div>
    </div>

    <div class="layout">
      <!-- LEFT -->
      <section class="card">
        <h2 data-i18n="controls">Steuerung</h2>
        <p class="hint" data-i18n="controlsHint">
          Du klickst dich durch den Ablauf (Weiter / Zurück) oder spielst automatisch ab. Jeder Schritt ist ein Text-Baustein.
        </p>

        <div class="rows">
          <div class="row">
            <div>
              <div class="lab" data-i18n="actor">Bezeichnung</div>
              <div class="subLab" data-i18n="actorSub">Wie du die Person nennst</div>
            </div>
            <div>
              <input id="actor" type="text" value="Mitglied" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="actor" type="button">↺ <span data-i18n="reset">reset</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="speed">Auto-Geschwindigkeit</div>
              <div class="subLab" data-i18n="speedSub">Wenn Auto läuft: Schritt alle X ms</div>
            </div>
            <div>
              <select id="autoSpeed" data-store>
                <option value="1000" data-i18n="speed1">langsam</option>
                <option value="650" selected data-i18n="speed2">normal</option>
                <option value="380" data-i18n="speed3">schnell</option>
              </select>
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="autoSpeed" type="button">↺ <span data-i18n="reset">reset</span></button>
            </div>
          </div>
        </div>

        <div class="rows" style="margin-top:10px;">
          <div class="row">
            <div>
              <div class="lab" data-i18n="nav">Navigation</div>
              <div class="subLab" data-i18n="navSub">Wie in PowerPoint: Schritt für Schritt</div>
            </div>
            <div class="noPrint" style="display:flex;gap:8px;flex-wrap:wrap;">
              <button class="miniBtn" id="btnPrev" type="button">
                <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span data-i18n="prev">Zurück</span>
              </button>
              <button class="miniBtn" id="btnNext" type="button">
                <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span data-i18n="next">Weiter</span>
              </button>
            </div>
            <div class="resetCell noPrint" style="justify-content:flex-start;">
              <button class="miniBtn" id="btnAuto" type="button" aria-pressed="false">
                <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path d="M8 5l12 7-12 7V5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                </svg>
                <span data-i18n="auto">Auto</span>
              </button>
            </div>
          </div>
        </div>

        <details class="acc" open>
          <summary>
            <span data-i18n="longTitle">Leserversion (Prozess-Text)</span>
            <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="accBody">
            <p data-i18n="longText">
              Ein Mitglied kauft seine Mitgliedschaft. Danach besucht es ein Weekend-Setup, um Fundament, Struktur und Absicherung sauber aufzubauen.
              Nach dem Setup entscheidet es sich für Werkzeuge: zuerst eine Leadmaschine, später vielleicht ein Upgrade. Mit der Zeit entstehen neue Interessen:
              Tradingkurs, NFT Kurs – je nachdem, was passt. Im Hörsaal entdeckt das Mitglied weitere Projekte und lernt, wie man Dinge prüft, versteht und einordnet.
              Daraus entstehen wiederholbare Schritte: spezielle Weekend-Setups für Projekte, Webinare, Gespräche. So entsteht eine Einkaufsmeile über Zeit.
              Das System übernimmt Erklärung und Struktur – dadurch bleibt Lebenszeit. Empfehlungen passieren nebenbei, weil der Weg sichtbar und nachvollziehbar ist.
            </p>
          </div>
        </details>

        <details class="acc">
          <summary>
            <span data-i18n="notesTitle">Notizen</span>
            <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="accBody">
            <textarea id="notes" data-store placeholder="Deine Notizen …"></textarea>
            <div class="noteRow">
              <div id="saveHint">Bereit.</div>
              <div class="mono" id="statusLine">—</div>
            </div>
          </div>
        </details>

      </section>

      <!-- RIGHT -->
      <section class="stage">
        <div class="stageTop">
          <div class="stageTitle">
            <strong data-i18n="stageTitle">Einkaufsmeile (Ablauf)</strong>
            <span data-i18n="stageSub">Jeder Baustein ist klickbar. Pfeile erscheinen wie in einer PowerPoint.</span>
          </div>

          <div class="stageTools noPrint">
            <button class="miniBtn" id="btnJumpStart" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M6 6h2v12H6V6Z" stroke="currentColor" stroke-width="2"/>
                <path d="M10 5l10 7-10 7V5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
              </svg>
              <span data-i18n="jumpStart">Start</span>
            </button>
            <button class="miniBtn" id="btnShowAll" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M4 7h16M4 12h16M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span data-i18n="showAll">Alles anzeigen</span>
            </button>
          </div>
        </div>

        <div class="storyArea">
          <div class="flow" id="flow"></div>

          <details class="acc" open style="margin-top:12px;">
            <summary>
              <span data-i18n="whyTitle">Warum das wowt</span>
              <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </summary>
            <div class="accBody">
              <p data-i18n="whyText">
                Weil man plötzlich sieht, wie Wiederholung wirkt: ein Schritt löst den nächsten aus. Wissen, Werkzeuge und Live-Impulse greifen ineinander.
                Das ist kein Zufall – das ist ein Prozess.
              </p>
            </div>
          </details>
        </div>

        <div class="kpiRow">
          <div class="kpi">
            <p class="t" data-i18n="kpi1">Sichtbare Schritte</p>
            <p class="v" id="k_visible">1</p>
            <p class="d" data-i18n="kpi1d">wie viele Bausteine gerade sichtbar sind</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kpi2">Aktiver Schritt</p>
            <p class="v" id="k_active">01</p>
            <p class="d" data-i18n="kpi2d">auf diesen Schritt ist der Fokus</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kpi3">Status</p>
            <p class="v" id="k_status">—</p>
            <p class="d" data-i18n="kpi3d">kurzer Hinweis</p>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script>
    (function(){
      const PREFIX = "fsa_tool_einkaufsmeile_story_";
      const KEY_STATE = PREFIX + "state";
      const KEY_LANG  = PREFIX + "lang";

      const $ = (id)=> document.getElementById(id);
      const clamp = (n,min,max)=> Math.min(max, Math.max(min, n));
      const toNum = (v)=> {
        const n = Number(String(v).replace(",", "."));
        return Number.isFinite(n) ? n : 0;
      };

      const I18N = {
        de:{
          h1:"Einkaufsmeile – Prozess (Story)",
          sub:"Klickbare Bausteine + Pfeile wie in einer PowerPoint: Start → nächster Schritt erscheint → Prozess wird sichtbar.",
          print:"Drucken", resetAll:"Alles zurücksetzen",

          controls:"Steuerung",
          controlsHint:"Du klickst dich durch den Ablauf (Weiter / Zurück) oder spielst automatisch ab. Jeder Schritt ist ein Text-Baustein.",

          actor:"Bezeichnung",
          actorSub:"Wie du die Person nennst",
          speed:"Auto-Geschwindigkeit",
          speedSub:"Wenn Auto läuft: Schritt alle X ms",
          speed1:"langsam", speed2:"normal", speed3:"schnell",
          reset:"reset",

          nav:"Navigation",
          navSub:"Wie in PowerPoint: Schritt für Schritt",
          prev:"Zurück",
          next:"Weiter",
          auto:"Auto",

          longTitle:"Leserversion (Prozess-Text)",
          longText:"Ein Mitglied kauft seine Mitgliedschaft. Danach besucht es ein Weekend-Setup, um Fundament, Struktur und Absicherung sauber aufzubauen. Nach dem Setup entscheidet es sich für Werkzeuge: zuerst eine Leadmaschine, später vielleicht ein Upgrade. Mit der Zeit entstehen neue Interessen: Tradingkurs, NFT Kurs – je nachdem, was passt. Im Hörsaal entdeckt das Mitglied weitere Projekte und lernt, wie man Dinge prüft, versteht und einordnet. Daraus entstehen wiederholbare Schritte: spezielle Weekend-Setups für Projekte, Webinare, Gespräche. So entsteht eine Einkaufsmeile über Zeit. Das System übernimmt Erklärung und Struktur – dadurch bleibt Lebenszeit. Empfehlungen passieren nebenbei, weil der Weg sichtbar und nachvollziehbar ist.",

          notesTitle:"Notizen",

          stageTitle:"Einkaufsmeile (Ablauf)",
          stageSub:"Jeder Baustein ist klickbar. Pfeile erscheinen wie in einer PowerPoint.",
          jumpStart:"Start",
          showAll:"Alles anzeigen",

          whyTitle:"Warum das wowt",
          whyText:"Weil man plötzlich sieht, wie Wiederholung wirkt: ein Schritt löst den nächsten aus. Wissen, Werkzeuge und Live-Impulse greifen ineinander. Das ist kein Zufall – das ist ein Prozess.",

          kpi1:"Sichtbare Schritte",
          kpi1d:"wie viele Bausteine gerade sichtbar sind",
          kpi2:"Aktiver Schritt",
          kpi2d:"auf diesen Schritt ist der Fokus",
          kpi3:"Status",
          kpi3d:"kurzer Hinweis",

          // Steps
          s1t:"Mitgliedschaft (Start)",
          s1b:"Der Einstieg. Ab hier ist der Weg offen – ohne Druck, aber mit Struktur.",
          s2t:"Weekend-Setup (Fundament)",
          s2b:"Fundament + Absicherung: Verständnis, Klarheit, Struktur.",
          s3t:"Hörsaal erscheint (Entdecken)",
          s3b:"Jetzt öffnet sich die Messehalle: Projekte prüfen, vergleichen, einordnen.",
          s4t:"Leadmaschine (groß / Profi)",
          s4b:"Skalierung: aus dem Weg wird ein System. Werkzeuge sparen Lebenszeit.",
          s5t:"Interessen entstehen: Tradingkurs",
          s5b:"Wissensbaustein nach Bedarf – wenn das Thema relevant wird.",
          s6t:"Später: NFT Kurs",
          s6b:"Weitere Spezialisierung. Nicht Pflicht – optionaler Baustein.",
          s7t:"Wiederholung: Projekt-Weekend-Setup",
          s7b:"Spezifischer Deep-Dive für ein neues Projekt aus dem Hörsaal.",
          s8t:"Webinare",
          s8b:"Zwischenimpulse: Termine, Updates, Live-Input.",
          s9t:"Gespräche / Einzelgespräche",
          s9b:"Echte Klarheit entsteht oft im Gespräch – je nach Bedarf.",
          s10t:"Upgrade + Add-on (wenn nötig)",
          s10b:"Wenn ein Add-on nicht geht: zuerst Upgrade – dann passt es sauber.",
          s11t:"Kreis schließt sich",
          s11b:"Über Zeit entsteht die Einkaufsmeile: sichtbar, wiederholbar, nachvollziehbar.",

          arrow:"dann →",
          statusReady:"Bereit.",
          statusAutoOn:"Auto läuft…",
          statusAutoOff:"Auto stoppt.",
          statusAll:"Alles sichtbar.",
          statusReset:"Zurückgesetzt."
        },
        en:{
          h1:"Shopping Mile – Process (Story)",
          sub:"Clickable blocks + arrows like PowerPoint: Start → next step appears → process becomes visible.",
          print:"Print", resetAll:"Reset all",

          controls:"Controls",
          controlsHint:"Click through the flow (Next / Prev) or autoplay. Every step is a text block.",

          actor:"Label",
          actorSub:"How you name the person",
          speed:"Auto speed",
          speedSub:"When auto runs: step every X ms",
          speed1:"slow", speed2:"normal", speed3:"fast",
          reset:"reset",

          nav:"Navigation",
          navSub:"Like PowerPoint: step by step",
          prev:"Prev",
          next:"Next",
          auto:"Auto",

          longTitle:"Reader version (process text)",
          longText:"A person buys a membership. Then they attend a weekend setup to build foundation, structure and safety. After the setup they choose tools: first a lead machine, later possibly an upgrade. Over time, new interests appear: trading course, NFT course — depending on needs. In the lecture hall they discover other projects and learn how to review and understand them. This creates repeatable steps: project weekend setups, webinars, conversations. That’s how a shopping mile forms over time. The system handles explanation and structure — saving time. Recommendations happen naturally because the path is visible and understandable.",

          notesTitle:"Notes",

          stageTitle:"Shopping mile (flow)",
          stageSub:"Each block is clickable. Arrows appear like in a PowerPoint.",
          jumpStart:"Start",
          showAll:"Show all",

          whyTitle:"Why it wows",
          whyText:"Because you suddenly see how repetition works: one step triggers the next. Knowledge, tools and live input connect. Not random — a process.",

          kpi1:"Visible steps",
          kpi1d:"how many blocks are currently visible",
          kpi2:"Active step",
          kpi2d:"focus is on this step",
          kpi3:"Status",
          kpi3d:"short hint",

          s1t:"Membership (start)",
          s1b:"The entry. From here the path is open — no pressure, but structure.",
          s2t:"Weekend setup (foundation)",
          s2b:"Foundation + safety: understanding, clarity, structure.",
          s3t:"Lecture hall appears (discover)",
          s3b:"Now the expo opens: review, compare, classify projects.",
          s4t:"Lead machine (Pro)",
          s4b:"Scaling: the path becomes a system. Tools save time.",
          s5t:"Interests appear: trading course",
          s5b:"Knowledge module as needed — when the topic becomes relevant.",
          s6t:"Later: NFT course",
          s6b:"Further specialization. Optional, not mandatory.",
          s7t:"Repetition: project weekend setup",
          s7b:"Focused deep dive for a new project discovered via the lecture hall.",
          s8t:"Webinars",
          s8b:"In-between impulses: sessions, updates, live input.",
          s9t:"Conversations / 1:1",
          s9b:"Clarity often comes from a real conversation — as needed.",
          s10t:"Upgrade + add-on (if needed)",
          s10b:"If an add-on doesn’t work: upgrade first — then it fits.",
          s11t:"The loop closes",
          s11b:"Over time the shopping mile forms: visible, repeatable, understandable.",

          arrow:"then →",
          statusReady:"Ready.",
          statusAutoOn:"Auto running…",
          statusAutoOff:"Auto stopped.",
          statusAll:"All visible.",
          statusReset:"Reset."
        }
      };

      const STEPS = [
        { key:"s1", t:"s1t", b:"s1b" },
        { key:"s2", t:"s2t", b:"s2b" },
        { key:"s3", t:"s3t", b:"s3b" },
        { key:"s4", t:"s4t", b:"s4b" },
        { key:"s5", t:"s5t", b:"s5b" },
        { key:"s6", t:"s6t", b:"s6b" },
        { key:"s7", t:"s7t", b:"s7b" },
        { key:"s8", t:"s8t", b:"s8b" },
        { key:"s9", t:"s9t", b:"s9b" },
        { key:"s10", t:"s10t", b:"s10b" },
        { key:"s11", t:"s11t", b:"s11b" }
      ];

      const state = {
        lang: "de",
        visibleCount: 1,  // membership always visible
        activeIndex: 0,
        autoOn: false,
        actor: "Mitglied",
        autoSpeed: "650",
        notes: ""
      };

      let autoTimer = null;

      function getLang(){
        try{ return localStorage.getItem(KEY_LANG) || "de"; }catch(e){ return "de"; }
      }
      function setLang(lang){
        state.lang = (lang === "en") ? "en" : "de";
        const d = I18N[state.lang];
        document.documentElement.lang = state.lang;

        document.querySelectorAll("[data-i18n]").forEach(el=>{
          const k = el.getAttribute("data-i18n");
          if(d[k] != null) el.textContent = d[k];
        });

        $("#langDE").setAttribute("aria-pressed", String(state.lang !== "en"));
        $("#langEN").setAttribute("aria-pressed", String(state.lang === "en"));

        // actor default swap (nur wenn exakt default)
        const v = ($("#actor").value || "").trim();
        if(state.lang === "en" && v === "Mitglied") $("#actor").value = "Member";
        if(state.lang !== "en" && v === "Member") $("#actor").value = "Mitglied";

        try{ localStorage.setItem(KEY_LANG, state.lang); }catch(e){}
        renderFlow();
        renderKPIs();
        setStatus("—");
      }

      function setStatus(msg){
        $("#k_status").textContent = msg || "—";
        $("#statusLine").textContent = msg || "—";
      }

      function saveNow(){
        try{
          const obj = {
            visibleCount: state.visibleCount,
            activeIndex: state.activeIndex,
            autoOn: state.autoOn,
            actor: $("#actor").value || "",
            autoSpeed: $("#autoSpeed").value || "650",
            notes: $("#notes").value || "",
            lang: state.lang
          };
          localStorage.setItem(KEY_STATE, JSON.stringify(obj));
          $("#saveHint").textContent = (state.lang==="en") ? "Saved." : "Gespeichert.";
        }catch(e){
          $("#saveHint").textContent = (state.lang==="en") ? "Save failed." : "Speichern fehlgeschlagen.";
        }
      }

      let tSave=null;
      function scheduleSave(){
        $("#saveHint").textContent = (state.lang==="en") ? "Saving…" : "Speichert…";
        if(tSave) clearTimeout(tSave);
        tSave = setTimeout(()=>{ saveNow(); tSave=null; }, 240);
      }

      function loadNow(){
        try{
          const raw = localStorage.getItem(KEY_STATE);
          if(!raw) return;
          const obj = JSON.parse(raw);

          if(Number.isFinite(+obj.visibleCount)) state.visibleCount = clamp(+obj.visibleCount, 1, STEPS.length);
          if(Number.isFinite(+obj.activeIndex)) state.activeIndex = clamp(+obj.activeIndex, 0, STEPS.length-1);
          state.autoOn = !!obj.autoOn;

          if(typeof obj.actor === "string") $("#actor").value = obj.actor;
          if(typeof obj.autoSpeed === "string" || typeof obj.autoSpeed === "number") $("#autoSpeed").value = String(obj.autoSpeed);
          if(typeof obj.notes === "string") $("#notes").value = obj.notes;

          if(obj.lang) setLang(obj.lang === "en" ? "en" : "de");
        }catch(e){}
      }

      function stopAuto(){
        if(autoTimer) clearInterval(autoTimer);
        autoTimer = null;
        state.autoOn = false;
        $("#btnAuto").setAttribute("aria-pressed", "false");
        setStatus(I18N[state.lang].statusAutoOff);
        scheduleSave();
      }

      function startAuto(){
        stopAuto();
        state.autoOn = true;
        $("#btnAuto").setAttribute("aria-pressed", "true");
        setStatus(I18N[state.lang].statusAutoOn);

        const ms = clamp(toNum($("#autoSpeed").value), 220, 2000);
        autoTimer = setInterval(()=> stepNext(), ms);
        scheduleSave();
      }

      function stepNext(){
        // make next visible first, then move active
        if(state.visibleCount < STEPS.length){
          state.visibleCount++;
        }
        if(state.activeIndex < state.visibleCount-1){
          state.activeIndex++;
        }else if(state.activeIndex < STEPS.length-1){
          state.activeIndex++;
        }

        renderFlow();
        renderKPIs();
        scheduleSave();

        if(state.visibleCount >= STEPS.length && state.activeIndex >= STEPS.length-1){
          stopAuto();
        }
      }

      function stepPrev(){
        if(state.activeIndex > 0){
          state.activeIndex--;
          renderFlow();
          renderKPIs();
          scheduleSave();
        }
      }

      function jumpStart(){
        state.visibleCount = 1;
        state.activeIndex = 0;
        renderFlow();
        renderKPIs();
        setStatus(I18N[state.lang].statusReady);
        scheduleSave();
      }

      function showAll(){
        state.visibleCount = STEPS.length;
        state.activeIndex = STEPS.length-1;
        renderFlow();
        renderKPIs();
        setStatus(I18N[state.lang].statusAll);
        scheduleSave();
      }

      function resetAll(){
        stopAuto();
        state.visibleCount = 1;
        state.activeIndex = 0;
        $("#autoSpeed").value = "650";
        $("#notes").value = "";
        $("#actor").value = (state.lang==="en") ? "Member" : "Mitglied";
        renderFlow();
        renderKPIs();
        setStatus(I18N[state.lang].statusReset);
        scheduleSave();
      }

      function renderKPIs(){
        $("#k_visible").textContent = String(state.visibleCount);
        $("#k_active").textContent = String(state.activeIndex+1).padStart(2,"0");
      }

      function arrowEl(){
        const d = I18N[state.lang];
        const wrap = document.createElement("div");
        wrap.className = "arrowWrap";
        const a = document.createElement("div");
        a.className = "arrow visible";
        a.innerHTML = `
          <span>${d.arrow}</span>
          <svg viewBox="0 0 56 18" fill="none" aria-hidden="true">
            <path d="M2 9h42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M36 3l8 6-8 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        `;
        wrap.appendChild(a);
        return wrap;
      }

      function renderFlow(){
        const d = I18N[state.lang];
        const actor = ($("#actor").value || (state.lang==="en" ? "Member" : "Mitglied")).trim();

        const flow = $("#flow");
        flow.innerHTML = "";

        for(let i=0;i<STEPS.length;i++){
          const s = STEPS[i];
          const isVisible = (i < state.visibleCount);
          const isActive = (i === state.activeIndex);

          const wrap = document.createElement("div");
          wrap.className = "stepWrap";

          const card = document.createElement("div");
          card.className = "stepCard" + (isVisible ? " visible" : "") + (isActive ? " active" : "");
          card.setAttribute("data-step", String(i));

          const title = d[s.t] || "";
          const body = d[s.b] || "";

          card.innerHTML = `
            <div class="stepTop">
              <div style="min-width:0;">
                <div class="tag">${String(i+1).padStart(2,"0")}</div>
              </div>
              <div style="flex:1;min-width:0;">
                <p class="stepTitle">${actor}: ${title}</p>
                <p class="stepBody">${body}</p>
              </div>
            </div>
            <div class="stepActions noPrint">
              <button class="chip primary" type="button" data-go="active">${(state.lang==="en") ? "Focus" : "Fokus"}</button>
              <button class="chip" type="button" data-go="next">${(state.lang==="en") ? "Show next" : "Nächsten zeigen"}</button>
              <button class="chip" type="button" data-go="all">${(state.lang==="en") ? "Show all" : "Alle zeigen"}</button>
            </div>
          `;

          card.addEventListener("click", (e)=>{
            const t = e.target;
            if(t && t.getAttribute && t.getAttribute("data-go")){
              const go = t.getAttribute("data-go");
              if(go === "active"){
                state.activeIndex = i;
              }else if(go === "next"){
                if(state.visibleCount < STEPS.length) state.visibleCount = clamp(state.visibleCount+1, 1, STEPS.length);
                state.activeIndex = clamp(i+1, 0, STEPS.length-1);
              }else if(go === "all"){
                showAll(); return;
              }
              renderFlow();
              renderKPIs();
              scheduleSave();
              return;
            }

            // normal click: focus this step
            if(isVisible){
              state.activeIndex = i;
              renderFlow();
              renderKPIs();
              scheduleSave();
            }
          });

          wrap.appendChild(card);

          // add arrow after visible cards except last visible
          if(isVisible && i < state.visibleCount-1){
            wrap.appendChild(arrowEl());
          }

          flow.appendChild(wrap);
        }

        // Status
        $("#btnAuto").setAttribute("aria-pressed", String(state.autoOn));
      }

      // Bindings
      $("#btnNext").addEventListener("click", ()=>{ stopAuto(); stepNext(); });
      $("#btnPrev").addEventListener("click", ()=>{ stopAuto(); stepPrev(); });

      $("#btnAuto").addEventListener("click", ()=>{
        if(state.autoOn) stopAuto();
        else startAuto();
      });

      $("#btnJumpStart").addEventListener("click", ()=>{ stopAuto(); jumpStart(); });
      $("#btnShowAll").addEventListener("click", ()=>{ stopAuto(); showAll(); });

      $("#btnResetAll").addEventListener("click", resetAll);
      $("#btnPrint").addEventListener("click", ()=> window.print());

      document.querySelectorAll("[data-reset]").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          const id = btn.getAttribute("data-reset");
          if(id === "actor") $("#actor").value = (state.lang==="en") ? "Member" : "Mitglied";
          if(id === "autoSpeed") $("#autoSpeed").value = "650";
          stopAuto();
          renderFlow();
          renderKPIs();
          scheduleSave();
        });
      });

      // Inputs
      ["actor","autoSpeed","notes"].forEach(id=>{
        $(id).addEventListener("input", ()=>{ scheduleSave(); renderFlow(); renderKPIs(); });
        $(id).addEventListener("change", ()=>{ scheduleSave(); renderFlow(); renderKPIs(); });
      });

      // Language
      $("#langDE").addEventListener("click", ()=> setLang("de"));
      $("#langEN").addEventListener("click", ()=> setLang("en"));

      // init
      const savedLang = getLang();
      setLang(savedLang === "en" ? "en" : "de");
      loadNow();
      renderFlow();
      renderKPIs();
      setStatus(I18N[state.lang].statusReady);
      $("#saveHint").textContent = I18N[state.lang].statusReady;
    })();
  </script>
</body>
</html>
