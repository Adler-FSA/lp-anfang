<!doctype html>
<!--
  FSA • Tragfähigkeits-Simulation (3 Ebenen)
  GitHub-Pfad: lp-anfang/pages/tragfaehigkeits-simulation-02.html

  Commit-Message: tragfaehigkeits-simulation-02 – E2/E3 Fix: Aktive zählen im selben Monat, Provision-Texte ohne Orientierung
  Testlink (nocache): https://adler-fsa.github.io/lp-anfang/pages/tragfaehigkeits-simulation-02.html?nocache=__TS__
-->
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tragfähigkeits-Rechner – 3 Ebenen</title>
  <meta name="description" content="Tragfähigkeits-Rechner (3 Ebenen): einfache Tragfähigkeits-Simulation ohne Hebel. Quoten & Arbeitseinheiten als Auswahl. Wow-UI, LocalStorage, Print, DE/EN." />
  <meta name="robots" content="noindex,nofollow" />

  <style>
    :root{
      --bg:#ffffff;
      --txt:#0b0b0b;
      --muted:#4a4a4a;
      --line:#d7d7d7;
      --soft:#f6f6f6;
      --soft2:#fbfbfb;

      --radius:16px;
      --shadow:0 14px 30px rgba(0,0,0,.10);
      --shadow2:0 10px 22px rgba(0,0,0,.08);

      --sans: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
      --mono: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
    }

    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      background:var(--bg);
      color:var(--txt);

      overflow-wrap:anywhere;
      word-break:break-word;
      hyphens:auto;
    }

    .wrap{
      max-width:1180px;
      margin:0 auto;
      padding:20px 16px 70px;
    }

    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      padding-bottom:12px;
      border-bottom:1px solid var(--line);
      margin-bottom:12px;
    }

    h1{
      margin:0 0 6px 0;
      font-size:22px;
      line-height:1.15;
      letter-spacing:.2px;
    }
    .sub{
      margin:0;
      color:var(--muted);
      font-size:14px;
      line-height:1.55;
      max-width:980px;
    }

    .topRight{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .pillRow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }
    .pill{
      appearance:none;
      border:1px solid var(--line);
      background:#fff;
      color:var(--txt);
      padding:8px 10px;
      border-radius:999px;
      font-weight:950;
      font-size:13px;
      cursor:pointer;
      user-select:none;
      box-shadow:0 2px 0 rgba(0,0,0,.03);
    }
    .pill[aria-pressed="true"]{
      border-color:#0b0b0b;
      box-shadow:0 0 0 2px rgba(0,0,0,.07) inset, 0 2px 0 rgba(0,0,0,.03);
    }

    .btn{
      appearance:none;
      border:1px solid #0b0b0b;
      background:#0b0b0b;
      color:#fff;
      padding:10px 12px;
      border-radius:14px;
      font-weight:950;
      font-size:13px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      user-select:none;
      box-shadow:0 10px 20px rgba(0,0,0,.10);
    }
    .btn.secondary{
      background:#fff;
      color:#0b0b0b;
      border:1px solid var(--line);
      box-shadow:0 6px 14px rgba(0,0,0,.06);
    }
    .btn:active{ transform: translateY(1px); }
    .btn svg{ width:16px; height:16px; }

    .hero{
      border:1px solid var(--line);
      background:var(--soft2);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px;
      position:relative;
      overflow:hidden;
    }
    .hero::before{
      content:"";
      position:absolute; inset:-30px;
      background:
        radial-gradient(560px 220px at 18% 8%, rgba(0,0,0,.06), transparent 60%),
        radial-gradient(520px 240px at 80% 25%, rgba(0,0,0,.04), transparent 60%);
      pointer-events:none;
    }
    .heroInner{ position:relative; z-index:1; }
    .heroTitle{
      margin:0 0 6px 0;
      font-size:15px;
      font-weight:950;
      letter-spacing:.2px;
    }
    .heroText{
      margin:0;
      color:var(--muted);
      font-size:13.5px;
      line-height:1.6;
      max-width:1050px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
      margin-top:14px;
    }

    .card{
      border:1px solid var(--line);
      background:var(--soft2);
      border-radius:var(--radius);
      box-shadow:var(--shadow2);
      padding:14px;
      position:relative;
    }
    .card h2{
      margin:0 0 10px 0;
      font-size:16px;
      letter-spacing:.2px;
    }
    .hint{
      margin:0 0 10px 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.55;
      max-width:1050px;
    }

    .sectionTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:8px;
    }
    .sectionTools{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }
    .miniBtn{
      appearance:none;
      border:1px solid var(--line);
      background:#fff;
      color:#0b0b0b;
      padding:8px 10px;
      border-radius:12px;
      font-weight:950;
      font-size:12px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow:0 6px 14px rgba(0,0,0,.05);
      user-select:none;
    }
    .miniBtn svg{ width:14px; height:14px; }

    .rows{
      display:grid;
      gap:10px;
    }
    .row{
      display:grid;
      grid-template-columns: 1.25fr 1fr auto;
      gap:10px;
      align-items:center;
      padding:10px;
      border-radius:14px;
      background:#fff;
      border:1px solid var(--line);
    }
    @media (max-width:720px){
      .row{ grid-template-columns: 1fr; }
      .row .resetCell{ justify-content:flex-start; }
    }
    .lab{
      font-weight:950;
      font-size:13px;
    }
    .subLab{
      margin-top:3px;
      color:var(--muted);
      font-size:12px;
      line-height:1.4;
    }

    .ctrl{
      display:grid;
      gap:6px;
    }
    input[type="number"], select, input[type="range"]{
      width:100%;
      box-sizing:border-box;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#fff;
      color:#0b0b0b;
      font-size:14px;
      outline:none;
      font-family:var(--sans);
    }
    input[type="number"]:focus, select:focus{
      border-color:#0b0b0b;
      box-shadow:0 0 0 3px rgba(0,0,0,.08);
    }
    .rangeWrap{
      display:grid;
      gap:8px;
    }
    .rangeLine{
      display:flex;
      justify-content:space-between;
      gap:10px;
      color:var(--muted);
      font-size:12px;
      font-family:var(--mono);
    }

    .resetCell{
      display:flex;
      justify-content:flex-end;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
    }
    .resetOne{
      appearance:none;
      border:1px solid var(--line);
      background:var(--soft);
      color:#0b0b0b;
      padding:8px 10px;
      border-radius:12px;
      font-weight:950;
      font-size:12px;
      cursor:pointer;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .resetOne:hover{ background:#fff; }

    .chips{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
      margin-top:6px;
    }
    .chip{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      border:1px solid var(--line);
      border-radius:999px;
      background:#fff;
      font-weight:950;
      font-size:12px;
      user-select:none;
      white-space:nowrap;
    }
    .chip .mono{ font-family:var(--mono); }

    .kpiGrid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
      margin-top:10px;
    }
    @media (max-width:980px){ .kpiGrid{ grid-template-columns: repeat(2, 1fr);} }
    @media (max-width:520px){ .kpiGrid{ grid-template-columns: 1fr;} }

    .kpi{
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
      position:relative;
      overflow:hidden;
    }
    .kpi::before{
      content:"";
      position:absolute; inset:-20px;
      background: radial-gradient(420px 180px at 20% 20%, rgba(0,0,0,.05), transparent 60%);
      pointer-events:none;
      opacity:.85;
    }
    .kpi > *{ position:relative; z-index:1; }
    .kpi .t{
      margin:0 0 6px 0;
      font-size:12px;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.06em;
      font-weight:950;
    }
    .kpi .v{
      margin:0;
      font-size:20px;
      font-weight:1000;
      letter-spacing:.2px;
      font-family:var(--mono);
    }
    .kpi .d{
      margin:6px 0 0 0;
      font-size:12px;
      color:var(--muted);
      line-height:1.45;
    }

    .tableWrap{
      margin-top:10px;
      border:1px solid var(--line);
      border-radius:14px;
      overflow:auto;
      background:#fff;
    }
    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      min-width:860px;
      table-layout:fixed;
      font-family:var(--mono);
      font-size:12px;
    }
    th, td{
      padding:10px 10px;
      border-bottom:1px solid var(--line);
      text-align:left;
      white-space:nowrap;
    }
    th{
      background:var(--soft);
      position:sticky;
      top:0;
      z-index:1;
      font-size:12px;
      letter-spacing:.06em;
      text-transform:uppercase;
      font-family:var(--sans);
      font-weight:950;
      color:#0b0b0b;
    }
    tr:last-child td{ border-bottom:0; }
    .right{ text-align:right; }
    .muted{ color:var(--muted); }

    .checks{
      display:grid;
      gap:10px;
      margin-top:8px;
    }
    .checkLine{
      display:flex;
      gap:10px;
      align-items:flex-start;
      padding:10px;
      border-radius:14px;
      background:#fff;
      border:1px solid var(--line);
    }
    .checkLine input{ margin-top:3px; }
    .checkText{ flex:1; }
    .checkTitle{
      font-weight:950;
      font-size:13px;
      margin:0;
    }
    .checkSub{
      margin:4px 0 0 0;
      color:var(--muted);
      font-size:12px;
      line-height:1.45;
    }
    .priceTag{
      font-family:var(--mono);
      font-weight:950;
      font-size:12px;
      white-space:nowrap;
    }

    .slots{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      margin-top:10px;
    }
    @media (max-width:860px){ .slots{ grid-template-columns: 1fr; } }
    .slot{
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
    }
    .slotTitle{
      margin:0 0 8px 0;
      font-weight:1000;
      font-size:13px;
      letter-spacing:.2px;
    }
    .slotBtns{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }

    details.acc{
      margin-top:10px;
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
      overflow:hidden;
    }
    details.acc summary{
      list-style:none;
      cursor:pointer;
      padding:12px 12px;
      font-weight:1000;
      font-size:13px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      user-select:none;
    }
    details.acc summary::-webkit-details-marker{ display:none; }
    .chev{
      width:18px; height:18px;
      transition: transform .18s ease;
      flex:0 0 auto;
    }
    details.acc[open] .chev{ transform: rotate(180deg); }
    .accBody{
      border-top:1px solid var(--line);
      padding:0 12px 12px 12px;
      font-size:13.5px;
      line-height:1.6;
      color:#0b0b0b;
    }
    .accBody p{ margin:10px 0 0 0; }

    .notes{
      margin-top:10px;
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
    }
    textarea{
      width:100%;
      box-sizing:border-box;
      min-height:150px;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      font-size:14px;
      font-family:var(--sans);
      outline:none;
      resize:vertical;

      overflow-wrap:anywhere;
      word-break:break-word;
      hyphens:auto;
    }
    textarea:focus{
      border-color:#0b0b0b;
      box-shadow:0 0 0 3px rgba(0,0,0,.08);
    }
    .noteRow{
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:10px;
    }
    #saveHint{
      color:var(--muted);
      font-size:13px;
    }

    .footerNote{
      margin-top:14px;
      padding-top:12px;
      border-top:1px solid var(--line);
      color:var(--muted);
      font-size:12.5px;
      line-height:1.6;
    }

    /* Print */
    @page{ margin: 12mm; }
    @media print{
      *{ -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .noPrint{ display:none !important; }
      body{ background:#fff !important; color:#000 !important; }
      .card,.hero,.kpi,.slot,.checkLine,.row,.notes,details.acc,.tableWrap{
        box-shadow:none !important;
        border-color:#000 !important;
      }
      th{ position:static !important; background:#f0f0f0 !important; }
      table{ min-width:0 !important; width:100% !important; }
    }
  </style>
</head>

<body>
  <div class="wrap">

    <header>
      <div>
        <h1 data-i18n="h1">Tragfähigkeits-Rechner (3 Ebenen)</h1>
        <p class="sub" data-i18n="sub">
          Dieser Rechner macht sichtbar, wie kontinuierliches Dranbleiben eine Struktur aufbaut, die mit der Zeit stärker trägt.
          Du stellst deine Annahmen selbst ein – mit einfachen Auswahlfeldern.
        </p>
      </div>

      <div class="topRight noPrint">
        <div class="pillRow" aria-label="Sprache">
          <button class="pill" id="langDE" type="button" aria-pressed="true">DE</button>
          <button class="pill" id="langEN" type="button" aria-pressed="false">EN</button>
        </div>

        <button class="btn secondary" id="btnCopy" type="button" aria-label="Ergebnis kopieren">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M9 9h10v12H9V9Z" stroke="currentColor" stroke-width="2"/>
            <path d="M5 3h10v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M5 7h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M5 7v14h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span data-i18n="copy">Kopieren</span>
        </button>

        <button class="btn secondary" id="btnPrint" type="button">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M7 8V3h10v5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M7 17h10v4H7v-4Z" stroke="currentColor" stroke-width="2"/>
            <path d="M6 18H5a3 3 0 0 1-3-3v-4a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v4a3 3 0 0 1-3 3h-1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M18 12h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
          </svg>
          <span data-i18n="print">Drucken</span>
        </button>

        <button class="btn" id="btnResetAll" type="button">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M3 12a9 9 0 0 1 15.36-6.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M18 4v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M21 12a9 9 0 0 1-15.36 6.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span data-i18n="resetAll">Alles auf 0</span>
        </button>
      </div>
    </header>

    <section class="hero">
      <div class="heroInner">
        <div class="heroTitle" data-i18n="heroTitle">Wichtiger Hinweis</div>
        <p class="heroText" data-i18n="heroText">
          Diese Simulation soll Tragfähigkeit mathematisch sichtbar machen – ohne „reich rechnen“.
          Jeder entwickelt sich in seinem Tempo. Die Werte sind Annahmen, keine Garantie.
        </p>

        <div class="chips" aria-label="Sätze">
          <div class="chip"><span class="mono">20%</span> <span data-i18n="l1">Ebene 1</span></div>
          <div class="chip"><span class="mono">15%</span> <span data-i18n="l2">Ebene 2</span></div>
          <div class="chip"><span class="mono">10%</span> <span data-i18n="l3">Ebene 3</span></div>
          <div class="chip"><span data-i18n="demoDefaults">Beispiel-Start</span>: <span class="mono">6 Monate · E1 20×1 · Quote 20%</span></div>
        </div>
      </div>
    </section>

    <div class="grid">

      <section class="card">
        <div class="sectionTop">
          <div>
            <h2 data-i18n="inputsTitle">Einstellungen (einfach)</h2>
            <p class="hint" data-i18n="inputsHint">
              Du stellst den Zeitraum ein und konfigurierst pro Ebene: Arbeitseinheiten, neue Mitglieder pro Einheit und Aktiv-Quote.
              Aktiv bedeutet: Dieses Mitglied macht selbst Werbung und baut seine erste Ebene auf.
            </p>
          </div>
          <div class="sectionTools noPrint">
            <button class="miniBtn" id="resetTime" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M21 12a9 9 0 1 1-2.64-6.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M18 3v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span data-i18n="resetTime">Zeitraum auf 0</span>
            </button>

            <button class="miniBtn" id="resetBuild" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M4 7h16M4 12h16M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span data-i18n="resetBuild">Aufbau auf Beispiel</span>
            </button>

            <button class="miniBtn" id="resetBasket" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M6 6h15l-2 9H8L6 6Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                <path d="M8 21a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" stroke="currentColor" stroke-width="2"/>
                <path d="M18 21a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" stroke="currentColor" stroke-width="2"/>
                <path d="M6 6 5 3H2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span data-i18n="resetBasket">Bausteine aus</span>
            </button>
          </div>
        </div>

        <div class="rows">
          <div class="row">
            <div>
              <div class="lab" data-i18n="months">Zeitraum (Monate)</div>
              <div class="subLab" data-i18n="monthsSub">0–12 (du bestimmst die Zeit)</div>
            </div>
            <div class="ctrl rangeWrap">
              <input id="months" type="range" min="0" max="12" step="1" value="0" data-store />
              <div class="rangeLine"><span class="muted">0</span><span class="mono" id="monthsOut">0</span><span class="muted">12</span></div>
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="months" type="button">↺ <span data-i18n="toZero">auf 0</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="e1Work">Arbeitseinheiten/Monat (Ebene 1)</div>
              <div class="subLab" data-i18n="e1WorkSub">Anna / deine Aktivität (4/8/12/16/20/24)</div>
            </div>
            <div class="ctrl">
              <select id="e1Work" data-store>
                <option value="4">4</option>
                <option value="8">8</option>
                <option value="12">12</option>
                <option value="16">16</option>
                <option value="20" selected>20</option>
                <option value="24">24</option>
              </select>
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e1Work" type="button">↺ <span data-i18n="toDemo">auf Beispiel</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="e1PerUnit">Neue Mitglieder pro Einheit (Ebene 1)</div>
              <div class="subLab" data-i18n="e1PerUnitSub">z. B. 1 pro Tag/Std → abhängig von deinem Tempo</div>
            </div>
            <div class="ctrl">
              <input id="e1PerUnit" type="number" min="0" max="50" step="1" value="1" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e1PerUnit" type="button">↺ <span data-i18n="toDemo">auf Beispiel</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="e1Active">Aktiv-Quote Ebene 1</div>
              <div class="subLab" data-i18n="e1ActiveSub">Wie viele deiner neuen Mitglieder werden selbst aktiv?</div>
            </div>
            <div class="ctrl">
              <select id="e1Active" data-store>
                <option value="10">10 %</option>
                <option value="20" selected>20 %</option>
                <option value="30">30 %</option>
                <option value="40">40 %</option>
                <option value="50">50 %</option>
                <option value="60">60 %</option>
                <option value="70">70 %</option>
              </select>
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e1Active" type="button">↺ <span data-i18n="toDemo">auf Beispiel</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="e2Work">Arbeitseinheiten/Monat (aktive Ebene 2)</div>
              <div class="subLab" data-i18n="e2WorkSub">Wie stark arbeiten die Aktiven aus Ebene 1?</div>
            </div>
            <div class="ctrl">
              <select id="e2Work" data-store>
                <option value="4">4</option>
                <option value="8">8</option>
                <option value="12">12</option>
                <option value="16">16</option>
                <option value="20" selected>20</option>
                <option value="24">24</option>
              </select>
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e2Work" type="button">↺ <span data-i18n="toDemo">auf Beispiel</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="e2PerUnit">Neue Mitglieder pro Einheit (aktive Ebene 2)</div>
              <div class="subLab" data-i18n="e2PerUnitSub">Standard: 1 (wie Anna) – oder realistisch niedriger</div>
            </div>
            <div class="ctrl">
              <input id="e2PerUnit" type="number" min="0" max="50" step="1" value="1" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e2PerUnit" type="button">↺ <span data-i18n="toDemo">auf Beispiel</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="e2Active">Aktiv-Quote Ebene 2</div>
              <div class="subLab" data-i18n="e2ActiveSub">Wie viele der neuen Mitglieder in Ebene 2 werden selbst aktiv?</div>
            </div>
            <div class="ctrl">
              <select id="e2Active" data-store>
                <option value="10">10 %</option>
                <option value="20" selected>20 %</option>
                <option value="30">30 %</option>
                <option value="40">40 %</option>
                <option value="50">50 %</option>
                <option value="60">60 %</option>
                <option value="70">70 %</option>
              </select>
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e2Active" type="button">↺ <span data-i18n="toDemo">auf Beispiel</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="e3Work">Arbeitseinheiten/Monat (aktive Ebene 3)</div>
              <div class="subLab" data-i18n="e3WorkSub">Wie stark arbeiten die Aktiven aus Ebene 2?</div>
            </div>
            <div class="ctrl">
              <select id="e3Work" data-store>
                <option value="4">4</option>
                <option value="8">8</option>
                <option value="12">12</option>
                <option value="16">16</option>
                <option value="20" selected>20</option>
                <option value="24">24</option>
              </select>
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e3Work" type="button">↺ <span data-i18n="toDemo">auf Beispiel</span></button>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="lab" data-i18n="e3PerUnit">Neue Mitglieder pro Einheit (aktive Ebene 3)</div>
              <div class="subLab" data-i18n="e3PerUnitSub">Ebene 3 erzeugt noch Mitglieder, aber es gibt keine Ebene 4-Provision</div>
            </div>
            <div class="ctrl">
              <input id="e3PerUnit" type="number" min="0" max="50" step="1" value="1" data-store />
            </div>
            <div class="resetCell noPrint">
              <button class="resetOne" data-reset="e3PerUnit" type="button">↺ <span data-i18n="toDemo">auf Beispiel</span></button>
            </div>
          </div>
        </div>

        <div class="chips" style="margin-top:10px;">
          <div class="chip"><span data-i18n="howItWorks">So rechnet der Rechner</span>:
            <span class="mono" id="howOut">—</span>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="sectionTop">
          <div>
            <h2 data-i18n="basketTitle">Bausteine (Auswahl)</h2>
            <p class="hint" data-i18n="basketHint">
              Diese vier Produkte reichen aus, um Tragfähigkeit zu simulieren. Du entscheidest, was du pro neuem Mitglied als Annahme einbeziehst.
            </p>
          </div>
          <div class="sectionTools noPrint">
            <button class="miniBtn" id="resetBasket2" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M6 6h15l-2 9H8L6 6Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                <path d="M8 21a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" stroke="currentColor" stroke-width="2"/>
                <path d="M18 21a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" stroke="currentColor" stroke-width="2"/>
                <path d="M6 6 5 3H2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span data-i18n="basketOff">Alles aus</span>
            </button>
          </div>
        </div>

        <div class="checks">
          <div class="checkLine">
            <input id="chkMember" type="checkbox" data-store />
            <div class="checkText">
              <p class="checkTitle" data-i18n="member">Mitgliedschaft (jährlich)</p>
              <p class="checkSub" data-i18n="memberSub">60 € netto / Jahr (wiederkehrend)</p>
            </div>
            <div class="priceTag">60 €</div>
          </div>

          <div class="checkLine">
            <input id="chkLeadSmall" type="checkbox" data-store />
            <div class="checkText">
              <p class="checkTitle" data-i18n="leadSmall">Kleine Leadmaschine (jährlich)</p>
              <p class="checkSub" data-i18n="leadSmallSub">60 € netto / Jahr (wiederkehrend)</p>
            </div>
            <div class="priceTag">60 €</div>
          </div>

          <div class="checkLine">
            <input id="chkLeadPro" type="checkbox" data-store />
            <div class="checkText">
              <p class="checkTitle" data-i18n="leadPro">Profi Leadmaschine (jährlich)</p>
              <p class="checkSub" data-i18n="leadProSub">298 € netto / Jahr (wiederkehrend)</p>
            </div>
            <div class="priceTag">298 €</div>
          </div>

          <div class="checkLine">
            <input id="chkWeekend" type="checkbox" data-store />
            <div class="checkText">
              <p class="checkTitle" data-i18n="weekend">Weekend-Setup (einmalig)</p>
              <p class="checkSub" data-i18n="weekendSub">399 € netto (Einmalprodukt)</p>
            </div>
            <div class="priceTag">399 €</div>
          </div>
        </div>

        <div class="chips" style="margin-top:10px;">
          <div class="chip"><span data-i18n="basketPerMember">Warenkorb je neues Mitglied</span>: <span class="mono" id="basketOut">0,00 €</span></div>
        </div>

        <div class="slots noPrint" aria-label="Szenarien">
          <div class="slot">
            <div class="slotTitle" data-i18n="slotA">Szenario A</div>
            <div class="slotBtns">
              <button class="miniBtn" data-slot="A" data-action="save" type="button"><span data-i18n="save">Speichern</span></button>
              <button class="miniBtn" data-slot="A" data-action="load" type="button"><span data-i18n="load">Laden</span></button>
              <button class="miniBtn" data-slot="A" data-action="clear" type="button"><span data-i18n="clear">Löschen</span></button>
            </div>
          </div>
          <div class="slot">
            <div class="slotTitle" data-i18n="slotB">Szenario B</div>
            <div class="slotBtns">
              <button class="miniBtn" data-slot="B" data-action="save" type="button"><span data-i18n="save">Speichern</span></button>
              <button class="miniBtn" data-slot="B" data-action="load" type="button"><span data-i18n="load">Laden</span></button>
              <button class="miniBtn" data-slot="B" data-action="clear" type="button"><span data-i18n="clear">Löschen</span></button>
            </div>
          </div>
          <div class="slot">
            <div class="slotTitle" data-i18n="slotC">Szenario C</div>
            <div class="slotBtns">
              <button class="miniBtn" data-slot="C" data-action="save" type="button"><span data-i18n="save">Speichern</span></button>
              <button class="miniBtn" data-slot="C" data-action="load" type="button"><span data-i18n="load">Laden</span></button>
              <button class="miniBtn" data-slot="C" data-action="clear" type="button"><span data-i18n="clear">Löschen</span></button>
            </div>
          </div>
        </div>
      </section>

      <section class="card" id="results">
        <div class="sectionTop">
          <div>
            <h2 data-i18n="resultsTitle">Ergebnis</h2>
            <p class="hint" data-i18n="resultsHint">
              Ebenen getrennt + Provision getrennt. Live, mit sichtbarem Count-Up.
            </p>
          </div>
          <div class="sectionTools noPrint">
            <button class="miniBtn" id="btnZeroEarnings" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M4 12h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M12 4v16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span data-i18n="recalc">Neu berechnen</span>
            </button>
          </div>
        </div>

        <div class="kpiGrid">
          <div class="kpi">
            <p class="t" data-i18n="kNew1">Neue Mitglieder – Ebene 1</p>
            <p class="v" id="k_new1">0</p>
            <p class="d" data-i18n="kNew1d">deine Erstlinie im Zeitraum</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kNew2">Neue Mitglieder – Ebene 2</p>
            <p class="v" id="k_new2">0</p>
            <p class="d" data-i18n="kNew2d">entsteht aus aktiven Mitgliedern der Ebene 1</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kNew3">Neue Mitglieder – Ebene 3</p>
            <p class="v" id="k_new3">0</p>
            <p class="d" data-i18n="kNew3d">entsteht aus aktiven Mitgliedern der Ebene 2</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kNewT">Gesamt neue Mitglieder</p>
            <p class="v" id="k_newT">0</p>
            <p class="d" data-i18n="kNewTd">Summe Ebene 1–3</p>
          </div>

          <div class="kpi">
            <p class="t" data-i18n="kProv1">Provision – Ebene 1</p>
            <p class="v" id="k_p1">0,00 €</p>
            <p class="d" data-i18n="kProv1d">20% vom angenommenen Umsatz</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kProv2">Provision – Ebene 2</p>
            <p class="v" id="k_p2">0,00 €</p>
            <p class="d" data-i18n="kProv2d">15% vom angenommenen Umsatz</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kProv3">Provision – Ebene 3</p>
            <p class="v" id="k_p3">0,00 €</p>
            <p class="d" data-i18n="kProv3d">10% vom angenommenen Umsatz</p>
          </div>
          <div class="kpi">
            <p class="t" data-i18n="kProvT">Gesamt-Provision</p>
            <p class="v" id="k_pT">0,00 €</p>
            <p class="d" data-i18n="kProvTd">Summe Ebene 1–3</p>
          </div>
        </div>

        <div class="tableWrap" aria-label="Monats-Tabelle">
          <table>
            <thead>
              <tr>
                <th data-i18n="thM">Monat</th>
                <th data-i18n="th1">Neu E1</th>
                <th data-i18n="th2">Neu E2</th>
                <th data-i18n="th3">Neu E3</th>
                <th class="right" data-i18n="thB">Warenkorb</th>
                <th class="right" data-i18n="thP1">Prov E1</th>
                <th class="right" data-i18n="thP2">Prov E2</th>
                <th class="right" data-i18n="thP3">Prov E3</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>

        <div class="footerNote" data-i18n="footerNote">
          Hinweis: Simulation zur Einordnung. Keine Abrechnung, keine Steuer-/Rechtsberatung. Ergebnisse hängen von Tempo, Aktivität und Zeit ab.
        </div>
      </section>

      <section class="card">
        <h2 data-i18n="readerTitle">Lesertext (kurz & klar)</h2>

        <details class="acc" open>
          <summary>
            <span data-i18n="accA">Was du hier siehst</span>
            <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="accBody">
            <p data-i18n="accA1">
              Dieser Rechner zeigt, wie Tragfähigkeit entstehen kann, wenn ein Prozess konsequent wiederholt wird.
              Du stellst Annahmen ein und siehst die Ebenen getrennt – inklusive Provision je Ebene.
            </p>
          </div>
        </details>

        <details class="acc">
          <summary>
            <span data-i18n="accB">Die 3-Ebenen-Logik (einfach)</span>
            <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="accBody">
            <p data-i18n="accB1">
              Ebene 1 entsteht durch deine eigene Aktivität. Ein Teil davon wird aktiv (Quote) und baut seine eigene Ebene 1 auf.
              Diese Aktivität erzeugt aus deiner Sicht Ebene 2. Aus einem Teil von Ebene 2 wird wieder aktiv (Quote) – daraus entsteht Ebene 3.
              Das ist der Kern – ohne Hebel und ohne Abkürzungen.
            </p>
          </div>
        </details>

        <details class="acc">
          <summary>
            <span data-i18n="accC">Warum Zahlen wachsen können</span>
            <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="accBody">
            <p data-i18n="accC1">
              Wachstum ist eine Frage von Wiederholung und Zeit. Auch wenn Zahlen wachsen, heißt das nicht, dass alles so eintrifft.
              Jeder entwickelt sich im eigenen Tempo – die Simulation zeigt Möglichkeiten, wenn man dran bleibt.
            </p>
          </div>
        </details>
      </section>

      <section class="card">
        <div class="sectionTop">
          <div>
            <h2 data-i18n="notesTitle">Notizen</h2>
            <p class="hint" data-i18n="notesHint">Bleibt nur auf deinem Gerät (LocalStorage).</p>
          </div>
          <div class="sectionTools noPrint">
            <button class="miniBtn" id="clearNotes" type="button"><span data-i18n="clearNotes">Notizen löschen</span></button>
            <button class="miniBtn" id="clearAll" type="button"><span data-i18n="clearAll">Alles löschen</span></button>
          </div>
        </div>

        <div class="notes">
          <textarea id="notes" placeholder="Deine Notizen …" aria-label="Notizen" data-store></textarea>
          <div class="noteRow">
            <div id="saveHint">Bereit.</div>
            <div class="muted" style="font-family:var(--mono);" id="lastWow">—</div>
          </div>
        </div>
      </section>

    </div>
  </div>

  <script>
    (function(){
      "use strict";

      const PREFIX = "fsa_tc_trag3_simple_";
      const KEY = PREFIX + "state";
      const KEY_SLOT = (s)=> PREFIX + "slot_" + s;
      const KEY_LANG = PREFIX + "lang";

      const I18N = {
        de: {
          h1:"Tragfähigkeits-Rechner (3 Ebenen)",
          sub:"Dieser Rechner macht sichtbar, wie kontinuierliches Dranbleiben eine Struktur aufbaut, die mit der Zeit stärker trägt. Du stellst deine Annahmen selbst ein – mit einfachen Auswahlfeldern.",
          copy:"Kopieren", print:"Drucken", resetAll:"Alles auf 0",

          heroTitle:"Wichtiger Hinweis",
          heroText:"Diese Simulation soll Tragfähigkeit mathematisch sichtbar machen – ohne „reich rechnen“. Jeder entwickelt sich in seinem Tempo. Die Werte sind Annahmen, keine Garantie.",
          l1:"Ebene 1", l2:"Ebene 2", l3:"Ebene 3",
          demoDefaults:"Beispiel-Start",

          inputsTitle:"Einstellungen (einfach)",
          inputsHint:"Du stellst den Zeitraum ein und konfigurierst pro Ebene: Arbeitseinheiten, neue Mitglieder pro Einheit und Aktiv-Quote. Aktiv bedeutet: Dieses Mitglied macht selbst Werbung und baut seine erste Ebene auf.",
          resetTime:"Zeitraum auf 0", resetBuild:"Aufbau auf Beispiel", resetBasket:"Bausteine aus",

          months:"Zeitraum (Monate)", monthsSub:"0–12 (du bestimmst die Zeit)",

          e1Work:"Arbeitseinheiten/Monat (Ebene 1)", e1WorkSub:"Anna / deine Aktivität (4/8/12/16/20/24)",
          e1PerUnit:"Neue Mitglieder pro Einheit (Ebene 1)", e1PerUnitSub:"z. B. 1 pro Tag/Std → abhängig von deinem Tempo",
          e1Active:"Aktiv-Quote Ebene 1", e1ActiveSub:"Wie viele deiner neuen Mitglieder werden selbst aktiv?",

          e2Work:"Arbeitseinheiten/Monat (aktive Ebene 2)", e2WorkSub:"Wie stark arbeiten die Aktiven aus Ebene 1?",
          e2PerUnit:"Neue Mitglieder pro Einheit (aktive Ebene 2)", e2PerUnitSub:"Standard: 1 (wie Anna) – oder realistisch niedriger",
          e2Active:"Aktiv-Quote Ebene 2", e2ActiveSub:"Wie viele der neuen Mitglieder in Ebene 2 werden selbst aktiv?",

          e3Work:"Arbeitseinheiten/Monat (aktive Ebene 3)", e3WorkSub:"Wie stark arbeiten die Aktiven aus Ebene 2?",
          e3PerUnit:"Neue Mitglieder pro Einheit (aktive Ebene 3)", e3PerUnitSub:"Ebene 3 erzeugt noch Mitglieder, aber es gibt keine Ebene 4-Provision",

          toZero:"auf 0",
          toDemo:"auf Beispiel",

          howItWorks:"So rechnet der Rechner",

          basketTitle:"Bausteine (Auswahl)",
          basketHint:"Diese vier Produkte reichen aus, um Tragfähigkeit zu simulieren. Du entscheidest, was du pro neuem Mitglied als Annahme einbeziehst.",
          basketOff:"Alles aus",
          member:"Mitgliedschaft (jährlich)", memberSub:"60 € netto / Jahr (wiederkehrend)",
          leadSmall:"Kleine Leadmaschine (jährlich)", leadSmallSub:"60 € netto / Jahr (wiederkehrend)",
          leadPro:"Profi Leadmaschine (jährlich)", leadProSub:"298 € netto / Jahr (wiederkehrend)",
          weekend:"Weekend-Setup (einmalig)", weekendSub:"399 € netto (Einmalprodukt)",
          basketPerMember:"Warenkorb je neues Mitglied",

          slotA:"Szenario A", slotB:"Szenario B", slotC:"Szenario C",
          save:"Speichern", load:"Laden", clear:"Löschen",

          resultsTitle:"Ergebnis",
          resultsHint:"Ebenen getrennt + Provision getrennt. Live, mit sichtbarem Count-Up.",
          recalc:"Neu berechnen",

          kNew1:"Neue Mitglieder – Ebene 1", kNew1d:"deine Erstlinie im Zeitraum",
          kNew2:"Neue Mitglieder – Ebene 2", kNew2d:"entsteht aus aktiven Mitgliedern der Ebene 1",
          kNew3:"Neue Mitglieder – Ebene 3", kNew3d:"entsteht aus aktiven Mitgliedern der Ebene 2",
          kNewT:"Gesamt neue Mitglieder", kNewTd:"Summe Ebene 1–3",

          kProv1:"Provision – Ebene 1", kProv1d:"20% vom angenommenen Umsatz",
          kProv2:"Provision – Ebene 2", kProv2d:"15% vom angenommenen Umsatz",
          kProv3:"Provision – Ebene 3", kProv3d:"10% vom angenommenen Umsatz",
          kProvT:"Gesamt-Provision", kProvTd:"Summe Ebene 1–3",

          thM:"Monat", th1:"Neu E1", th2:"Neu E2", th3:"Neu E3", thB:"Warenkorb",
          thP1:"Prov E1", thP2:"Prov E2", thP3:"Prov E3",

          footerNote:"Hinweis: Simulation zur Einordnung. Keine Abrechnung, keine Steuer-/Rechtsberatung. Ergebnisse hängen von Tempo, Aktivität und Zeit ab.",

          readerTitle:"Lesertext (kurz & klar)",
          accA:"Was du hier siehst",
          accA1:"Dieser Rechner zeigt, wie Tragfähigkeit entstehen kann, wenn ein Prozess konsequent wiederholt wird. Du stellst Annahmen ein und siehst die Ebenen getrennt – inklusive Provision je Ebene.",
          accB:"Die 3-Ebenen-Logik (einfach)",
          accB1:"Ebene 1 entsteht durch deine eigene Aktivität. Ein Teil davon wird aktiv (Quote) und baut seine eigene Ebene 1 auf. Diese Aktivität erzeugt aus deiner Sicht Ebene 2. Aus einem Teil von Ebene 2 wird wieder aktiv (Quote) – daraus entsteht Ebene 3. Das ist der Kern – ohne Hebel und ohne Abkürzungen.",
          accC:"Warum Zahlen wachsen können",
          accC1:"Wachstum ist eine Frage von Wiederholung und Zeit. Auch wenn Zahlen wachsen, heißt das nicht, dass alles so eintrifft. Jeder entwickelt sich im eigenen Tempo – die Simulation zeigt Möglichkeiten, wenn man dran bleibt.",

          notesTitle:"Notizen",
          notesHint:"Bleibt nur auf deinem Gerät (LocalStorage).",
          clearNotes:"Notizen löschen",
          clearAll:"Alles löschen"
        },
        en: {
          h1:"Sustainability Calculator (3 Levels)",
          sub:"This calculator makes visible how consistent repetition can build a structure that carries more over time. You set your own assumptions — with simple selection fields.",
          copy:"Copy", print:"Print", resetAll:"Reset to 0",

          heroTitle:"Important note",
          heroText:"This simulation aims to make sustainability visible mathematically — without “getting rich” promises. Everyone moves at their own pace. Values are assumptions, no guarantee.",
          l1:"Level 1", l2:"Level 2", l3:"Level 3",
          demoDefaults:"Example start",

          inputsTitle:"Settings (simple)",
          inputsHint:"You set the timeframe and configure per level: work units, new members per unit, and active rate. Active means: this member promotes and builds their own first level.",
          resetTime:"Timeframe to 0", resetBuild:"Build to example", resetBasket:"Modules off",

          months:"Timeframe (months)", monthsSub:"0–12 (you set the time)",

          e1Work:"Work units/month (Level 1)", e1WorkSub:"Anna / your activity (4/8/12/16/20/24)",
          e1PerUnit:"New members per unit (Level 1)", e1PerUnitSub:"e.g., 1 per day/hour — depends on your pace",
          e1Active:"Active rate Level 1", e1ActiveSub:"How many of your new members become active?",

          e2Work:"Work units/month (active Level 2)", e2WorkSub:"How strong do the actives from Level 1 work?",
          e2PerUnit:"New members per unit (active Level 2)", e2PerUnitSub:"Default: 1 (like Anna) — or realistically lower",
          e2Active:"Active rate Level 2", e2ActiveSub:"How many new members in Level 2 become active?",

          e3Work:"Work units/month (active Level 3)", e3WorkSub:"How strong do the actives from Level 2 work?",
          e3PerUnit:"New members per unit (active Level 3)", e3PerUnitSub:"Level 3 can still create members, but there is no Level 4 commission",

          toZero:"to 0",
          toDemo:"to example",

          howItWorks:"How the calculator computes",

          basketTitle:"Modules (selection)",
          basketHint:"These four products are enough to simulate sustainability. You decide what to include per new member as an assumption.",
          basketOff:"All off",
          member:"Membership (annual)", memberSub:"€60 net / year (recurring)",
          leadSmall:"Small lead machine (annual)", leadSmallSub:"€60 net / year (recurring)",
          leadPro:"Pro lead machine (annual)", leadProSub:"€298 net / year (recurring)",
          weekend:"Weekend setup (one-time)", weekendSub:"€399 net (one-time)",
          basketPerMember:"Basket per new member",

          slotA:"Scenario A", slotB:"Scenario B", slotC:"Scenario C",
          save:"Save", load:"Load", clear:"Clear",

          resultsTitle:"Results",
          resultsHint:"Levels separated + commission separated. Live with visible count-up.",
          recalc:"Recalculate",

          kNew1:"New members – Level 1", kNew1d:"your direct line in timeframe",
          kNew2:"New members – Level 2", kNew2d:"created by active members of Level 1",
          kNew3:"New members – Level 3", kNew3d:"created by active members of Level 2",
          kNewT:"Total new members", kNewTd:"sum Level 1–3",

          kProv1:"Commission – Level 1", kProv1d:"20% of assumed revenue",
          kProv2:"Commission – Level 2", kProv2d:"15% of assumed revenue",
          kProv3:"Commission – Level 3", kProv3d:"10% of assumed revenue",
          kProvT:"Total commission", kProvTd:"sum Level 1–3",

          thM:"Month", th1:"New L1", th2:"New L2", th3:"New L3", thB:"Basket",
          thP1:"Com L1", thP2:"Com L2", thP3:"Com L3",

          footerNote:"Note: simulation for classification. No billing, no tax/legal advice. Results depend on pace, activity and time.",

          readerTitle:"Reader text (short & clear)",
          accA:"What you see here",
          accA1:"This calculator shows how sustainability can emerge when a process is repeated consistently. You set assumptions and see levels separated — including commission per level.",
          accB:"The 3-level logic (simple)",
          accB1:"Level 1 comes from your own activity. A share becomes active (rate) and builds their own Level 1. That activity creates Level 2 from your perspective. A share of Level 2 becomes active again (rate) — creating Level 3. That’s the core — without multipliers or shortcuts.",
          accC:"Why numbers can grow",
          accC1:"Growth is a question of repetition and time. Even if numbers grow, it doesn’t mean it will happen exactly like that. Everyone moves at their own pace — this shows what can be possible if you stay consistent.",

          notesTitle:"Notes",
          notesHint:"Stored only on your device (LocalStorage).",
          clearNotes:"Clear notes",
          clearAll:"Clear everything"
        }
      };

      function setLang(lang){
        const dict = I18N[lang] || I18N.de;
        document.documentElement.lang = (lang === "en") ? "en" : "de";
        document.querySelectorAll("[data-i18n]").forEach(el=>{
          const k = el.getAttribute("data-i18n");
          if(dict[k] != null) el.textContent = dict[k];
        });
        document.getElementById("langDE").setAttribute("aria-pressed", String(lang !== "en"));
        document.getElementById("langEN").setAttribute("aria-pressed", String(lang === "en"));
        try{ localStorage.setItem(KEY_LANG, lang); }catch(e){}
      }

      const $ = (id)=> document.getElementById(id);
      const clamp = (n,min,max)=> Math.min(max, Math.max(min, n));
      const toNum = (v)=>{
        const n = Number(String(v).replace(",", "."));
        return Number.isFinite(n) ? n : 0;
      };
      const pct = (v)=> clamp(toNum(v), 0, 100) / 100;
      const fmtEUR = (x)=>{
        const v = Number.isFinite(x) ? x : 0;
        return v.toLocaleString(document.documentElement.lang === "en" ? "en-US" : "de-DE", {
          style:"currency", currency:"EUR", minimumFractionDigits:2, maximumFractionDigits:2
        });
      };
      const fmtInt = (x)=> {
        const v = Math.round(Number.isFinite(x) ? x : 0);
        return v.toLocaleString(document.documentElement.lang === "en" ? "en-US" : "de-DE");
      };

      function readStateFromDom(){
        const ids = [
          "months",
          "e1Work","e1PerUnit","e1Active",
          "e2Work","e2PerUnit","e2Active",
          "e3Work","e3PerUnit",
          "chkMember","chkLeadSmall","chkLeadPro","chkWeekend",
          "notes"
        ];
        const out = {};
        ids.forEach(id=>{
          const el = $(id);
          if(!el) return;
          if(el.type === "checkbox") out[id] = !!el.checked;
          else out[id] = el.value;
        });
        return out;
      }

      function writeStateToDom(s){
        if(!s || typeof s !== "object") return;
        Object.keys(s).forEach(id=>{
          const el = $(id);
          if(!el) return;
          if(el.type === "checkbox") el.checked = !!s[id];
          else el.value = String(s[id]);
        });
        updateMonthsOut();
      }

      const saveHintEl = $("saveHint");
      function setSaveHint(msg){
        if(!saveHintEl) return;
        saveHintEl.textContent = msg;
      }
      let saveT = null;
      function scheduleSave(){
        setSaveHint("Speichert…");
        if(saveT) clearTimeout(saveT);
        saveT = setTimeout(()=>{ save(); saveT=null; }, 220);
      }

      function save(){
        try{
          localStorage.setItem(KEY, JSON.stringify(readStateFromDom()));
          setSaveHint("Gespeichert.");
        }catch(e){
          setSaveHint("Speichern fehlgeschlagen.");
        }
      }
      function load(){
        try{
          const raw = localStorage.getItem(KEY);
          if(!raw) return;
          const obj = JSON.parse(raw);
          writeStateToDom(obj);
        }catch(e){}
      }

      function setToZero(id){
        const el = $(id);
        if(!el) return;
        if(el.tagName === "SELECT"){
          if ([...el.options].some(o=>o.value==="0")) el.value = "0";
          else el.selectedIndex = 0;
        } else if(el.type === "checkbox"){
          el.checked = false;
        } else {
          el.value = "0";
        }
      }

      function setToDemo(id){
        const el = $(id);
        if(!el) return;

        if(id === "months") el.value = "6";
        if(id === "e1Work") el.value = "20";
        if(id === "e1PerUnit") el.value = "1";
        if(id === "e1Active") el.value = "20";

        if(id === "e2Work") el.value = "20";
        if(id === "e2PerUnit") el.value = "1";
        if(id === "e2Active") el.value = "20";

        if(id === "e3Work") el.value = "20";
        if(id === "e3PerUnit") el.value = "1";
      }

      function resetTimeBlock(){
        $("months").value = "0";
        updateMonthsOut();
      }
      function resetBuildBlock(){
        ["months","e1Work","e1PerUnit","e1Active","e2Work","e2PerUnit","e2Active","e3Work","e3PerUnit"].forEach(setToDemo);
        updateMonthsOut();
      }
      function resetBasketBlock(){
        ["chkMember","chkLeadSmall","chkLeadPro","chkWeekend"].forEach(setToZero);
      }
      function resetAll(){
        resetTimeBlock();
        resetBuildBlock();
        resetBasketBlock();
        setToZero("notes");
        scheduleSave();
        recalc(true);
        setSaveHint("Alles auf 0.");
      }

      $("btnResetAll")?.addEventListener("click", resetAll);
      $("resetTime")?.addEventListener("click", ()=>{ resetTimeBlock(); scheduleSave(); recalc(true); });
      $("resetBuild")?.addEventListener("click", ()=>{ resetBuildBlock(); scheduleSave(); recalc(true); });
      $("resetBasket")?.addEventListener("click", ()=>{ resetBasketBlock(); scheduleSave(); recalc(true); });
      $("resetBasket2")?.addEventListener("click", ()=>{ resetBasketBlock(); scheduleSave(); recalc(true); });

      document.querySelectorAll("[data-reset]").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          const id = btn.getAttribute("data-reset");
          if(id === "months"){ $("months").value = "0"; }
          else { setToDemo(id); }
          updateMonthsOut();
          scheduleSave();
          recalc(true);
        });
      });

      function slotKey(s){ return KEY_SLOT(s); }
      function slotSave(s){
        try{
          localStorage.setItem(slotKey(s), JSON.stringify(readStateFromDom()));
          setSaveHint("Szenario " + s + " gespeichert.");
        }catch(e){
          setSaveHint("Speichern fehlgeschlagen.");
        }
      }
      function slotLoad(s){
        try{
          const raw = localStorage.getItem(slotKey(s));
          if(!raw){ setSaveHint("Szenario " + s + " leer."); return; }
          const obj = JSON.parse(raw);
          writeStateToDom(obj);
          setSaveHint("Szenario " + s + " geladen.");
          scheduleSave();
          recalc(true);
        }catch(e){
          setSaveHint("Laden fehlgeschlagen.");
        }
      }
      function slotClear(s){
        try{
          localStorage.removeItem(slotKey(s));
          setSaveHint("Szenario " + s + " gelöscht.");
        }catch(e){}
      }
      document.querySelectorAll("[data-slot][data-action]").forEach(b=>{
        b.addEventListener("click", ()=>{
          const s = b.getAttribute("data-slot");
          const a = b.getAttribute("data-action");
          if(a === "save") slotSave(s);
          if(a === "load") slotLoad(s);
          if(a === "clear") slotClear(s);
        });
      });

      $("clearNotes")?.addEventListener("click", ()=>{
        $("notes").value = "";
        scheduleSave();
      });
      $("clearAll")?.addEventListener("click", ()=>{
        try{
          const keys = [];
          for(let i=0;i<localStorage.length;i++){
            const k = localStorage.key(i);
            if(k && k.startsWith(PREFIX)) keys.push(k);
          }
          keys.forEach(k=>localStorage.removeItem(k));
        }catch(e){}
        resetAll();
        setSaveHint("Alles gelöscht.");
      });

      function updateMonthsOut(){
        $("monthsOut").textContent = String($("months").value || "0");
      }
      $("months")?.addEventListener("input", ()=>{ updateMonthsOut(); scheduleSave(); recalc(true); });

      function getBasket(){
        const b =
          ($("chkMember").checked ? 60 : 0) +
          ($("chkLeadSmall").checked ? 60 : 0) +
          ($("chkLeadPro").checked ? 298 : 0) +
          ($("chkWeekend").checked ? 399 : 0);
        return b;
      }
      function updateBasketOut(){
        $("basketOut").textContent = fmtEUR(getBasket());
      }

      const lastWow = $("lastWow");
      function setWow(msg){
        if(lastWow) lastWow.textContent = msg;
      }

      function animateNumber(el, from, to, fmt){
        const start = performance.now();
        const dur = 520;
        function step(t){
          const p = Math.min(1, (t - start) / dur);
          const eased = 1 - Math.pow(1 - p, 3);
          const v = from + (to - from) * eased;
          el.textContent = fmt(v);
          if(p < 1) requestAnimationFrame(step);
        }
        requestAnimationFrame(step);
      }

      function parseIntText(s){
        const t = String(s).replace(/[^\d\-]/g,"");
        const n = Number(t);
        return Number.isFinite(n) ? n : 0;
      }
      function parseMoney(s){
        const t = String(s).replace(/\./g,"").replace(",",".").replace(/[^\d\.\-]/g,"");
        const n = Number(t);
        return Number.isFinite(n) ? n : 0;
      }

      function setKPI(id, val, isMoney){
        const el = $(id);
        if(!el) return;
        const oldText = el.textContent || "0";
        const oldVal = isMoney ? parseMoney(oldText) : parseIntText(oldText);
        const fmt = isMoney ? (x)=>fmtEUR(x) : (x)=>fmtInt(x);
        animateNumber(el, oldVal, val, fmt);
      }

      // ✅ FIX: Aktive aus dem aktuellen Monat zählen sofort mit (E2/E3 im gleichen Zeitraum sichtbar)
      function calcScenario(){
        const months = clamp(toNum($("months").value), 0, 12);

        const e1Work = clamp(toNum($("e1Work").value), 0, 24);
        const e1PerUnit = clamp(toNum($("e1PerUnit").value), 0, 50);
        const q1 = pct($("e1Active").value);

        const e2Work = clamp(toNum($("e2Work").value), 0, 24);
        const e2PerUnit = clamp(toNum($("e2PerUnit").value), 0, 50);
        const q2 = pct($("e2Active").value);

        const e3Work = clamp(toNum($("e3Work").value), 0, 24);
        const e3PerUnit = clamp(toNum($("e3PerUnit").value), 0, 50);

        const basket = getBasket();

        const r1 = 0.20, r2 = 0.15, r3 = 0.10;

        let sum1=0, sum2=0, sum3=0;
        let prov1=0, prov2=0, prov3=0;

        // Bestand aktiver Werber (kumuliert)
        let activeLvl1 = 0; // erzeugt E2
        let activeLvl2 = 0; // erzeugt E3

        const rows = [];

        for(let m=1; m<=months; m++){
          // Ebene 1
          const new1 = e1Work * e1PerUnit;

          // Aktive aus E1 werden SOFORT Werber (und bleiben es in den Folgemonaten)
          const recruitersLvl1 = activeLvl1 + (new1 * q1);

          // Ebene 2 entsteht aus diesen Werbern
          const new2 = recruitersLvl1 * (e2Work * e2PerUnit);

          // Aktive aus E2 werden SOFORT Werber (und bleiben es)
          const recruitersLvl2 = activeLvl2 + (new2 * q2);

          // Ebene 3 entsteht aus diesen Werbern
          const new3 = recruitersLvl2 * (e3Work * e3PerUnit);

          // Provision (pro Monat auf neue Mitglieder je Ebene)
          const p1 = new1 * basket * r1;
          const p2 = new2 * basket * r2;
          const p3 = new3 * basket * r3;

          sum1 += new1; sum2 += new2; sum3 += new3;
          prov1 += p1; prov2 += p2; prov3 += p3;

          rows.push({ m, new1, new2, new3, basket, p1, p2, p3 });

          // Update der Bestände für den nächsten Monat
          activeLvl1 = recruitersLvl1;
          activeLvl2 = recruitersLvl2;
        }

        return { months, basket, sum1, sum2, sum3, prov1, prov2, prov3, rows };
      }

      function buildTable(rows){
        const tbody = $("tbody");
        tbody.innerHTML = "";
        rows.forEach(r=>{
          const tr = document.createElement("tr");

          const tdM = document.createElement("td"); tdM.textContent = String(r.m); tr.appendChild(tdM);
          const td1 = document.createElement("td"); td1.textContent = fmtInt(r.new1); tr.appendChild(td1);
          const td2 = document.createElement("td"); td2.textContent = fmtInt(r.new2); tr.appendChild(td2);
          const td3 = document.createElement("td"); td3.textContent = fmtInt(r.new3); tr.appendChild(td3);

          const tdB = document.createElement("td"); tdB.className="right"; tdB.textContent = fmtEUR(r.basket); tr.appendChild(tdB);

          const tdP1 = document.createElement("td"); tdP1.className="right"; tdP1.textContent = fmtEUR(r.p1); tr.appendChild(tdP1);
          const tdP2 = document.createElement("td"); tdP2.className="right"; tdP2.textContent = fmtEUR(r.p2); tr.appendChild(tdP2);
          const tdP3 = document.createElement("td"); tdP3.className="right"; tdP3.textContent = fmtEUR(r.p3); tr.appendChild(tdP3);

          tbody.appendChild(tr);
        });
      }

      function updateHowOut(){
        const m = $("months").value;
        const e1w = $("e1Work").value, e1p = $("e1PerUnit").value, q1v = $("e1Active").value;
        const e2w = $("e2Work").value, e2p = $("e2PerUnit").value, q2v = $("e2Active").value;
        const e3w = $("e3Work").value, e3p = $("e3PerUnit").value;

        $("howOut").textContent =
          `${m}M | E1: ${e1w}×${e1p} → aktiv ${q1v}% | E2: ${e2w}×${e2p} → aktiv ${q2v}% | E3: ${e3w}×${e3p}`;
      }

      function recalc(showWow){
        updateMonthsOut();
        updateBasketOut();
        updateHowOut();

        const main = calcScenario();

        const totalNew = main.sum1 + main.sum2 + main.sum3;
        const totalProv = main.prov1 + main.prov2 + main.prov3;

        setKPI("k_new1", main.sum1, false);
        setKPI("k_new2", main.sum2, false);
        setKPI("k_new3", main.sum3, false);
        setKPI("k_newT", totalNew, false);

        setKPI("k_p1", main.prov1, true);
        setKPI("k_p2", main.prov2, true);
        setKPI("k_p3", main.prov3, true);
        setKPI("k_pT", totalProv, true);

        buildTable(main.rows);

        if(showWow){
          if(main.months === 0){
            setWow("Setze Monate → dann wird es sichtbar.");
          }else{
            if(main.sum3 > 0) setWow("Ebene 3 ist aktiv → jetzt wird es greifbar.");
            else if(main.sum2 > 0) setWow("Ebene 2 baut sich auf → Zeit wirkt als Verstärker.");
            else if(main.sum1 > 0) setWow("Ebene 1 steht → der Rest ist Wiederholung + Zeit.");
            else setWow("Setze Annahmen → der Effekt wird sichtbar.");
          }
        }
      }

      $("btnZeroEarnings")?.addEventListener("click", ()=>recalc(true));

      $("btnCopy")?.addEventListener("click", async ()=>{
        const s = readStateFromDom();
        const main = calcScenario();
        const totalNew = main.sum1 + main.sum2 + main.sum3;
        const totalProv = main.prov1 + main.prov2 + main.prov3;

        const lines = [];
        lines.push("Tragfähigkeits-Rechner (3 Ebenen) – OHNE Hebel");
        lines.push("Zeitraum (Monate): " + s.months);
        lines.push("");
        lines.push("Ebene 1: Einheiten/Monat=" + s.e1Work + " | neu/Einheit=" + s.e1PerUnit + " | Aktiv-Quote=" + s.e1Active + "%");
        lines.push("Ebene 2: Einheiten/Monat=" + s.e2Work + " | neu/Einheit=" + s.e2PerUnit + " | Aktiv-Quote=" + s.e2Active + "%");
        lines.push("Ebene 3: Einheiten/Monat=" + s.e3Work + " | neu/Einheit=" + s.e3PerUnit);
        lines.push("");
        lines.push("Bausteine:");
        lines.push("  Mitgliedschaft: " + (s.chkMember ? "ja" : "nein"));
        lines.push("  Kleine Leadmaschine: " + (s.chkLeadSmall ? "ja" : "nein"));
        lines.push("  Profi Leadmaschine: " + (s.chkLeadPro ? "ja" : "nein"));
        lines.push("  Weekend-Setup: " + (s.chkWeekend ? "ja" : "nein"));
        lines.push("  Warenkorb je neues Mitglied: " + fmtEUR(getBasket()));
        lines.push("");
        lines.push("Ergebnis (Provision):");
        lines.push("  Neue Mitglieder E1: " + fmtInt(main.sum1));
        lines.push("  Neue Mitglieder E2: " + fmtInt(main.sum2));
        lines.push("  Neue Mitglieder E3: " + fmtInt(main.sum3));
        lines.push("  Gesamt neue Mitglieder: " + fmtInt(totalNew));
        lines.push("  Provision E1 (20%): " + fmtEUR(main.prov1));
        lines.push("  Provision E2 (15%): " + fmtEUR(main.prov2));
        lines.push("  Provision E3 (10%): " + fmtEUR(main.prov3));
        lines.push("  Gesamt-Provision: " + fmtEUR(totalProv));
        lines.push("");
        lines.push("Hinweis: Simulation zur Einordnung. Keine Abrechnung.");

        const text = lines.join("\n");
        try{
          await navigator.clipboard.writeText(text);
          setSaveHint("Kopiert.");
        }catch(e){
          const ta = document.createElement("textarea");
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try{ document.execCommand("copy"); setSaveHint("Kopiert."); }catch(err){ setSaveHint("Kopieren fehlgeschlagen."); }
          document.body.removeChild(ta);
        }
      });

      $("btnPrint")?.addEventListener("click", ()=>window.print());

      const liveIds = [
        "e1Work","e1PerUnit","e1Active",
        "e2Work","e2PerUnit","e2Active",
        "e3Work","e3PerUnit",
        "chkMember","chkLeadSmall","chkLeadPro","chkWeekend",
        "notes"
      ];
      liveIds.forEach(id=>{
        const el = $(id);
        if(!el) return;
        const evt = (el.tagName === "SELECT" || el.type === "checkbox") ? "change" : "input";
        el.addEventListener(evt, ()=>{
          scheduleSave();
          recalc(true);
        });
      });

      $("langDE")?.addEventListener("click", ()=>{ setLang("de"); recalc(true); });
      $("langEN")?.addEventListener("click", ()=>{ setLang("en"); recalc(true); });

      const savedLang = (()=>{ try{ return localStorage.getItem(KEY_LANG) || "de"; }catch(e){ return "de"; } })();
      setLang(savedLang === "en" ? "en" : "de");

      load();
      updateMonthsOut();
      updateBasketOut();
      updateHowOut();
      recalc(true);
      setSaveHint("Bereit.");

    })();
  </script>
</body>
</html>
