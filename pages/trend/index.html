<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FSA Trendbarometer</title>
  <meta name="description" content="FSA Trendbarometer – Hauptsicht Jahr & Halbjahr (H1/H2). Dashboard mit Charts aus öffentlich zugänglichen Online-Signalen (RSS/Atom), nicht repräsentativ." />
  <style>
    :root{
      --bg:#050814;
      --panel:rgba(15,23,42,.92);
      --panel2:rgba(15,23,42,.82);
      --text:#e9edf3;
      --muted:#97a0ad;
      --gold:#d4af37;
      --gold2:#f1d070;
      --ring:rgba(212,175,55,.25);
      --radius:16px;
      --shadow:0 12px 40px rgba(0,0,0,.55);
      --maxw:1100px;
    }
    html,body{height:100%;}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(212,175,55,.12), transparent 55%),
        radial-gradient(900px 500px at 80% 20%, rgba(120,180,255,.10), transparent 60%),
        linear-gradient(180deg, #020617 0%, #050814 60%, #020617 100%);
    }
    .wrap{max-width:var(--maxw); margin:0 auto; padding:28px 18px 44px;}
    .topbar{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; margin-bottom:14px;}
    .brand{display:flex; align-items:center; gap:10px;}
    .badge{width:34px;height:34px;border-radius:10px;background:rgba(212,175,55,.10); border:1px solid var(--ring); display:grid; place-items:center; box-shadow:var(--shadow);}
    .badge svg{width:18px;height:18px; fill:var(--gold2);}
    h1{font-size:22px; margin:0; letter-spacing:.2px;}
    .sub{color:var(--muted); font-size:13px; margin-top:4px;}
    .btnrow{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
    .btn{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px; border-radius:999px;
      background:rgba(15,23,42,.65);
      border:1px solid rgba(212,175,55,.25);
      color:var(--text); text-decoration:none;
      box-shadow:0 8px 22px rgba(0,0,0,.35);
      cursor:pointer;
    }
    .btn .dot{width:10px;height:10px;border-radius:50%; background:rgba(212,175,55,.9); box-shadow:0 0 0 4px rgba(212,175,55,.12);}
    .grid{display:grid; grid-template-columns:1.15fr .85fr; gap:14px; align-items:start;}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr;} }
    .card{
      background:linear-gradient(180deg, rgba(15,23,42,.92), rgba(15,23,42,.82));
      border:1px solid rgba(212,175,55,.18);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
    }
    .hr{height:1px; background:rgba(212,175,55,.10); margin:14px 0;}
    .note{font-size:12px; color:var(--muted); line-height:1.35;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="badge" aria-hidden="true">
          <svg viewBox="0 0 24 24"><path d="M12 2l2.2 6.3H21l-5.4 3.9 2.1 6.4L12 15.7 6.3 18.6l2.1-6.4L3 8.3h6.8L12 2z"/></svg>
        </div>
        <div>
          <h1 data-i18n data-de="FSA Trendbarometer" data-en="FSA Trend Barometer"></h1>
          <div class="sub" data-i18n
            data-de="Hauptsicht: Jahr & Halbjahr (H1/H2). Monate bleiben als Detail-Archiv."
            data-en="Primary view: year & half-year (H1/H2). Months remain as detail archive."></div>
        </div>
      </div>
      <div class="btnrow">
        <a class="btn" href="./dashboard.html"><span class="dot"></span><span data-i18n data-de="Dashboard" data-en="Dashboard"></span></a>
        <a class="btn" href="./chronologie.html"><span class="dot"></span><span data-i18n data-de="Chronologie" data-en="Chronology"></span></a>
        <button class="btn" id="langBtn" type="button"><span class="dot"></span>DE</button>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <div class="note" data-i18n
          data-de="Was es ist: reproduzierbares Online-Signal-Barometer (RSS/Atom)."
          data-en="What it is: reproducible online-signal barometer (RSS/Atom)."></div>
        <div class="hr"></div>
        <div class="note" data-i18n
          data-de="Wichtig: Das ist keine repräsentative 'Volksmeinung'. Es zeigt nur das, was die ausgewählten Quellen im Zeitraum publizieren – inkl. transparenter Quellen-Qualität (OK/Dropped/Failed)."
          data-en="Important: this is not a representative 'public opinion'. It only reflects what selected sources publish in the period—plus transparent source quality (OK/Dropped/Failed)."></div>
        <div class="hr"></div>
        <div id="yearsBox" class="note" data-i18n data-de="Lade verfügbare Jahre..." data-en="Loading available years..."></div>
      </div>

      <div class="card">
        <div class="note" data-i18n data-de="Schnellstart" data-en="Quick start"></div>
        <div class="hr"></div>
        <div class="note" data-i18n
          data-de="1) Öffne Dashboard → wähle Jahr → H1/H2 → Charts & Tabellen."
          data-en="1) Open Dashboard → select year → H1/H2 → charts & tables."></div>
        <div class="note" style="margin-top:10px;" data-i18n
          data-de="2) Wenn du mehr Inhalte willst: Quellen stabilisieren (RSS mit Datum) – dann füllt sich das Barometer automatisch."
          data-en="2) If you want more content: stabilize sources (RSS with dates)—then the barometer fills automatically."></div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      let lang = localStorage.getItem('fsa_trend_lang') || 'de';
      const langBtn = document.getElementById('langBtn');

      function applyLang(){
        document.querySelectorAll('[data-i18n]').forEach(el=>{
          const de = el.getAttribute('data-de') || '';
          const en = el.getAttribute('data-en') || '';
          el.textContent = (lang === 'en') ? en : de;
        });
        langBtn.textContent = (lang === 'en') ? 'EN' : 'DE';
      }

      langBtn.addEventListener('click', ()=>{
        lang = (lang === 'de') ? 'en' : 'de';
        localStorage.setItem('fsa_trend_lang', lang);
        applyLang();
        renderYears(); // refresh link labels
      });

      async function renderYears(){
        const box = document.getElementById('yearsBox');
        try{
          const r = await fetch('./data/manifest.json?nocache=' + Date.now());
          if(!r.ok) throw new Error('manifest');
          const mf = await r.json();
          const years = Object.keys(mf.years||{}).sort().reverse();
          if(!years.length){
            box.textContent = (lang==='en') ? 'No years available yet.' : 'Noch keine Jahre verfügbar.';
            return;
          }
          let html = '';
          years.forEach(y=>{
            const info = mf.years[y];
            const half = (info.halfyears||[]).slice().sort();
            html += `<div style="margin:10px 0; padding:12px; border:1px solid rgba(212,175,55,.14); border-radius:14px; background:rgba(2,6,23,.25);">
              <div style="font-weight:700; color:rgba(233,237,243,.92); margin-bottom:6px;">${y}</div>
              <div style="display:flex; gap:10px; flex-wrap:wrap;">
                <a class="btn" href="./${y}.html?nocache=${Date.now()}"><span class="dot"></span>${(lang==='en')?'Year overview':'Jahresübersicht'}</a>
                ${half.map(h=>{
                  const tag = h.endsWith('H1') ? ((lang==='en')?'Half-year H1':'Halbjahr H1') : ((lang==='en')?'Half-year H2':'Halbjahr H2');
                  return `<a class="btn" href="./${y}-${h.endsWith('H1')?'h1':'h2'}.html?nocache=${Date.now()}"><span class="dot"></span>${tag}</a>`;
                }).join('')}
              </div>
              <div style="margin-top:8px; color:rgba(151,160,173,.95); font-size:12px;">
                ${(lang==='en'?'Months in archive: ':'Monate im Archiv: ')}${(info.months||[]).length}
              </div>
            </div>`;
          });
          box.innerHTML = html;
        }catch(e){
          box.textContent = (lang==='en') ? 'Could not load manifest.' : 'Manifest konnte nicht geladen werden.';
        }
      }

      applyLang();
      renderYears();
    })();
  </script>
</body>
</html>
