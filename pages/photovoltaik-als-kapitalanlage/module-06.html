<!doctype html>
<!--
  FSA • Premium Kurs (Workbook)
  Kurs: Photovoltaik als Kapitalanlage
  Modul 06: Kostenstruktur & Langfristigkeit

  GitHub-Pfad: lp-anfang/pages/photovoltaik-als-kapitalanlage/module-06.html
  Commit-Message: photovoltaik-als-kapitalanlage – Modul 06 (Kostenstruktur & Langfristigkeit) Premium: Kosten-Wow-Grafik, alle Felder als Auswahl, OPEX/CAPEX-Check, Risiko-Kosten, Print, LocalStorage (DE/EN)
  Testlink (nocache): https://adler-fsa.github.io/lp-anfang/pages/photovoltaik-als-kapitalanlage/module-06.html?nocache=__TS__
-->
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Modul 06 – Kostenstruktur & Langfristigkeit • Photovoltaik als Kapitalanlage</title>
  <meta name="description" content="Modul 06 (DE/EN): Kostenstruktur & Langfristigkeit einer PV-Anlage – CAPEX/OPEX, Ersatzteile, Wartung, Versicherung, Rücklagen. Premium Workbook mit Auswahlfeldern, Kosten-Check, Wow-Grafik, Print und LocalStorage." />
  <meta name="robots" content="index,follow" />

  <style>
    :root{
      --bg:#ffffff;
      --ink:#0f1114;
      --muted:#47505f;

      --line: rgba(15,17,20,.12);
      --line2: rgba(15,17,20,.18);

      --gold:#c8a63a;
      --gold2:#e0c466;

      --accent:#0b7d5c;
      --accent2:#1aa57a;

      --danger:#c52646;
      --dangerSoft: rgba(197,38,70,.12);

      --shadow: 0 14px 34px rgba(0,0,0,.10);
      --shadow2: 0 26px 70px rgba(0,0,0,.12);

      --radius:18px;
      --max: 1140px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--ink);
      background:
        radial-gradient(1200px 720px at 10% 8%, rgba(200,166,58,.18), transparent 58%),
        radial-gradient(1050px 720px at 88% 14%, rgba(11,125,92,.14), transparent 58%),
        radial-gradient(920px 640px at 52% 96%, rgba(197,38,70,.10), transparent 60%),
        linear-gradient(180deg, #ffffff 0%, #fbfbfc 45%, #ffffff 100%);
      overflow-x:hidden;
    }

    .spark{
      position:fixed;
      inset:-30vh -30vw auto -30vw;
      height:60vh;
      pointer-events:none;
      z-index:0;
      filter: blur(18px);
      opacity:.55;
      background:
        radial-gradient(closest-side at 18% 35%, rgba(200,166,58,.30), transparent 65%),
        radial-gradient(closest-side at 68% 28%, rgba(11,125,92,.24), transparent 65%),
        radial-gradient(closest-side at 48% 85%, rgba(197,38,70,.16), transparent 70%);
      transform: translate3d(0,0,0);
      animation: floaty 10s ease-in-out infinite;
    }
    @keyframes floaty{
      0%{ transform: translate3d(0px, 0px, 0px) scale(1); }
      50%{ transform: translate3d(12px, 10px, 0px) scale(1.02); }
      100%{ transform: translate3d(0px, 0px, 0px) scale(1); }
    }
    @media (prefers-reduced-motion: reduce){
      .spark{ animation:none; }
      .shine:before{ animation:none !important; }
    }

    .wrap{
      position:relative;
      z-index:1;
      max-width:var(--max);
      margin:0 auto;
      padding: 22px 18px 84px;
    }

    .topbar{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
      margin-bottom:14px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      padding: 10px 12px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.78));
      border-radius: 999px;
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    .brand:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(520px 180px at 12% 30%, rgba(200,166,58,.16), transparent 64%),
        radial-gradient(520px 180px at 84% 20%, rgba(11,125,92,.12), transparent 64%);
      pointer-events:none;
    }
    .brand > *{ position:relative; }
    .brand svg{ width:22px; height:22px; flex:0 0 auto; }
    .brand .t1{ font-weight:1000; letter-spacing:.2px; line-height:1.1; }
    .brand .t2{ font-size:12px; color:var(--muted); margin-top:2px; line-height:1.1; }

    .premiumTag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:6px;
      font-size:11px;
      font-weight:1000;
      letter-spacing:.35px;
      padding: 4px 8px;
      border-radius: 999px;
      border:1px solid rgba(200,166,58,.35);
      background: rgba(200,166,58,.10);
      color: rgba(15,17,20,.86);
      width: fit-content;
    }
    .premiumTag .dot{
      width:8px; height:8px; border-radius:50%;
      background: linear-gradient(180deg, var(--gold2), var(--gold));
      box-shadow: 0 0 10px rgba(200,166,58,.35);
    }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
    }

    .lang{
      display:flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.72));
      border-radius: 12px;
      box-shadow: var(--shadow);
    }
    .lang label{
      font-size:12px;
      color:var(--muted);
      font-weight:900;
    }
    .lang select{
      background: rgba(255,255,255,.92);
      border:1px solid rgba(15,17,20,.18);
      color: var(--ink);
      border-radius:10px;
      padding:8px 10px;
      font-weight:1000;
      outline:none;
    }

    .btn{
      appearance:none;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.94), rgba(255,255,255,.76));
      color:var(--ink);
      padding:10px 12px;
      border-radius: 12px;
      font-weight:1000;
      cursor:pointer;
      box-shadow: var(--shadow);
      display:inline-flex;
      align-items:center;
      gap:10px;
      text-decoration:none;
      user-select:none;
      transition: transform .10s ease, border-color .14s ease, box-shadow .14s ease;
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(200,166,58,.45); box-shadow: var(--shadow2); }
    .btn:active{ transform: translateY(0px); }
    .btn .dot{
      width:10px; height:10px; border-radius:50%;
      background: linear-gradient(180deg, var(--gold2), var(--gold));
      box-shadow: 0 0 12px rgba(200,166,58,.45);
    }
    .btn.secondary .dot{
      background: linear-gradient(180deg, var(--accent2), var(--accent));
      box-shadow: 0 0 12px rgba(11,125,92,.38);
    }
    .btn.danger .dot{
      background: linear-gradient(180deg, rgba(197,38,70,.9), rgba(197,38,70,1));
      box-shadow: 0 0 12px rgba(197,38,70,.30);
    }

    .hero{
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow2);
      padding: 18px 18px 16px;
      margin-bottom: 14px;
      position:relative;
      overflow:hidden;
      background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.82));
    }
    .hero:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(840px 280px at 14% 16%, rgba(200,166,58,.20), transparent 65%),
        radial-gradient(740px 260px at 86% 18%, rgba(11,125,92,.14), transparent 65%),
        radial-gradient(720px 260px at 40% 98%, rgba(197,38,70,.10), transparent 70%);
      pointer-events:none;
    }
    .hero:after{
      content:"";
      position:absolute;
      inset:0;
      border-radius: var(--radius);
      pointer-events:none;
      background: linear-gradient(90deg, rgba(200,166,58,.22), transparent 18%, transparent 82%, rgba(200,166,58,.18));
      mix-blend-mode: multiply;
      opacity:.45;
    }
    .hero > *{ position:relative; }

    h1{ margin:0 0 10px; font-size: 28px; letter-spacing:.2px; line-height:1.2; }
    .sub{ margin:0; color: var(--muted); line-height:1.75; font-size:14.8px; max-width: 98ch; }

    .card{
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px 16px 14px;
      margin-top: 12px;
      position:relative;
      overflow:hidden;
      background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.84));
    }
    .card:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(620px 180px at 16% 8%, rgba(200,166,58,.12), transparent 65%),
        radial-gradient(620px 180px at 84% 12%, rgba(11,125,92,.10), transparent 65%);
      pointer-events:none;
      opacity:.75;
    }
    .card > *{ position:relative; }

    .card h2{ margin:0 0 10px; font-size:16px; letter-spacing:.2px; }
    .card p{ margin:0 0 10px; color: var(--muted); font-size:14.2px; line-height:1.8; }

    .notice{
      border:1px solid rgba(200,166,58,.38);
      background: rgba(200,166,58,.10);
      border-radius: 14px;
      padding: 12px 12px;
      color: rgba(15,17,20,.92);
      line-height:1.75;
      font-size:13.6px;
      margin-top:12px;
      position:relative;
      overflow:hidden;
    }
    .notice:before{
      content:"";
      position:absolute;
      inset:-2px;
      background: radial-gradient(520px 160px at 18% 50%, rgba(200,166,58,.18), transparent 70%);
      pointer-events:none;
    }
    .notice > *{ position:relative; }
    .notice strong{ color: #7a5c00; }

    /* Glossar */
    .glossWrap{ margin-top:10px; }
    details.gloss{
      border:1px solid rgba(15,17,20,.12);
      border-radius: 14px;
      background: rgba(255,255,255,.72);
      box-shadow: 0 10px 22px rgba(0,0,0,.05);
      padding: 10px 12px;
      margin: 10px 0;
      overflow:hidden;
    }
    details.gloss[open]{
      border-color: rgba(11,125,92,.22);
      box-shadow: 0 18px 40px rgba(0,0,0,.08);
    }
    details.gloss summary{
      cursor:pointer;
      list-style:none;
      font-weight:1000;
      color: rgba(15,17,20,.92);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      outline:none;
    }
    details.gloss summary::-webkit-details-marker{ display:none; }
    .glossBadge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:11px;
      font-weight:1000;
      padding: 4px 8px;
      border-radius:999px;
      border:1px solid rgba(200,166,58,.30);
      background: rgba(200,166,58,.10);
      color: rgba(15,17,20,.82);
      flex:0 0 auto;
    }
    .glossBadge .dot{
      width:8px; height:8px; border-radius:50%;
      background: linear-gradient(180deg, var(--gold2), var(--gold));
      box-shadow: 0 0 10px rgba(200,166,58,.28);
    }
    .glossBody{
      margin-top:10px;
      color: var(--muted);
      line-height:1.8;
      font-size: 13.8px;
    }

    /* Auswahl-Felder */
    .form{ display:flex; flex-direction:column; gap:10px; margin-top:10px; }
    .field{
      border:1px solid rgba(15,17,20,.12);
      border-radius: 14px;
      background: rgba(255,255,255,.72);
      box-shadow: 0 10px 22px rgba(0,0,0,.05);
      padding: 12px 12px;
      position:relative;
      overflow:hidden;
    }
    .field:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(520px 160px at 10% 40%, rgba(200,166,58,.08), transparent 70%),
        radial-gradient(520px 160px at 90% 30%, rgba(11,125,92,.06), transparent 70%);
      pointer-events:none;
      opacity:.9;
    }
    .field > *{ position:relative; }
    .field .lbl{
      font-weight:1000;
      font-size:13px;
      margin-bottom:6px;
      color: rgba(15,17,20,.92);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .hint{
      font-weight:900;
      font-size:12px;
      color: rgba(71,80,95,.92);
      background: rgba(11,125,92,.08);
      border:1px solid rgba(11,125,92,.18);
      border-radius: 999px;
      padding: 4px 8px;
    }
    select{
      width:100%;
      border:1px solid rgba(15,17,20,.18);
      border-radius: 12px;
      padding: 10px 10px;
      font: inherit;
      background: rgba(255,255,255,.96);
      color: var(--ink);
      outline:none;
      font-weight:900;
    }
    .help{
      margin-top:8px;
      color: rgba(71,80,95,.92);
      font-size:12.8px;
      line-height:1.65;
    }

    /* KPI */
    .kpis{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      margin-top:10px;
    }
    @media (min-width: 720px){
      .kpis{ grid-template-columns: 1fr 1fr 1fr 1fr; }
    }
    .kpi{
      border:1px solid rgba(15,17,20,.12);
      border-radius: 14px;
      background: rgba(255,255,255,.72);
      box-shadow: 0 12px 26px rgba(0,0,0,.06);
      padding: 12px 12px;
      position:relative;
      overflow:hidden;
      min-height: 82px;
    }
    .kpi:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(520px 160px at 18% 50%, rgba(200,166,58,.10), transparent 70%),
        radial-gradient(520px 160px at 82% 40%, rgba(11,125,92,.08), transparent 70%);
      pointer-events:none;
      opacity:.9;
    }
    .kpi > *{ position:relative; }
    .kpi .t{ font-size:12px; font-weight:1000; color: rgba(71,80,95,.92); }
    .kpi .v{ font-size:18px; font-weight:1100; margin-top:4px; color: rgba(15,17,20,.94); }
    .kpi .s{ font-size:12px; margin-top:2px; color: rgba(71,80,95,.88); line-height:1.35; }

    /* Wow Kosten-Grafik */
    .viz{
      border:1px solid rgba(15,17,20,.12);
      border-radius: 16px;
      background: rgba(255,255,255,.72);
      box-shadow: 0 14px 34px rgba(0,0,0,.08);
      padding: 12px 12px;
      margin-top: 10px;
      overflow:hidden;
      position:relative;
    }
    .viz.shine:before{
      content:"";
      position:absolute;
      inset:-60% -40%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.55), transparent);
      transform: rotate(18deg);
      opacity:.28;
      animation: sheen 6.5s ease-in-out infinite;
      pointer-events:none;
    }
    @keyframes sheen{
      0%{ transform: translateX(-30%) rotate(18deg); opacity:.12; }
      50%{ transform: translateX(18%) rotate(18deg); opacity:.32; }
      100%{ transform: translateX(60%) rotate(18deg); opacity:.12; }
    }
    .vizTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:10px;
    }
    .vizTop .title{ font-weight:1100; color: rgba(15,17,20,.94); }
    .vizTop .note{
      font-size:12px;
      font-weight:900;
      color: rgba(71,80,95,.92);
      background: rgba(200,166,58,.10);
      border:1px solid rgba(200,166,58,.22);
      border-radius: 999px;
      padding: 4px 8px;
      width: fit-content;
    }
    .vizFrame{
      border:1px solid rgba(15,17,20,.10);
      border-radius: 16px;
      background: rgba(255,255,255,.92);
      padding: 10px;
      overflow:hidden;
      box-shadow: inset 0 0 0 1px rgba(200,166,58,.06);
    }
    .viz svg{ width:100%; height:auto; display:block; }

    /* Checkboxes */
    .checks{ display:flex; flex-direction:column; gap:8px; margin-top:10px; }
    .chk{
      display:flex;
      gap:10px;
      align-items:flex-start;
      border:1px solid rgba(15,17,20,.12);
      background: rgba(255,255,255,.72);
      border-radius: 14px;
      padding: 10px 12px;
      box-shadow: 0 10px 22px rgba(0,0,0,.05);
    }
    .chk input{
      width:18px; height:18px;
      margin-top:2px;
      accent-color: var(--accent);
      flex:0 0 auto;
    }
    .chk .t{ font-weight:1000; color: rgba(15,17,20,.92); line-height:1.4; }
    .chk .d{ margin-top:2px; color: rgba(71,80,95,.92); font-size:12.8px; line-height:1.6; }

    .footer{ margin-top: 16px; color: rgba(71,80,95,.85); font-size: 12px; line-height:1.6; text-align:center; }

    @media print{
      body{ background:#fff !important; color:#000 !important; }
      .spark, .topbar, .actions, .lang, .btn, .footer{ display:none !important; }
      .wrap{ max-width: 820px; padding: 0; }
      .hero, .card, .field, .viz, details.gloss, .chk, .kpi{
        box-shadow:none !important;
        background:#fff !important;
        border:1px solid #bbb !important;
        color:#000 !important;
      }
      .sub, .card p, .glossBody, .help, .chk .d, .kpi .s{ color:#111 !important; }
      .notice{ border:1px solid #999 !important; background:#f7f2df !important; color:#000 !important; }
      details.gloss{ break-inside: avoid; }
      .viz.shine:before{ display:none !important; }
      .hint{ border:1px solid #bbb !important; background:#f2f2f2 !important; color:#000 !important; }
    }
  </style>
</head>

<body>
  <div class="spark" aria-hidden="true"></div>

  <div class="wrap">
    <div class="topbar">
      <div class="brand" aria-label="Kurs">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <defs>
            <linearGradient id="gSunM6" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#c8a63a"/>
              <stop offset="1" stop-color="#e0c466"/>
            </linearGradient>
          </defs>
          <circle cx="12" cy="12" r="5.2" fill="url(#gSunM6)"></circle>
          <g fill="none" stroke="rgba(15,17,20,.75)" stroke-width="1.2" stroke-linecap="round">
            <path d="M12 2.2v2.2M12 19.6v2.2M2.2 12h2.2M19.6 12h2.2"/>
            <path d="M4.6 4.6l1.55 1.55M17.85 17.85l1.55 1.55M19.4 4.6l-1.55 1.55M6.15 17.85L4.6 19.4"/>
          </g>
        </svg>
        <div>
          <div class="t1" data-i18n="brand_title">Premium Kurs</div>
          <div class="t2" data-i18n="brand_sub">Photovoltaik als Kapitalanlage</div>
          <div class="premiumTag" aria-hidden="true">
            <span class="dot"></span>
            <span data-i18n="premium_tag">Modul 06 • Hauptkurs</span>
          </div>
        </div>
      </div>

      <div class="actions">
        <a class="btn" id="toIndex" href="index.html" data-nocache="1" title="Index">
          <span class="dot" aria-hidden="true"></span>
          <span data-i18n="btn_index">Index</span>
        </a>

        <div class="lang" title="Sprache / Language">
          <label for="langSel" data-i18n="lang_label">Sprache</label>
          <select id="langSel" aria-label="Sprache wählen">
            <option value="de">DE</option>
            <option value="en">EN</option>
          </select>
        </div>

        <button class="btn secondary" id="printBtn" type="button" title="Drucken / Print">
          <span class="dot" aria-hidden="true"></span>
          <span data-i18n="btn_print">Drucken</span>
        </button>

        <button class="btn danger" id="resetBtn" type="button" title="Projektakte leeren">
          <span class="dot" aria-hidden="true"></span>
          <span data-i18n="btn_reset">Projektakte leeren</span>
        </button>
      </div>
    </div>

    <div class="hero">
      <h1 data-i18n="h1">Modul 06 – Kostenstruktur & Langfristigkeit</h1>
      <p class="sub" data-i18n="sub">
        Dieses Modul macht Kosten greifbar: einmalige Kosten (Anschaffung) und laufende Kosten (Betrieb).
        Ziel: Du erkennst, ob eine Rendite nur „schön gerechnet“ ist – oder ob die Langfristigkeit realistisch abgedeckt wurde.
      </p>
    </div>

    <div class="card">
      <h2 data-i18n="sec1_title">1) Warum Kosten im PV-Projekt oft unterschätzt werden</h2>
      <p data-i18n="sec1_p1">
        Viele Angebote sprechen über Erlöse, aber nur wenig über Kosten. Genau da entstehen später Enttäuschung und Streit.
        Eine seriöse Betrachtung trennt klar: einmalige Kosten (Start) und laufende Kosten (Jahr für Jahr).
      </p>
      <p data-i18n="sec1_p2">
        Du musst keine Preise auswendig wissen. Du musst wissen, welche Kostenarten existieren – und welche Dokumente/Belege dafür üblich sind.
      </p>

      <div class="notice">
        <strong data-i18n="notice_title">Wichtiger Hinweis:</strong>
        <span data-i18n="notice_text">Keine Anlageberatung, keine Steuer- oder Rechtsberatung. Dieses Modul ist Bildung: Kostenlogik, Rücklagen-Denken, Fragenkatalog.</span>
      </div>
    </div>

    <div class="card">
      <h2 data-i18n="sec2_title">2) Kosten-Landkarte (Wow-Grafik)</h2>
      <p data-i18n="sec2_p1">
        Diese Grafik ist eine Orientierung: Welche Kostenarten typischerweise vorkommen – und warum „Langfristigkeit“ bedeutet,
        dass Rücklagen und Ersatzteile mitgedacht werden.
      </p>

      <div class="viz shine">
        <div class="vizTop">
          <div class="title" data-i18n="viz_title">Kosten-Landkarte (vereinfacht)</div>
          <div class="note" data-i18n="viz_note">Illustration – je Projekt unterschiedlich</div>
        </div>

        <div class="vizFrame">
          <svg viewBox="0 0 1200 520" role="img" aria-label="Kosten Landkarte">
            <defs>
              <linearGradient id="gGold" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0" stop-color="rgba(200,166,58,.28)"/>
                <stop offset="1" stop-color="rgba(200,166,58,.08)"/>
              </linearGradient>
              <linearGradient id="gAcc" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0" stop-color="rgba(11,125,92,.22)"/>
                <stop offset="1" stop-color="rgba(11,125,92,.06)"/>
              </linearGradient>
              <linearGradient id="gMid" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0" stop-color="rgba(15,17,20,.08)"/>
                <stop offset="1" stop-color="rgba(15,17,20,.03)"/>
              </linearGradient>
              <linearGradient id="gDng" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0" stop-color="rgba(197,38,70,.16)"/>
                <stop offset="1" stop-color="rgba(197,38,70,.06)"/>
              </linearGradient>
              <filter id="ds" x="-20%" y="-20%" width="140%" height="140%">
                <feDropShadow dx="0" dy="12" stdDeviation="10" flood-color="rgba(0,0,0,.10)"/>
              </filter>
            </defs>

            <rect x="20" y="20" width="1160" height="480" rx="20" fill="rgba(255,255,255,.96)" stroke="rgba(15,17,20,.12)"/>

            <g filter="url(#ds)">
              <rect x="70" y="80" width="520" height="140" rx="18" fill="url(#gGold)" stroke="rgba(200,166,58,.30)"/>
              <rect x="630" y="80" width="500" height="140" rx="18" fill="url(#gAcc)" stroke="rgba(11,125,92,.26)"/>

              <rect x="70" y="260" width="340" height="170" rx="18" fill="url(#gMid)" stroke="rgba(15,17,20,.14)"/>
              <rect x="430" y="260" width="340" height="170" rx="18" fill="url(#gGold)" stroke="rgba(200,166,58,.30)"/>
              <rect x="790" y="260" width="340" height="170" rx="18" fill="url(#gDng)" stroke="rgba(197,38,70,.22)"/>
            </g>

            <g font-family="system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif">
              <text x="96" y="114" font-size="18" font-weight="900" fill="rgba(15,17,20,.92)">CAPEX (Startkosten)</text>
              <text x="96" y="140" font-size="13.2" font-weight="700" fill="rgba(71,80,95,.95)">Module, Wechselrichter, Montage, Planung</text>
              <text x="96" y="162" font-size="13.2" font-weight="700" fill="rgba(71,80,95,.95)">Netzanschluss / Zähler / Inbetriebnahme</text>
              <text x="96" y="184" font-size="13.2" font-weight="700" fill="rgba(71,80,95,.95)">Finanzierungskosten (falls vorhanden)</text>

              <text x="656" y="114" font-size="18" font-weight="900" fill="rgba(15,17,20,.92)">OPEX (laufende Kosten)</text>
              <text x="656" y="140" font-size="13.2" font-weight="700" fill="rgba(71,80,95,.95)">Wartung, Monitoring, Reinigung (falls nötig)</text>
              <text x="656" y="162" font-size="13.2" font-weight="700" fill="rgba(71,80,95,.95)">Versicherung, Gebühren, Abrechnung</text>
              <text x="656" y="184" font-size="13.2" font-weight="700" fill="rgba(71,80,95,.95)">Rücklagen / Ersatzteile</text>

              <text x="96" y="296" font-size="16" font-weight="900" fill="rgba(15,17,20,.92)">Ersatz & Lebensdauer</text>
              <text x="96" y="320" font-size="13.1" font-weight="700" fill="rgba(71,80,95,.95)">Wechselrichter kann früher fällig werden</text>
              <text x="96" y="342" font-size="13.1" font-weight="700" fill="rgba(71,80,95,.95)">Degradation/Leistungsabfall über Jahre</text>

              <text x="456" y="296" font-size="16" font-weight="900" fill="rgba(15,17,20,.92)">Betrieb & Pflichten</text>
              <text x="456" y="320" font-size="13.1" font-weight="700" fill="rgba(71,80,95,.95)">Wer überwacht Ertrag / Störungen?</text>
              <text x="456" y="342" font-size="13.1" font-weight="700" fill="rgba(71,80,95,.95)">Wer organisiert Reparatur?</text>

              <text x="816" y="296" font-size="16" font-weight="900" fill="rgba(15,17,20,.92)">Kosten-Risiken</text>
              <text x="816" y="320" font-size="13.1" font-weight="700" fill="rgba(71,80,95,.95)">Ungeplante Ausfälle / Lieferzeiten</text>
              <text x="816" y="342" font-size="13.1" font-weight="700" fill="rgba(71,80,95,.95)">Versicherung deckt nicht alles ab</text>

              <text x="70" y="468" font-size="13.8" font-weight="900" fill="rgba(15,17,20,.92)">Merksatz:</text>
              <text x="160" y="468" font-size="13.8" font-weight="700" fill="rgba(71,80,95,.95)">
                Rendite ist erst realistisch, wenn Startkosten, laufende Kosten und Rücklagen sauber berücksichtigt sind.
              </text>
            </g>
          </svg>
        </div>
      </div>

      <div class="glossWrap">
        <details class="gloss">
          <summary>
            <span data-i18n="g1_t">Begriff: CAPEX</span>
            <span class="glossBadge"><span class="dot" aria-hidden="true"></span><span data-i18n="g_badge">Glossar</span></span>
          </summary>
          <div class="glossBody" data-i18n="g1_b">
            CAPEX sind einmalige Investitionskosten am Anfang (z. B. Anschaffung, Montage, Inbetriebnahme). Sie bestimmen,
            wie viel Kapital gebunden ist – und wann sich ein Projekt überhaupt „zurückverdient“.
          </div>
        </details>

        <details class="gloss">
          <summary>
            <span data-i18n="g2_t">Begriff: OPEX</span>
            <span class="glossBadge"><span class="dot" aria-hidden="true"></span><span data-i18n="g_badge">Glossar</span></span>
          </summary>
          <div class="glossBody" data-i18n="g2_b">
            OPEX sind laufende Kosten im Betrieb (z. B. Wartung, Versicherung, Gebühren, Monitoring). Viele Angebote rechnen sie zu klein oder „vergessen“ sie.
            Genau das verzerrt die Rendite.
          </div>
        </details>

        <details class="gloss">
          <summary>
            <span data-i18n="g3_t">Begriff: Rücklage</span>
            <span class="glossBadge"><span class="dot" aria-hidden="true"></span><span data-i18n="g_badge">Glossar</span></span>
          </summary>
          <div class="glossBody" data-i18n="g3_b">
            Rücklagen sind bewusst eingeplante Reserven für Reparaturen, Ersatzteile und ungeplante Ereignisse. Ohne Rücklage kann ein einzelner Defekt
            die Rendite stark drücken – oder Liquiditätsstress auslösen.
          </div>
        </details>
      </div>
    </div>

    <div class="card">
      <h2 data-i18n="sec3_title">3) Kosten-Realitätscheck (alles als Auswahlfelder)</h2>
      <p data-i18n="sec3_p1">
        Wähle aus, wie realistisch und transparent Kosten im Angebot dargestellt sind.
      </p>

      <div class="form">
        <div class="field">
          <div class="lbl">
            <span data-i18n="f1_lbl">Startkosten (CAPEX) sind im Angebot…</span>
            <span class="hint" data-i18n="hint_start">Start</span>
          </div>
          <select data-save="m06_capex">
            <option value="" data-i18n="opt_choose">Bitte wählen…</option>
            <option value="voll" data-i18n="f1_o1">vollständig aufgelistet</option>
            <option value="teil" data-i18n="f1_o2">teilweise aufgelistet</option>
            <option value="unklar" data-i18n="f1_o3">unklar / zusammengefasst</option>
            <option value="keine" data-i18n="f1_o4">nicht nachvollziehbar</option>
          </select>
          <div class="help" data-i18n="f1_help">Achte besonders auf: Montage, Netz/Zähler, Planung, Inbetriebnahme, Finanzierungskosten.</div>
        </div>

        <div class="field">
          <div class="lbl">
            <span data-i18n="f2_lbl">Laufende Kosten (OPEX) sind…</span>
            <span class="hint" data-i18n="hint_year">pro Jahr</span>
          </div>
          <select data-save="m06_opex">
            <option value="" data-i18n="opt_choose">Bitte wählen…</option>
            <option value="klar" data-i18n="f2_o1">klar genannt (inkl. Gebühren/Versicherung)</option>
            <option value="teil" data-i18n="f2_o2">teilweise genannt</option>
            <option value="zu_klein" data-i18n="f2_o3">wirken unrealistisch klein</option>
            <option value="keine" data-i18n="f2_o4">werden gar nicht erwähnt</option>
          </select>
        </div>

        <div class="field">
          <div class="lbl">
            <span data-i18n="f3_lbl">Rücklage/Ersatzteile sind…</span>
            <span class="hint" data-i18n="hint_reserve">Reserve</span>
          </div>
          <select data-save="m06_reserve">
            <option value="" data-i18n="opt_choose">Bitte wählen…</option>
            <option value="eingeplant" data-i18n="f3_o1">eingeplant / erklärt</option>
            <option value="erwähnt" data-i18n="f3_o2">nur erwähnt (ohne Konzept)</option>
            <option value="nicht" data-i18n="f3_o3">nicht erwähnt</option>
          </select>
          <div class="help" data-i18n="f3_help">Frage konkret: Wechselrichter/Monitoring – wer trägt Ersatz/Arbeitszeit?</div>
        </div>

        <div class="field">
          <div class="lbl">
            <span data-i18n="f4_lbl">Wer organisiert Betrieb & Reparatur?</span>
            <span class="hint" data-i18n="hint_ops">Betrieb</span>
          </div>
          <select data-save="m06_ops">
            <option value="" data-i18n="opt_choose">Bitte wählen…</option>
            <option value="klar" data-i18n="f4_o1">klar geregelt (Service/Vertrag)</option>
            <option value="teil" data-i18n="f4_o2">teilweise geregelt</option>
            <option value="unklar" data-i18n="f4_o3">unklar („macht man dann“)</option>
          </select>
        </div>
      </div>
    </div>

    <div class="card">
      <h2 data-i18n="sec4_title">4) Mini-Tool: Kosten-Fokus (ohne echte Preise)</h2>
      <p data-i18n="sec4_p1">
        Dieses Tool ist bewusst einfach. Es soll dir helfen, im Gespräch zu erkennen, ob ein Angebot Kosten „mitdenkt“ oder wegdrückt.
      </p>

      <div class="kpis">
        <div class="kpi">
          <div class="t" data-i18n="k1_t">Kosten-Transparenz</div>
          <div class="v" id="kpiA">–</div>
          <div class="s" data-i18n="k1_s">Wie klar sind CAPEX & OPEX?</div>
        </div>
        <div class="kpi">
          <div class="t" data-i18n="k2_t">Langfristigkeit</div>
          <div class="v" id="kpiB">–</div>
          <div class="s" data-i18n="k2_s">Gibt es Rücklagen/Service?</div>
        </div>
        <div class="kpi">
          <div class="t" data-i18n="k3_t">Risiko-Kosten</div>
          <div class="v" id="kpiC">–</div>
          <div class="s" data-i18n="k3_s">Wie gut sind Risiken bedacht?</div>
        </div>
        <div class="kpi">
          <div class="t" data-i18n="k4_t">Gesamt-Eindruck</div>
          <div class="v" id="kpiD">–</div>
          <div class="s" data-i18n="k4_s">Nur Orientierung (kein Urteil)</div>
        </div>
      </div>

      <div class="notice">
        <strong data-i18n="tool_rule_t">Regel:</strong>
        <span data-i18n="tool_rule_b">Wenn Kosten oder Betrieb unklar bleiben, ist die Entscheidung automatisch „noch nicht reif“.</span>
      </div>
    </div>

    <div class="card">
      <h2 data-i18n="sec5_title">5) Checkliste: Kosten-Fragen, die du stellen solltest</h2>
      <p data-i18n="sec5_p1">Haken setzen, wenn du eine klare Antwort + Beleg bekommen hast.</p>

      <div class="checks">
        <label class="chk">
          <input type="checkbox" data-save-check="m06_c1" />
          <span>
            <div class="t" data-i18n="c1_t">Gibt es eine vollständige Kostenliste?</div>
            <div class="d" data-i18n="c1_d">Einmalig + laufend, inklusive Gebühren/Versicherung.</div>
          </span>
        </label>

        <label class="chk">
          <input type="checkbox" data-save-check="m06_c2" />
          <span>
            <div class="t" data-i18n="c2_t">Ist Service/Reparatur geregelt?</div>
            <div class="d" data-i18n="c2_d">Wer reagiert, in welcher Zeit, zu welchen Kosten?</div>
          </span>
        </label>

        <label class="chk">
          <input type="checkbox" data-save-check="m06_c3" />
          <span>
            <div class="t" data-i18n="c3_t">Gibt es Rücklagen-/Ersatzteilkonzept?</div>
            <div class="d" data-i18n="c3_d">Oder wird so getan, als ob nichts kaputtgeht?</div>
          </span>
        </label>

        <label class="chk">
          <input type="checkbox" data-save-check="m06_c4" />
          <span>
            <div class="t" data-i18n="c4_t">Sind Risiken in der Kalkulation sichtbar?</div>
            <div class="d" data-i18n="c4_d">Z. B. Ausfälle, Abregelung, Preisannahmen, Wartung.</div>
          </span>
        </label>
      </div>
    </div>

    <div class="footer" data-i18n="footer">
      Premium Workbook – Modul 06. Eingaben werden lokal gespeichert und sind druckbar.
    </div>
  </div>

  <script>
    (function(){
      const LS_KEY_LANG = "fsa_pvka_lang";
      const LS_KEY_DATA = "fsa_pvka_project";

      const langSel  = document.getElementById("langSel");
      const printBtn = document.getElementById("printBtn");
      const resetBtn = document.getElementById("resetBtn");

      const kpiA = document.getElementById("kpiA");
      const kpiB = document.getElementById("kpiB");
      const kpiC = document.getElementById("kpiC");
      const kpiD = document.getElementById("kpiD");

      const i18n = {
        de: {
          brand_title:"Premium Kurs",
          brand_sub:"Photovoltaik als Kapitalanlage",
          premium_tag:"Modul 06 • Hauptkurs",
          btn_index:"Index",
          lang_label:"Sprache",
          btn_print:"Drucken",
          btn_reset:"Projektakte leeren",

          h1:"Modul 06 – Kostenstruktur & Langfristigkeit",
          sub:"Dieses Modul macht Kosten greifbar: einmalige Kosten (Anschaffung) und laufende Kosten (Betrieb). Ziel: Du erkennst, ob eine Rendite nur „schön gerechnet“ ist – oder ob die Langfristigkeit realistisch abgedeckt wurde.",

          sec1_title:"1) Warum Kosten im PV-Projekt oft unterschätzt werden",
          sec1_p1:"Viele Angebote sprechen über Erlöse, aber nur wenig über Kosten. Genau da entstehen später Enttäuschung und Streit. Eine seriöse Betrachtung trennt klar: einmalige Kosten (Start) und laufende Kosten (Jahr für Jahr).",
          sec1_p2:"Du musst keine Preise auswendig wissen. Du musst wissen, welche Kostenarten existieren – und welche Dokumente/Belege dafür üblich sind.",
          notice_title:"Wichtiger Hinweis:",
          notice_text:"Keine Anlageberatung, keine Steuer- oder Rechtsberatung. Dieses Modul ist Bildung: Kostenlogik, Rücklagen-Denken, Fragenkatalog.",

          sec2_title:"2) Kosten-Landkarte (Wow-Grafik)",
          sec2_p1:"Diese Grafik ist eine Orientierung: Welche Kostenarten typischerweise vorkommen – und warum „Langfristigkeit“ bedeutet, dass Rücklagen und Ersatzteile mitgedacht werden.",
          viz_title:"Kosten-Landkarte (vereinfacht)",
          viz_note:"Illustration – je Projekt unterschiedlich",

          g_badge:"Glossar",
          g1_t:"Begriff: CAPEX",
          g1_b:"CAPEX sind einmalige Investitionskosten am Anfang (z. B. Anschaffung, Montage, Inbetriebnahme). Sie bestimmen, wie viel Kapital gebunden ist – und wann sich ein Projekt überhaupt „zurückverdient“.",
          g2_t:"Begriff: OPEX",
          g2_b:"OPEX sind laufende Kosten im Betrieb (z. B. Wartung, Versicherung, Gebühren, Monitoring). Viele Angebote rechnen sie zu klein oder „vergessen“ sie. Genau das verzerrt die Rendite.",
          g3_t:"Begriff: Rücklage",
          g3_b:"Rücklagen sind bewusst eingeplante Reserven für Reparaturen, Ersatzteile und ungeplante Ereignisse. Ohne Rücklage kann ein einzelner Defekt die Rendite stark drücken – oder Liquiditätsstress auslösen.",

          sec3_title:"3) Kosten-Realitätscheck (alles als Auswahlfelder)",
          sec3_p1:"Wähle aus, wie realistisch und transparent Kosten im Angebot dargestellt sind.",

          hint_start:"Start",
          hint_year:"pro Jahr",
          hint_reserve:"Reserve",
          hint_ops:"Betrieb",

          opt_choose:"Bitte wählen…",

          f1_lbl:"Startkosten (CAPEX) sind im Angebot…",
          f1_o1:"vollständig aufgelistet",
          f1_o2:"teilweise aufgelistet",
          f1_o3:"unklar / zusammengefasst",
          f1_o4:"nicht nachvollziehbar",
          f1_help:"Achte besonders auf: Montage, Netz/Zähler, Planung, Inbetriebnahme, Finanzierungskosten.",

          f2_lbl:"Laufende Kosten (OPEX) sind…",
          f2_o1:"klar genannt (inkl. Gebühren/Versicherung)",
          f2_o2:"teilweise genannt",
          f2_o3:"wirken unrealistisch klein",
          f2_o4:"werden gar nicht erwähnt",

          f3_lbl:"Rücklage/Ersatzteile sind…",
          f3_o1:"eingeplant / erklärt",
          f3_o2:"nur erwähnt (ohne Konzept)",
          f3_o3:"nicht erwähnt",
          f3_help:"Frage konkret: Wechselrichter/Monitoring – wer trägt Ersatz/Arbeitszeit?",

          f4_lbl:"Wer organisiert Betrieb & Reparatur?",
          f4_o1:"klar geregelt (Service/Vertrag)",
          f4_o2:"teilweise geregelt",
          f4_o3:"unklar („macht man dann“)",

          sec4_title:"4) Mini-Tool: Kosten-Fokus (ohne echte Preise)",
          sec4_p1:"Dieses Tool ist bewusst einfach. Es soll dir helfen, im Gespräch zu erkennen, ob ein Angebot Kosten „mitdenkt“ oder wegdrückt.",

          k1_t:"Kosten-Transparenz",
          k1_s:"Wie klar sind CAPEX & OPEX?",
          k2_t:"Langfristigkeit",
          k2_s:"Gibt es Rücklagen/Service?",
          k3_t:"Risiko-Kosten",
          k3_s:"Wie gut sind Risiken bedacht?",
          k4_t:"Gesamt-Eindruck",
          k4_s:"Nur Orientierung (kein Urteil)",

          tool_rule_t:"Regel:",
          tool_rule_b:"Wenn Kosten oder Betrieb unklar bleiben, ist die Entscheidung automatisch „noch nicht reif“.",

          sec5_title:"5) Checkliste: Kosten-Fragen, die du stellen solltest",
          sec5_p1:"Haken setzen, wenn du eine klare Antwort + Beleg bekommen hast.",

          c1_t:"Gibt es eine vollständige Kostenliste?",
          c1_d:"Einmalig + laufend, inklusive Gebühren/Versicherung.",
          c2_t:"Ist Service/Reparatur geregelt?",
          c2_d:"Wer reagiert, in welcher Zeit, zu welchen Kosten?",
          c3_t:"Gibt es Rücklagen-/Ersatzteilkonzept?",
          c3_d:"Oder wird so getan, als ob nichts kaputtgeht?",
          c4_t:"Sind Risiken in der Kalkulation sichtbar?",
          c4_d:"Z. B. Ausfälle, Abregelung, Preisannahmen, Wartung.",

          footer:"Premium Workbook – Modul 06. Eingaben werden lokal gespeichert und sind druckbar."
        },

        en: {
          brand_title:"Premium course",
          brand_sub:"Photovoltaics as a capital investment",
          premium_tag:"Module 06 • Main course",
          btn_index:"Index",
          lang_label:"Language",
          btn_print:"Print",
          btn_reset:"Clear project file",

          h1:"Module 06 – Cost structure & long-term reality",
          sub:"This module makes costs tangible: one-time costs (purchase) and ongoing costs (operation). Goal: you can spot whether a return is only ‘nicely calculated’—or whether long-term reality is properly covered.",

          sec1_title:"1) Why PV project costs are often underestimated",
          sec1_p1:"Many offers talk about revenues but barely about costs. That’s where disappointment and disputes start later. A serious view separates clearly: one-time start costs and recurring annual costs.",
          sec1_p2:"You don’t need to memorize prices. You need to know which cost types exist—and which documents/proofs are typical.",
          notice_title:"Important notice:",
          notice_text:"No investment advice, no tax or legal advice. This module is education: cost logic, reserve thinking, question list.",

          sec2_title:"2) Cost map (wow graphic)",
          sec2_p1:"This graphic is orientation: typical cost categories—and why ‘long-term’ means reserves and replacements are included.",
          viz_title:"Cost map (simplified)",
          viz_note:"Illustration – varies by project",

          g_badge:"Glossary",
          g1_t:"Term: CAPEX",
          g1_b:"CAPEX are one-time investment costs at the beginning (e.g., purchase, installation, commissioning). They define how much capital is tied up—and when the project can ‘pay back’ at all.",
          g2_t:"Term: OPEX",
          g2_b:"OPEX are ongoing operating costs (e.g., maintenance, insurance, fees, monitoring). Many offers underestimate or ‘forget’ them—distorting returns.",
          g3_t:"Term: Reserve",
          g3_b:"Reserves are planned buffers for repairs, replacements and unexpected events. Without reserves, one defect can heavily reduce returns or create liquidity stress.",

          sec3_title:"3) Cost reality check (selection fields only)",
          sec3_p1:"Choose how realistic and transparent costs are presented in the offer.",

          hint_start:"start",
          hint_year:"per year",
          hint_reserve:"reserve",
          hint_ops:"ops",

          opt_choose:"Please choose…",

          f1_lbl:"Start costs (CAPEX) in the offer are…",
          f1_o1:"fully itemized",
          f1_o2:"partly itemized",
          f1_o3:"unclear / bundled",
          f1_o4:"not traceable",
          f1_help:"Pay attention to: installation, grid/metering, planning, commissioning, financing costs.",

          f2_lbl:"Ongoing costs (OPEX) are…",
          f2_o1:"clearly stated (incl. fees/insurance)",
          f2_o2:"partly stated",
          f2_o3:"seem unrealistically low",
          f2_o4:"not mentioned at all",

          f3_lbl:"Reserves/replacements are…",
          f3_o1:"planned / explained",
          f3_o2:"only mentioned (no concept)",
          f3_o3:"not mentioned",
          f3_help:"Ask specifically: inverter/monitoring—who pays parts and labor?",

          f4_lbl:"Who manages operation & repairs?",
          f4_o1:"clearly defined (service/contract)",
          f4_o2:"partly defined",
          f4_o3:"unclear (‘we’ll see later’)",

          sec4_title:"4) Mini tool: cost focus (no real prices)",
          sec4_p1:"This tool is intentionally simple. It helps you see in a meeting whether an offer includes costs—or pushes them aside.",

          k1_t:"Cost transparency",
          k1_s:"How clear are CAPEX & OPEX?",
          k2_t:"Long-term",
          k2_s:"Are reserves/service included?",
          k3_t:"Risk costs",
          k3_s:"How well are risks considered?",
          k4_t:"Overall impression",
          k4_s:"Orientation only (no verdict)",

          tool_rule_t:"Rule:",
          tool_rule_b:"If costs or operations remain unclear, the decision is automatically ‘not ready yet’.",

          sec5_title:"5) Checklist: cost questions you should ask",
          sec5_p1:"Tick only if you got a clear answer + proof.",

          c1_t:"Is there a complete cost list?",
          c1_d:"One-time + ongoing, including fees/insurance.",
          c2_t:"Is service/repair defined?",
          c2_d:"Who reacts, in what time, at what cost?",
          c3_t:"Is there a reserve/replacement concept?",
          c3_d:"Or is it treated as if nothing ever breaks?",
          c4_t:"Are risks visible in the calculation?",
          c4_d:"E.g., outages, curtailment, price assumptions, maintenance.",

          footer:"Premium workbook – Module 06. Inputs are stored locally and printable."
        }
      };

      function getData(){
        try{
          const raw = localStorage.getItem(LS_KEY_DATA);
          const obj = raw ? JSON.parse(raw) : {};
          return (obj && typeof obj === "object") ? obj : {};
        }catch(e){ return {}; }
      }
      function setData(obj){
        localStorage.setItem(LS_KEY_DATA, JSON.stringify(obj));
      }

      function applyI18n(lang){
        document.documentElement.lang = lang;
        document.querySelectorAll("[data-i18n]").forEach(el=>{
          const k = el.getAttribute("data-i18n");
          const txt = (i18n[lang] && i18n[lang][k] !== undefined) ? i18n[lang][k] : null;
          if(txt !== null) el.textContent = txt;
        });
        document.querySelectorAll("option[data-i18n]").forEach(opt=>{
          const k = opt.getAttribute("data-i18n");
          const txt = (i18n[lang] && i18n[lang][k] !== undefined) ? i18n[lang][k] : null;
          if(txt !== null) opt.textContent = txt;
        });
      }

      function loadLang(){
        const saved = localStorage.getItem(LS_KEY_LANG);
        return saved === "en" ? "en" : "de";
      }
      function saveLang(lang){
        localStorage.setItem(LS_KEY_LANG, lang);
      }

      function wireFields(){
        const data = getData();

        document.querySelectorAll("select[data-save]").forEach(sel=>{
          const k = sel.getAttribute("data-save");
          if(data[k] !== undefined) sel.value = data[k];
          sel.addEventListener("change", ()=>{
            const d = getData();
            d[k] = sel.value;
            setData(d);
            updateKPIs();
          });
        });

        document.querySelectorAll("input[type='checkbox'][data-save-check]").forEach(chk=>{
          const k = chk.getAttribute("data-save-check");
          if(data[k] !== undefined) chk.checked = !!data[k];
          chk.addEventListener("change", ()=>{
            const d = getData();
            d[k] = chk.checked;
            setData(d);
            updateKPIs();
          });
        });
      }

      function scoreMap(){
        // Conservative scoring: only based on selections + checkboxes
        const d = getData();

        const capex = d.m06_capex || "";
        const opex  = d.m06_opex  || "";
        const resv  = d.m06_reserve || "";
        const ops   = d.m06_ops || "";

        let a = 0; // transparency
        a += (capex === "voll") ? 2 : (capex === "teil") ? 1 : (capex === "unklar") ? 0 : -1;
        a += (opex  === "klar") ? 2 : (opex  === "teil") ? 1 : (opex  === "zu_klein") ? 0 : -1;
        // clamp
        a = Math.max(-2, Math.min(4, a));

        let b = 0; // long-term
        b += (resv === "eingeplant") ? 2 : (resv === "erwähnt") ? 1 : 0;
        b += (ops  === "klar") ? 2 : (ops  === "teil") ? 1 : 0;
        b = Math.max(0, Math.min(4, b));

        let c = 0; // risk costs via checklist
        const riskChecks = ["m06_c2","m06_c3","m06_c4"];
        riskChecks.forEach(k => { if(d[k]) c += 1; });
        // 0..3
        const fullCostList = !!d.m06_c1;
        if(fullCostList) c += 1; // makes risk view more reliable
        // 0..4
        c = Math.max(0, Math.min(4, c));

        let dTot = a + b + c; // range roughly 0..12 but can be negative if awful
        dTot = Math.max(-2, Math.min(12, dTot));

        return {a,b,c,dTot};
      }

      function labelFromScore(lang, score, max, kind){
        // kind: "pos" or "mix"
        const pct = max <= 0 ? 0 : (score / max);
        if(kind === "mix"){
          if(score <= 0) return lang === "en" ? "weak" : "schwach";
          if(pct < 0.5) return lang === "en" ? "okay" : "ok";
          if(pct < 0.85) return lang === "en" ? "good" : "gut";
          return lang === "en" ? "very good" : "sehr gut";
        }
        // positive
        if(pct < 0.25) return lang === "en" ? "low" : "niedrig";
        if(pct < 0.55) return lang === "en" ? "medium" : "mittel";
        if(pct < 0.85) return lang === "en" ? "high" : "hoch";
        return lang === "en" ? "very high" : "sehr hoch";
      }

      function updateKPIs(){
        const lang = (langSel.value === "en") ? "en" : "de";
        const s = scoreMap();

        kpiA.textContent = labelFromScore(lang, s.a + 2, 6, "mix"); // shift to avoid negatives
        kpiB.textContent = labelFromScore(lang, s.b, 4, "pos");
        kpiC.textContent = labelFromScore(lang, s.c, 4, "pos");

        // overall: use dTot
        let overall;
        if(s.dTot <= 2) overall = (lang==="en") ? "caution" : "Vorsicht";
        else if(s.dTot <= 6) overall = (lang==="en") ? "needs clarification" : "klärungsbedürftig";
        else if(s.dTot <= 9) overall = (lang==="en") ? "solid" : "solide";
        else overall = (lang==="en") ? "very solid" : "sehr solide";
        kpiD.textContent = overall;
      }

      // Buttons
      printBtn.addEventListener("click", ()=> window.print());
      resetBtn.addEventListener("click", ()=>{
        const lang = langSel.value === "en" ? "en" : "de";
        const ok = confirm(lang === "en"
          ? "Clear all saved project inputs for this course?"
          : "Alle gespeicherten Eingaben für diesen Kurs wirklich löschen?"
        );
        if(!ok) return;
        localStorage.removeItem(LS_KEY_DATA);
        location.reload();
      });

      // nocache links
      (function addNoCache(){
        const ts = Date.now();
        document.querySelectorAll('a[data-nocache="1"]').forEach(link=>{
          const href = link.getAttribute("href") || "";
          const url = new URL(href, location.href);
          url.searchParams.set("nocache", String(ts));
          link.setAttribute("href", url.pathname.split("/").pop() + "?" + url.searchParams.toString());
        });
      })();

      // Init
      const lang = loadLang();
      langSel.value = lang;
      applyI18n(lang);
      wireFields();
      updateKPIs();

      langSel.addEventListener("change", ()=>{
        const l = langSel.value === "en" ? "en" : "de";
        saveLang(l);
        applyI18n(l);
        updateKPIs();
      });
    })();
  </script>
</body>
</html>
