// â–‘â–‘ Baustein 03 (Kurs 4) â€“ Network & Mentorenschaft â€“ DE/EN, autonom â–‘â–‘
// Identische Logik/Optik wie Kurs 2/3. Nur Inhalte (Texte) sind neu.
// Zentrierter Titel, Slideshow, Farbverlauf-Fortschrittsbalken, Auswertung nur der Fehler.

window.block03_course_4 = {
  de: {
    title: "ðŸŒ Grundkurs 4 â€“ Network & Mentorenschaft",
    btn: { next: "NÃ¤chste Frage", result: "Zum Ergebnis", again: "Weiter" },
    labels: { q: "Frage", of: "von", done: "âœ… Kurs abgeschlossen" },
    reviewTitle: "Auswertung â€“ Deine Lernpunkte",
    reviewEmpty: "Stark â€“ keine Fehler! Du fÃ¼hrst mit Klarheit, Vertrauen und Vorbild.",
    questions: [
      {
        q: "Was ist das Fundament eines stabilen Netzwerks?",
        a: [
          { text: "MÃ¶glichst viele neue Kontakte in kurzer Zeit.", correct: false },
          { text: "Vertrauen, gemeinsame Werte und ehrliche Kommunikation.", correct: true },
          { text: "Permanente AktivitÃ¤t in sozialen Medien.", correct: false }
        ],
        mentor: {
          correct: "Genau â€” stabile Beziehungen entstehen durch Vertrauen und Werte, nicht durch Geschwindigkeit.",
          wrong:   "Schnelligkeit ersetzt keine Tiefe. Beziehungen wachsen durch Ehrlichkeit, nicht durch Anzahl."
        }
      },
      {
        q: "Warum ist ZuhÃ¶ren fÃ¼r einen Mentor wichtiger als Reden?",
        a: [
          { text: "Weil echtes VerstÃ¤ndnis erst entsteht, wenn man die Perspektive des anderen wirklich kennt.", correct: true },
          { text: "Weil Reden zu viel Energie kostet.", correct: false },
          { text: "Weil ZuhÃ¶ren automatisch AutoritÃ¤t verleiht.", correct: false }
        ],
        mentor: {
          correct: "Richtig â€” wer versteht, kann fÃ¼hren. ZuhÃ¶ren ist die BrÃ¼cke zwischen Wissen und Vertrauen.",
          wrong:   "FÃ¼hren beginnt beim ZuhÃ¶ren. Wer nur redet, inspiriert nicht."
        }
      },
      {
        q: "Was unterscheidet einen Sponsor von einem echten Mentor?",
        a: [
          { text: "Ein Mentor gibt nur finanzielle UnterstÃ¼tzung.", correct: false },
          { text: "Ein Sponsor hilft, das System zu verstehen.", correct: false },
          { text: "Ein Mentor begleitet fachlich und menschlich, nicht nur mit Geld oder Links.", correct: true }
        ],
        mentor: {
          correct: "Sehr gut â€” Mentoren teilen Erfahrung, nicht nur Strukturen. Sie fÃ¶rdern Menschen, nicht Zahlen.",
          wrong:   "Ein Sponsor teilt Tools. Ein Mentor teilt Haltung und Verantwortung."
        }
      },
      {
        q: "Wie entsteht langfristige Motivation im Team?",
        a: [
          { text: "Durch Druck und Kontrolle von oben.", correct: false },
          { text: "Durch Sinn, gemeinsame Ziele und gegenseitige Anerkennung.", correct: true },
          { text: "Durch tÃ¤gliche Gewinnversprechen.", correct: false }
        ],
        mentor: {
          correct: "Richtig â€” Motivation wÃ¤chst aus Sinn und ZugehÃ¶rigkeit, nicht aus Kontrolle.",
          wrong:   "Echte Energie entsteht nicht durch Druck, sondern durch geteilte Ziele und Anerkennung."
        }
      },
      {
        q: "Warum ist es wichtig, dass ein Mentor selbst Verantwortung lebt?",
        a: [
          { text: "Weil Vorbildverhalten mehr prÃ¤gt als Worte.", correct: true },
          { text: "Weil Verantwortung nur die Struktur stÃ¤rkt.", correct: false },
          { text: "Weil sonst kein Vertrauen in Technik entsteht.", correct: false }
        ],
        mentor: {
          correct: "Exakt â€” AuthentizitÃ¤t ist FÃ¼hrung. Menschen folgen dem, was du tust, nicht dem, was du sagst.",
          wrong:   "Mentoring braucht GlaubwÃ¼rdigkeit. Nur gelebte Verantwortung schafft Vertrauen."
        }
      },
      {
        q: "Was bedeutet â€žFÃ¼hren durch Vorangehenâ€œ in der Praxis?",
        a: [
          { text: "Den anderen stÃ¤ndig Aufgaben zu geben.", correct: false },
          { text: "Immer der Lauteste im Raum zu sein.", correct: false },
          { text: "Das eigene Wissen authentisch vorzuleben, statt nur zu predigen.", correct: true }
        ],
        mentor: {
          correct: "Genau â€” FÃ¼hrung ist Vorleben, nicht Ansagen. Dein Handeln ist deine stÃ¤rkste Botschaft.",
          wrong:   "Befehle wirken kurz. Beispiel wirkt dauerhaft."
        }
      },
      {
        q: "Warum ist Transparenz im Network-Marketing entscheidend?",
        a: [
          { text: "Weil Menschen auf Dauer nur folgen, wenn sie Klarheit und Fairness erleben.", correct: true },
          { text: "Weil es gesetzlich vorgeschrieben ist.", correct: false },
          { text: "Weil man dadurch automatisch mehr Umsatz macht.", correct: false }
        ],
        mentor: {
          correct: "Richtig â€” Vertrauen entsteht durch Offenheit. Ehrliche Zahlen und klare Kommunikation halten Strukturen stabil.",
          wrong:   "Geheimnisse bremsen Teams. Offenheit beschleunigt Vertrauen."
        }
      },
      {
        q: "Was passiert, wenn im Team Konkurrenzdenken Ã¼berwiegt?",
        a: [
          { text: "Die Leistung steigt automatisch, weil alle sich anstrengen.", correct: false },
          { text: "Vertrauen zerbricht, Zusammenarbeit leidet, Wachstum stagniert.", correct: true },
          { text: "Motivation und Offenheit wachsen.", correct: false }
        ],
        mentor: {
          correct: "Genau â€” Konkurrenz zerstÃ¶rt Vertrauen. Kooperation hÃ¤lt Wachstum lebendig.",
          wrong:   "Wettbewerb im Team spaltet. Gemeinsamer Fortschritt verbindet."
        }
      },
      {
        q: "Wie kann man mit Ablehnung oder Kritik im GesprÃ¤ch souverÃ¤n umgehen?",
        a: [
          { text: "Mit VerstÃ¤ndnis, Humor und Fokus auf Inhalte statt Emotionen.", correct: true },
          { text: "Mit Gegenangriff, um StÃ¤rke zu zeigen.", correct: false },
          { text: "Mit sofortigem RÃ¼ckzug aus dem GesprÃ¤ch.", correct: false }
        ],
        mentor: {
          correct: "Perfekt â€” Gelassenheit Ã¶ffnet TÃ¼ren. Humor und Empathie entwaffnen Spannung.",
          wrong:   "Abwehr blockiert Vertrauen. Bleib ruhig, bleib bei der Sache."
        }
      },
      {
        q: "Was bleibt das Ziel eines Mentors â€“ egal wie groÃŸ das Team wird?",
        a: [
          { text: "Sich selbst Ã¼berflÃ¼ssig zu machen, indem er andere befÃ¤higt, eigenstÃ¤ndig zu handeln.", correct: true },
          { text: "Seine Position zu sichern.", correct: false },
          { text: "Alle Entscheidungen allein zu treffen.", correct: false }
        ],
        mentor: {
          correct: "Richtig â€” die hÃ¶chste Form von FÃ¼hrung ist, andere zu befÃ¤higen, selbst zu fÃ¼hren.",
          wrong:   "Ein Mentor wÃ¤chst, wenn er loslassen kann. Kontrolle hÃ¤lt klein, Vertrauen lÃ¤sst wachsen."
        }
      }
    ]
  },

  en: {
    title: "ðŸŒ Basic Course 4 â€“ Network & Mentorship",
    btn: { next: "Next question", result: "See results", again: "Next" },
    labels: { q: "Question", of: "of", done: "âœ… Course completed" },
    reviewTitle: "Evaluation â€“ Your learning points",
    reviewEmpty: "Strong â€” no mistakes! You lead with clarity, trust and example.",
    questions: [
      {
        q: "What is the foundation of a stable network?",
        a: [
          { text: "As many new contacts as possible in a short time.", correct: false },
          { text: "Trust, shared values and honest communication.", correct: true },
          { text: "Constant activity on social media.", correct: false }
        ],
        mentor: {
          correct: "Exactly â€” lasting connections are built on trust and shared values, not speed.",
          wrong:   "Speed isnâ€™t depth. Relationships grow through honesty, not numbers."
        }
      },
      {
        q: "Why is listening more important for a mentor than speaking?",
        a: [
          { text: "Because true understanding comes from seeing the other personâ€™s perspective.", correct: true },
          { text: "Because speaking consumes too much energy.", correct: false },
          { text: "Because listening automatically gives authority.", correct: false }
        ],
        mentor: {
          correct: "Right â€” to lead, first understand. Listening bridges knowledge and trust.",
          wrong:   "Talking fills time, not understanding. Listening earns respect."
        }
      },
      {
        q: "What separates a sponsor from a true mentor?",
        a: [
          { text: "A mentor only provides financial help.", correct: false },
          { text: "A sponsor helps understand the system.", correct: false },
          { text: "A mentor supports both professionally and personally, not just with money or links.", correct: true }
        ],
        mentor: {
          correct: "Good â€” mentors invest in people, not just structures. They build confidence, not dependency.",
          wrong:   "Sponsors give access; mentors enable growth."
        }
      },
      {
        q: "How does long-term motivation develop within a team?",
        a: [
          { text: "Through pressure and top-down control.", correct: false },
          { text: "Through purpose, shared goals, and mutual recognition.", correct: true },
          { text: "Through daily profit promises.", correct: false }
        ],
        mentor: {
          correct: "Correct â€” meaning drives motivation. Purpose outlasts pressure.",
          wrong:   "Control fades; shared goals inspire."
        }
      },
      {
        q: "Why must a mentor live responsibility personally?",
        a: [
          { text: "Because leading by example shapes more than words.", correct: true },
          { text: "Because responsibility only strengthens structure.", correct: false },
          { text: "Because otherwise technology wonâ€™t be trusted.", correct: false }
        ],
        mentor: {
          correct: "Exactly â€” authenticity is leadership. People follow what you do, not what you say.",
          wrong:   "Without integrity, leadership collapses. Responsibility builds credibility."
        }
      },
      {
        q: "What does â€˜leading by exampleâ€™ mean in practice?",
        a: [
          { text: "Constantly assigning tasks to others.", correct: false },
          { text: "Always being the loudest person in the room.", correct: false },
          { text: "Living your knowledge authentically instead of just preaching it.", correct: true }
        ],
        mentor: {
          correct: "Exactly â€” action teaches louder than instruction.",
          wrong:   "Orders fade. Example remains."
        }
      },
      {
        q: "Why is transparency vital in network marketing?",
        a: [
          { text: "Because people follow long-term only if they experience clarity and fairness.", correct: true },
          { text: "Because itâ€™s legally required.", correct: false },
          { text: "Because it automatically increases sales.", correct: false }
        ],
        mentor: {
          correct: "Right â€” openness builds trust. Clear numbers keep teams stable.",
          wrong:   "Hidden information breaks confidence. Transparency fuels growth."
        }
      },
      {
        q: "What happens when competition dominates within a team?",
        a: [
          { text: "Performance automatically rises because everyone tries harder.", correct: false },
          { text: "Trust breaks, collaboration weakens, growth stalls.", correct: true },
          { text: "Motivation and openness increase.", correct: false }
        ],
        mentor: {
          correct: "Exactly â€” competition erodes unity. Collaboration sustains progress.",
          wrong:   "Division slows success; shared purpose accelerates it."
        }
      },
      {
        q: "How can you handle rejection or criticism confidently?",
        a: [
          { text: "With empathy, humor, and focus on the topic rather than emotion.", correct: true },
          { text: "By counter-attacking to show strength.", correct: false },
          { text: "By immediately leaving the conversation.", correct: false }
        ],
        mentor: {
          correct: "Perfect â€” composure opens doors. Humor and calm defuse tension.",
          wrong:   "Defensiveness closes minds. Stay calm and stay factual."
        }
      },
      {
        q: "What remains a mentorâ€™s goal â€” no matter how large the team?",
        a: [
          { text: "To make themselves unnecessary by empowering others to act independently.", correct: true },
          { text: "To secure their position.", correct: false },
          { text: "To make all decisions alone.", correct: false }
        ],
        mentor: {
          correct: "Right â€” real leadership creates new leaders, not followers.",
          wrong:   "Control limits growth; empowerment multiplies it."
        }
      }
    ]
  }
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Renderer (identisch zu Kurs 2/3, lokal enthalten)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function(){
  const GRADIENTS = [
    "linear-gradient(90deg,#d4af37,#22c55e)",
    "linear-gradient(90deg,#22c55e,#3b82f6)",
    "linear-gradient(90deg,#3b82f6,#8b5cf6)",
    "linear-gradient(90deg,#8b5cf6,#ef4444)",
    "linear-gradient(90deg,#ef4444,#d4af37)"
  ];

  const labelsByLang = (t) => ({
    next: t.btn.next, result: t.btn.result, again: t.btn.again,
    q: t.labels.q, of: t.labels.of, done: t.labels.done
  });

  function shuffle(arr){
    const a = arr.slice();
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i],a[j]]=[a[j],a[i]];
    }
    return a;
  }

  function render(lang){
    const data = window.block03_course_4[lang] || window.block03_course_4.de;
    const L = labelsByLang(data);
    const root = document.getElementById("quiz-root");
    if(!root) return;

    root.innerHTML = `
      <section id="quiz-block" class="card" style="padding:1.4rem;">
        <div id="quiz-header">
          <div id="quiz-progress"><div id="quiz-progress-bar"></div></div>
          <div id="quiz-question-info">
            <span id="quiz-question-number"></span>
            <span id="quiz-question-total"></span>
          </div>
          <h2 id="quiz-course-title" style="
            text-align:center; color:var(--gold);
            font-size:clamp(1.3rem,2.2vw,1.8rem); margin:.2rem 0 .8rem 0;
          ">${data.title}</h2>
          <h3 id="quiz-question-text" style="margin-top:.2rem;"></h3>
        </div>

        <div id="quiz-answers"></div>

        <div id="quiz-footer" style="display:flex;justify-content:space-between;gap:.6rem;margin-top:1rem;">
          <button id="quiz-result-btn" disabled>${L.result}</button>
          <button id="quiz-next-btn" disabled>${L.next}</button>
        </div>
      </section>

      <section id="mentor-review" class="card" style="padding:1.2rem;">
        <h3 style="text-align:center;color:var(--gold);margin:.2rem 0 1rem 0;">${data.reviewTitle}</h3>
        <div id="review-stage" style="display:none;">
          <div id="review-content"></div>
          <div style="text-align:right;margin-top:1rem;">
            <button id="review-next">${L.again}</button>
          </div>
        </div>
        <p id="review-empty" style="display:none;color:var(--muted);text-align:center;">${data.reviewEmpty}</p>
      </section>
    `;

    injectStylesOnce();

    const qNum = root.querySelector("#quiz-question-number");
    const qTotal = root.querySelector("#quiz-question-total");
    const qText = root.querySelector("#quiz-question-text");
    const answersBox = root.querySelector("#quiz-answers");
    const nextBtn = root.querySelector("#quiz-next-btn");
    const resultBtn = root.querySelector("#quiz-result-btn");
    const bar = root.querySelector("#quiz-progress-bar");

    const reviewStage = document.getElementById("review-stage");
    const reviewContent = document.getElementById("review-content");
    const reviewEmpty = document.getElementById("review-empty");
    const reviewNext = document.getElementById("review-next");

    const total = data.questions.length;
    qTotal.textContent = ` / ${total}`;

    let idx = 0;
    let picked = null;
    let wrongs = [];
    let gradIndex = 0;

    const questions = data.questions.map(q => ({
      q: q.q,
      a: shuffle(q.a),
      mentor: q.mentor
    }));

    function load(i){
      const current = questions[i];
      qNum.textContent = `${data.labels.q} ${i+1}`;
      qText.textContent = current.q;

      answersBox.innerHTML = "";
      picked = null;
      nextBtn.disabled = true;

      const labels = ["A","B","C"];
      current.a.forEach((ans, k) => {
        const el = document.createElement("div");
        el.className = "quiz-answer";
        el.tabIndex = 0;
        el.setAttribute("role","button");
        el.dataset.correct = !!ans.correct;

        const chip = document.createElement("span");
        chip.className = "quiz-label";
        chip.textContent = labels[k];

        const txt = document.createElement("span");
        txt.textContent = ans.text;

        el.appendChild(chip);
        el.appendChild(txt);
        answersBox.appendChild(el);

        el.addEventListener("click", () => {
          answersBox.querySelectorAll(".quiz-answer").forEach(n => n.classList.remove("selected"));
          el.classList.add("selected");
          picked = { correct: ans.correct, text: ans.text };
          nextBtn.disabled = false;
          resultBtn.disabled = false;
        });
      });

      updateProgress(i);
      bar.style.background = GRADIENTS[gradIndex % GRADIENTS.length];
      gradIndex++;
    }

    function updateProgress(i){
      const percent = (i / total) * 100;
      bar.style.width = `${percent}%`;
    }

    nextBtn.addEventListener("click", () => {
      if(!picked) return;
      const cur = questions[idx];

      if(!picked.correct){
        wrongs.push({
          i: idx+1,
          q: cur.q,
          pickText: picked.text,
          mentor: cur.mentor.wrong
        });
      }

      idx++;
      if(idx < total){
        load(idx);
      }else{
        bar.style.width = "100%";
        qText.textContent = data.labels.done;
        answersBox.innerHTML = "";
        nextBtn.disabled = true;
      }
    });

    resultBtn.addEventListener("click", () => {
      reviewStage.style.display = "block";
      if(wrongs.length === 0){
        reviewEmpty.style.display = "block";
        reviewContent.innerHTML = "";
        reviewNext.style.display = "none";
        return;
      }
      reviewEmpty.style.display = "none";
      reviewNext.style.display = "inline-block";
      buildReviewSlideshow(wrongs, reviewContent, reviewNext);
    });

    load(idx);

    // Live-Sprachwechsel
    document.addEventListener("fsa:lang-change", (e) => {
      const code = e && e.detail ? e.detail : (localStorage.getItem("fsa_lang")||"de");
      render(code);
    });
    window.addEventListener("storage", (e) => {
      if(e.key === "fsa_lang") render(e.newValue || "de");
    });
  }

  function buildReviewSlideshow(items, mount, btn){
    let r = 0;
    function paint(k){
      const it = items[k];
      mount.innerHTML = `
        <div class="review-card">
          <div class="review-qindex">#${it.i}</div>
          <div class="review-q">${escapeHtml(it.q)}</div>
          <div class="review-picked">
            <div class="tag">Falsche Antwort</div>
            <div class="txt">${escapeHtml(it.pickText)}</div>
          </div>
          <div class="review-mentor">${escapeHtml(it.mentor)}</div>
        </div>
      `;
    }
    paint(r);
    btn.onclick = () => {
      r = (r+1) % items.length;
      paint(r);
    };
  }

  function escapeHtml(s){
    return String(s)
      .replace(/&/g,"&amp;").replace(/</g,"&lt;")
      .replace(/>/g,"&gt;").replace(/"/g,"&quot;")
      .replace(/'/g,"&#39;");
  }

  let stylesInjected = false;
  function injectStylesOnce(){
    if(stylesInjected) return;
    stylesInjected = true;
    const css = `
      #quiz-block {
        background: var(--panel);
        border: 1px solid var(--line);
        border-radius: 10px;
        color: #e5e7eb;
        box-shadow: 0 0 15px rgba(212,175,55,0.25);
      }
      #quiz-progress {
        background: #1e293b; height:6px; width:100%;
        border-radius:4px; margin-bottom:1rem; overflow:hidden;
      }
      #quiz-progress-bar { width:0%; height:100%; transition: width .3s ease; }
      #quiz-question-info {
        display:flex; justify-content:space-between;
        font-size:.9rem; color:#d4af37; margin-bottom:.3rem;
      }
      #quiz-question-text {
        font-size:1.05rem; font-weight:600; margin:.4rem 0 .8rem 0;
      }
      .quiz-answer {
        display:flex; align-items:center; gap:.6rem;
        background:#1e293b; border:1px solid transparent;
        padding:.75rem 1rem; border-radius:8px; cursor:pointer;
        margin-bottom:.75rem; transition: all .2s ease;
      }
      .quiz-answer:hover { border-color:#d4af37; }
      .quiz-answer.selected { border-color:#d4af37; background:#0b0f14; }
      .quiz-label {
        width:24px; height:24px; border-radius:50%;
        background:#d4af37; color:#0f172a; font-weight:700;
        display:inline-flex; align-items:center; justify-content:center;
      }
      #quiz-footer button {
        background:#2563eb; color:#fff; border:none;
        padding:.65rem 1.2rem; font-size:.95rem; border-radius:8px;
        cursor:pointer; transition: background .2s ease;
      }
      #quiz-footer button:hover:enabled { background:#1d4ed8; }
      #quiz-footer button:disabled { background:#475569; cursor:not-allowed; }

      /* Review */
      #mentor-review { border:1px solid var(--line); }
      .review-card { border:1px solid rgba(212,175,55,.25); border-radius:10px; padding:1rem; }
      .review-qindex { color:#d4af37; font-weight:700; margin-bottom:.25rem; }
      .review-q { font-weight:600; margin-bottom:.6rem; }
      .review-picked { background:rgba(239,68,68,.08); border:1px solid rgba(239,68,68,.35);
        border-radius:8px; padding:.6rem .8rem; margin-bottom:.6rem; }
      .review-picked .tag { font-size:.8rem; color:#ef4444; margin-bottom:.25rem; }
      .review-picked .txt { color:#e5e7eb; }
      .review-mentor { color:#a3a3a3; line-height:1.55; }
      #review-next {
        background:#334155; color:#fff; border:none; padding:.6rem 1rem;
        border-radius:8px; cursor:pointer;
      }

      @media (max-width: 420px) {
        #quiz-footer { flex-direction: column; }
        #quiz-footer button { width:100%; }
      }
    `;
    const style = document.createElement("style");
    style.textContent = css;
    document.head.appendChild(style);
  }

  // Autostart
  document.addEventListener("DOMContentLoaded", () => {
    const lang = localStorage.getItem("fsa_lang") || "de";
    render(lang);
  });
})();
