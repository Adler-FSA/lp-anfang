<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>FSA ‚Äì Pr√ºfungsvorbereitung</title>
  <style>
    :root{--gold:#d4af37;--ink:#0b0f14;--panel:rgba(17,24,39,.78);--line:rgba(212,175,55,.35);--muted:#a3a3a3}
    html,body{margin:0;padding:0;background:var(--ink);color:#e5e7eb;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
    main{max-width:1040px;margin:0 auto;padding:0 16px 80px}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:1.4rem;box-shadow:0 0 22px rgba(212,175,55,.08)}
    .sp-3cm{margin-top:3cm}
    h1,h2{color:var(--gold);margin:.2rem 0 .8rem}
    .row{display:grid;gap:1rem}
    .badge{display:inline-block;border:1px solid var(--line);padding:.2rem .5rem;border-radius:6px;margin-left:.4rem}
    .bar{height:10px;background:rgba(255,255,255,.08);border-radius:6px;overflow:hidden;margin:.7rem 0}
    .bar>div{height:100%;background:linear-gradient(90deg,#3b82f6,#d4af37)}
    .btn{display:inline-block;background:rgba(255,255,255,.08);border:1px solid var(--line);color:#e5e7eb;border-radius:8px;padding:.8rem 1.4rem;cursor:pointer}
    .btn.primary{background:linear-gradient(90deg,#3b82f6,#d4af37);border:none}
    .hint{color:#9ca3af}
    @media(max-width:640px){.row{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <main>
    <section class="sp-3cm card">
      <h1>üéì Pr√ºfungsvorbereitung</h1>
      <p class="hint" id="hello"></p>
      <div class="bar"><div id="prog" style="width:0%"></div></div>
      <ul id="list"></ul>
      <p><strong id="scoreLine"></strong></p>
      <p id="statusLine"></p>
      <div id="unlockBox" style="margin-top:1rem"></div>
      <div style="margin-top:1rem;display:flex;gap:.8rem;flex-wrap:wrap">
        <a class="btn" href="/lp-anfang/grundkurs-basis.html">Grundkurs 1</a>
        <a class="btn" href="/lp-anfang/grundkurs-sicherheit.html">Grundkurs 2</a>
        <a class="btn" href="/lp-anfang/grundkurs-einkommen.html">Grundkurs 3</a>
        <a class="btn" href="/lp-anfang/grundkurs-network.html">Grundkurs 4</a>
      </div>
    </section>
  </main>

  <!-- Globale Module -->
  <script src="library/js/menu.js" defer></script>
  <script src="library/js/lang-switcher.js" defer></script>
  <script src="library/js/music-button.js" defer></script>
  <script src="library/js/back-to-home.js" defer></script>
  <script src="library/js/grundkurs-menu.js" defer></script>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const lang = localStorage.getItem("fsa_lang") || "de";
    const first = localStorage.getItem("fsa_firstName") || "";
    const last  = localStorage.getItem("fsa_lastName")  || "";
    const full  = (first+" "+last).trim() || (lang==="de"?"Teilnehmer":"Participant");

    const copy = {
      de:{
        hello:n=>`Willkommen ${n}. Dieses Panel zeigt deinen Stand √ºber alle vier Grundkurse.`,
        row:c=>`${c.title}: `,
        repeats:"Wiederholungen",
        total:"Gesamt:",
        status:"Qualifikationsstatus:",
        need:"F√ºr die Hauptpr√ºfung brauchst du 36 von 40 richtigen Antworten.",
        locked:"Du hast noch nicht gen√ºgend Punkte f√ºr die Freischaltung.",
        passText:`Herzlichen Gl√ºckwunsch, <strong>${full}</strong>! Du hast dich qualifiziert mit mindestens <strong>36 richtigen Antworten</strong>.`+
                 ` Jetzt wartet die gro√üe Pr√ºfung auf dich: <strong>50 Fragen</strong>, davon <strong>10 neue</strong> im Kontext der Grundkurse. `+
                 `Nutze das Passwort und gib es auf der Pr√ºfungsseite ein ‚Äì dann startet deine Pr√ºfung.`,
        passwordLabel:"Pr√ºfungs-Passwort:",
        password:"Souver√§n",
        goExam:"Zur Pr√ºfungsseite ‚Üí"
      },
      en:{
        hello:n=>`Welcome ${n}. This panel shows your progress across all four basic courses.`,
        row:c=>`${c.title}: `,
        repeats:"Repeats",
        total:"Total:",
        status:"Qualification status:",
        need:"You need 36 out of 40 correct to unlock the main exam.",
        locked:"You do not yet have enough points for unlocking.",
        passText:`Congratulations, <strong>${full}</strong>! You qualified with at least <strong>36 correct answers</strong>. `+
                 `Your final exam has <strong>50 questions</strong>, including <strong>10 new</strong> ones aligned to the course topics. `+
                 `Use the password below on the exam page to begin.`,
        passwordLabel:"Exam password:",
        password:"Souver√§n",
        goExam:"Go to exam page ‚Üí"
      }
    }[lang];

    document.getElementById("hello").innerHTML = copy.hello(full);

    const courses = [
      {key:"course1", title: lang==="de"?"Grundkurs 1":"Basic Course 1"},
      {key:"course2", title: lang==="de"?"Grundkurs 2":"Basic Course 2"},
      {key:"course3", title: lang==="de"?"Grundkurs 3":"Basic Course 3"},
      {key:"course4", title: lang==="de"?"Grundkurs 4":"Basic Course 4"}
    ];

    let total = 0, possible = 40;
    let html = "";
    courses.forEach(c=>{
      const s = parseInt(localStorage.getItem(`fsa_${c.key}_score`)||"0",10);
      const st= localStorage.getItem(`fsa_${c.key}_status`) || "‚Äî";
      const rp= parseInt(localStorage.getItem(`fsa_${c.key}_repeats`)||"0",10);
      total += s;
      html += `<li>${copy.row(c)} <strong>${s}/10</strong> ‚Äì ${st} <span class="badge">${copy.repeats}: ${rp}</span></li>`;
    });
    document.getElementById("list").innerHTML = html;
    document.getElementById("scoreLine").textContent = `${copy.total} ${total} / ${possible}`;
    const pct = Math.round((total/possible)*100);
    document.getElementById("prog").style.width = pct+"%";

    const qualified = total >= 36;
    document.getElementById("statusLine").textContent = copy.need;
    const box = document.getElementById("unlockBox");
    if (qualified){
      box.innerHTML = `
        <div class="card" style="margin-top:.6rem">
          <p>${copy.passText}</p>
          <p><strong>${copy.passwordLabel}</strong> <code style="font-size:1.05rem">"${copy.password}"</code></p>
          <a class="btn primary" href="/lp-anfang/pruefung.html">${copy.goExam}</a>
        </div>`;
    } else {
      box.innerHTML = `<p class="hint">${copy.locked}</p>`;
    }
  });
  </script>
</body>
</html>
