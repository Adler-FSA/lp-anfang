<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FSA Akademie – Grundkurs 1: Basis</title>

  <style>
    :root {
      --gold:#d4af37; --ink:#0b0f14; --panel:rgba(17,24,39,.7);
      --line:rgba(212,175,55,.35); --muted:#a3a3a3;
    }
    html,body{margin:0;padding:0;background:var(--ink);color:#e5e7eb;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
    main{max-width:1040px;margin:0 auto;padding:0 16px 100px}
    .sp-3cm{margin-top:3cm}.sp-15{margin-top:1.5cm}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:14px;
      padding:1.4rem;box-shadow:0 0 22px rgba(212,175,55,.08)}
    h1,h2,h3{color:var(--gold);margin:0 0 .6rem 0}
    p{color:var(--muted);line-height:1.6;margin:.4rem 0}
    .namegrid{display:grid;grid-template-columns:1fr 1fr auto;gap:.8rem;align-items:center}
    .namegrid input{background:#0f172a;border:1px solid rgba(212,175,55,.25);
      border-radius:8px;padding:.8rem 1rem;color:#e5e7eb;outline:none}
    .namegrid input::placeholder{color:#7c7c7c}
    .start-btn{background:#2563eb;border:0;padding:.85rem 1.1rem;border-radius:10px;
      color:#fff;font-weight:600;cursor:pointer}
    .start-btn:hover{filter:brightness(1.08)}
    #quiz-root{margin-top:1.5cm}
    @media(max-width:640px){.namegrid{grid-template-columns:1fr}.start-btn{width:100%}}
  </style>
</head>

<body>
  <main>
    <!-- Intro (wird vom Block ersetzt) -->
    <section class="sp-3cm card" id="intro">
      <h1>Grundkurs 1 – Basis</h1>
      <p id="introText">
        Dieser Kurs legt dein Fundament: Verständnis von Geldflüssen, Verantwortung und Freiheit.
      </p>
    </section>

    <div class="sp-15"></div>

    <!-- Kursmenü (Anker) -->
    <section id="kursmenu-anchor"></section>

    <div class="sp-15"></div>

    <!-- Namensformular -->
    <section class="card">
      <form class="namegrid" id="nameForm" autocomplete="on">
        <input id="firstName" type="text" placeholder="Vorname / First name" required />
        <input id="lastName"  type="text" placeholder="Nachname / Last name" required />
        <button type="submit" class="start-btn" id="startBtn">Kurs starten</button>
      </form>
      <p style="margin-top:.6rem" id="nameHint">
        Bitte trage deinen Namen ein, damit dein Mentor dich persönlich ansprechen kann.
      </p>
    </section>

    <!-- Fragen + Auswertung -->
    <section id="quiz-root"></section>
  </main>

  <!-- ╔══════════════╗ Top-Leiste / Helfer ╚══════════════╗ -->
  <script src="/lp-anfang/library/js/template.js" defer></script>
  <script src="/lp-anfang/library/js/menu.js" defer></script>
  <script src="/lp-anfang/library/js/lang-switcher.js" defer></script>
  <script src="/lp-anfang/library/js/music-button.js" defer></script>

  <!-- Grundkurs-Menü (sichtbar auf allen Kursseiten) -->
  <script src="/lp-anfang/library/js/grundkurs-menu.js" defer></script>

  <!-- ╔══════════════╗ Kurs-Bausteine (TEXT) ╚══════════════╗ -->
  <script src="/lp-anfang/library/js/text/block-01-intro.js" defer></script>
  <script src="/lp-anfang/library/js/text/block-02-userdata.js" defer></script>
  <script src="/lp-anfang/library/js/text/block-03-course.js" defer></script>

  <!-- ╔══════════════╗ Kurs-Engine / Logik ╚══════════════╗ -->
  <script src="/lp-anfang/library/js/text/block-03-engine.js" defer></script>
  <script src="/lp-anfang/library/js/text/block-04-engine.js" defer></script>
  <script src="/lp-anfang/library/js/text/block-05-summary.js" defer></script>

  <!-- Reihenfolge-Sicherheit / Template-Loader -->
  <script src="/lp-anfang/library/js/template-loader.js" defer></script>

  <!-- Anti-Sprung-Patch (nur Sichtfeld fixen, sonst nichts anfassen) -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const quizRoot = document.getElementById("quiz-root");
      if (!quizRoot) return;

      const keepInView = () => {
        const box = quizRoot.getBoundingClientRect();
        // Nur nach oben korrigieren, nicht „springen“
        if (box.top < 60) {
          quizRoot.scrollIntoView({ behavior: "instant", block: "start" });
          window.scrollBy(0, -40);
        }
      };
      const obs = new MutationObserver(() => keepInView());
      obs.observe(quizRoot, { childList: true, subtree: true });
    });
  </script>

  <!-- Seiten-Logik lokal (Sprache + Kursstart) -->
  <script>
    // Sprache ins Fallback-Intro spiegeln
    document.addEventListener("DOMContentLoaded", () => {
      const lang = localStorage.getItem("fsa_lang") || "de";
      document.getElementById("introText").textContent =
        lang === "de"
          ? "Dieser Kurs legt dein Fundament: Verständnis von Geldflüssen, Verantwortung und Freiheit."
          : "This course lays your foundation: understanding money flows, responsibility, and freedom.";
      document.getElementById("nameHint").textContent =
        lang === "de"
          ? "Bitte trage deinen Namen ein, damit dein Mentor dich persönlich ansprechen kann."
          : "Please enter your name so your mentor can address you personally.";
      document.getElementById("startBtn").textContent =
        lang === "de" ? "Kurs starten" : "Start course";
      document.documentElement.lang = lang;
    });

    // Ladefehler sichtbar loggen
    window.addEventListener("error", (e) => {
      console.warn("Ladefehler:", e?.target?.src || e.message);
    }, true);

    // Kursstart
    document.getElementById("nameForm")?.addEventListener("submit", (ev) => {
      ev.preventDefault();
      const first = document.getElementById("firstName").value.trim();
      const last  = document.getElementById("lastName").value.trim();
      if (!first || !last) return;

      localStorage.setItem("fsa_firstName", first);
      localStorage.setItem("fsa_lastName",  last);
      localStorage.setItem("fsa_currentCourse", "course1");

      if (typeof window.startCourse === "function") {
        window.startCourse();
      } else {
        document.getElementById("quiz-root").innerHTML =
          "<p style='color:#d4af37'>Kurs wird geladen …</p>";
        const iv = setInterval(() => {
          if (typeof window.startCourse === "function") {
            clearInterval(iv);
            window.startCourse();
          }
        }, 150);
        setTimeout(() => clearInterval(iv), 8000);
      }
    });
  </script>
</body>
</html>
